import{E as ye,a as fe,b as ve}from"./element-plus-AVrsaVJp.js";import{aP as he,r as w,c as Ot,aV as de,o as ut,q as be,D as W,V as ke,x as g,z as t,R as ae,P as r,u as a,L as I,O as U,C as G,Q as pt,ac as gt,K as _e,al as we,J as Ce,y as m,B as Te}from"./vue-vendor-DfX6Lnp2.js";import{C as Mt}from"./chart-yFHxLHpB.js";import{n as De,o as ce,p as Gt,s as jt,_ as Se,a as Ae,f as $,q as $e,r as Re}from"./index-BCXuvgjo.js";import"./vendor-Dr8jvgFu.js";const Ie=he("dashboard",()=>{const qt=w(!1),mt=w({totalApiKeys:0,activeApiKeys:0,totalAccounts:0,normalAccounts:0,abnormalAccounts:0,pausedAccounts:0,activeAccounts:0,rateLimitedAccounts:0,accountsByPlatform:{claude:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},"claude-console":{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},gemini:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},azure_openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},bedrock:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0}},todayRequests:0,totalRequests:0,todayTokens:0,todayInputTokens:0,todayOutputTokens:0,totalTokens:0,totalInputTokens:0,totalOutputTokens:0,totalCacheCreateTokens:0,totalCacheReadTokens:0,todayCacheCreateTokens:0,todayCacheReadTokens:0,systemRPM:0,systemTPM:0,realtimeRPM:0,realtimeTPM:0,metricsWindow:5,isHistoricalMetrics:!1,systemStatus:"æ­£å¸¸",uptime:0,systemTimezone:8}),j=w({todayCosts:{totalCost:0,formatted:{totalCost:"$0.000000"}},totalCosts:{totalCost:0,formatted:{totalCost:"$0.000000"}}}),rt=w([]),n=w([]),Dt=w({data:[],topApiKeys:[],totalApiKeys:0}),et=w({data:[],topAccounts:[],totalAccounts:0,group:"claude",groupLabel:"Claudeè´¦æˆ·"}),nt={preset:"dashboard:date:preset",granularity:"dashboard:trend:granularity"},q="today",L="day",lt=c=>c==="hour"?[{value:"last24h",label:"è¿‘24å°æ—¶",hours:24},{value:"yesterday",label:"æ˜¨å¤©",hours:24},{value:"dayBefore",label:"å‰å¤©",hours:24}]:[{value:"today",label:"ä»Šæ—¥",days:1},{value:"7days",label:"7å¤©",days:7},{value:"30days",label:"30å¤©",days:30}],Lt=(c,x)=>{try{return localStorage.getItem(c)||x}catch{return x}},F=(c,x)=>{try{localStorage.setItem(c,x)}catch{}},J=(c,x)=>lt(x).some(h=>h.value===c)?c:x==="hour"?"last24h":q,Q=Lt(nt.granularity,L),St=["day","hour"].includes(Q)?Q:L,Ht=J(Lt(nt.preset,q),St),l=w({type:"preset",preset:Ht,customStart:"",customEnd:"",customRange:null,presetOptions:lt(St)}),O=w(St),At=w("requests"),xt=w("claude"),Vt=Ot(()=>{const c=mt.value.uptime,x=Math.floor(c/86400),i=Math.floor(c%86400/3600),d=Math.floor(c%3600/60);return x>0?`${x}å¤© ${i}å°æ—¶`:i>0?`${i}å°æ—¶ ${d}åˆ†é’Ÿ`:`${d}åˆ†é’Ÿ`});function z(c,x=!0){const i=c.getFullYear(),d=c.getMonth(),h=c.getDate();return x?new Date(Date.UTC(i,d,h-1,16,0,0,0)):new Date(Date.UTC(i,d,h,15,59,59,999))}function it(c){const x=new Date;switch(c){case"today":return{start:z(x,!0),end:z(x,!1)};case"last24h":return{start:new Date(x.getTime()-24*60*60*1e3),end:new Date(x)};case"yesterday":{const i=new Date;return i.setDate(i.getDate()-1),{start:z(i,!0),end:z(i,!1)}}case"dayBefore":{const i=new Date;return i.setDate(i.getDate()-2),{start:z(i,!0),end:z(i,!1)}}default:return{start:new Date(x.getTime()-24*60*60*1e3),end:new Date(x)}}}const at=(c=l.value.preset,x=O.value)=>{F(nt.preset,c),F(nt.granularity,x)},Y=()=>l.value.type==="preset"&&l.value.preset==="today"&&O.value==="day"?"hour":O.value;async function $t(c=null){qt.value=!0;try{let x={today:"today",all:"all"};c&&(x={today:{today:"today",all:"today"},"7days":{today:"7days",all:"7days"},monthly:{today:"monthly",all:"monthly"},all:{today:"today",all:"all"}}[c]||x);const[i,d,h]=await Promise.all([De(),ce(x.today),ce(x.all)]);if(i.success){const y=i.data.overview||{},_=i.data.recentActivity||{},C=i.data.systemAverages||{},A=i.data.realtimeMetrics||{},K=i.data.systemHealth||{};mt.value={totalApiKeys:y.totalApiKeys||0,activeApiKeys:y.activeApiKeys||0,totalAccounts:y.totalAccounts||y.totalClaudeAccounts||0,normalAccounts:y.normalAccounts||0,abnormalAccounts:y.abnormalAccounts||0,pausedAccounts:y.pausedAccounts||0,activeAccounts:y.activeAccounts||y.activeClaudeAccounts||0,rateLimitedAccounts:y.rateLimitedAccounts||y.rateLimitedClaudeAccounts||0,accountsByPlatform:y.accountsByPlatform||{claude:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},"claude-console":{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},gemini:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},azure_openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},bedrock:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0}},todayRequests:_.requestsToday||0,totalRequests:y.totalRequestsUsed||0,todayTokens:_.tokensToday||0,todayInputTokens:_.inputTokensToday||0,todayOutputTokens:_.outputTokensToday||0,totalTokens:y.totalTokensUsed||0,totalInputTokens:y.totalInputTokensUsed||0,totalOutputTokens:y.totalOutputTokensUsed||0,totalCacheCreateTokens:y.totalCacheCreateTokensUsed||0,totalCacheReadTokens:y.totalCacheReadTokensUsed||0,todayCacheCreateTokens:_.cacheCreateTokensToday||0,todayCacheReadTokens:_.cacheReadTokensToday||0,systemRPM:C.rpm||0,systemTPM:C.tpm||0,realtimeRPM:A.rpm||0,realtimeTPM:A.tpm||0,metricsWindow:A.windowMinutes||5,isHistoricalMetrics:A.isHistorical||!1,systemStatus:K.redisConnected?"æ­£å¸¸":"å¼‚å¸¸",uptime:K.uptime||0,systemTimezone:i.data.systemTimezone||8}}d.success&&h.success&&(j.value={todayCosts:d.data.totalCosts||{totalCost:0,formatted:{totalCost:"$0.000000"}},totalCosts:h.data.totalCosts||{totalCost:0,formatted:{totalCost:"$0.000000"}}})}catch(x){console.error("åŠ è½½ä»ªè¡¨æ¿æ•°æ®å¤±è´¥:",x)}finally{qt.value=!1}}async function yt(c=7,x=Y()){try{let i="/admin/usage-trend?";if(x==="hour")if(i+="granularity=hour",l.value.customRange&&l.value.customRange.length===2)i+=`&startDate=${encodeURIComponent(l.value.customRange[0])}`,i+=`&endDate=${encodeURIComponent(l.value.customRange[1])}`;else if(l.value.type==="preset"){const{start:h,end:y}=it(l.value.preset);i+=`&startDate=${encodeURIComponent(h.toISOString())}`,i+=`&endDate=${encodeURIComponent(y.toISOString())}`}else{const h=new Date;i+=`&startDate=${encodeURIComponent(new Date(h.getTime()-c*24*60*60*1e3).toISOString())}`,i+=`&endDate=${encodeURIComponent(h.toISOString())}`}else i+=`granularity=day&days=${c}`;const d=await Gt(i);d.success&&(rt.value=d.data)}catch(i){console.error("åŠ è½½ä½¿ç”¨è¶‹åŠ¿å¤±è´¥:",i)}}async function st(c="daily",x=null){const i=x||Y();try{let d=`/admin/model-stats?period=${c}`;if(l.value.type==="custom"||i==="hour"){if(l.value.customRange&&l.value.customRange.length===2)d+=`&startDate=${encodeURIComponent(l.value.customRange[0])}`,d+=`&endDate=${encodeURIComponent(l.value.customRange[1])}`;else if(i==="hour"&&l.value.type==="preset"){const{start:y,end:_}=it(l.value.preset);d+=`&startDate=${encodeURIComponent(y.toISOString())}`,d+=`&endDate=${encodeURIComponent(_.toISOString())}`}}else if(l.value.type==="preset"&&i==="day"){const y=new Date,_=l.value.presetOptions.find(C=>C.value===l.value.preset);if(_){let C,A;if(l.value.preset==="today")C=z(y,!0),A=z(y,!1);else{const K=new Date;K.setDate(K.getDate()-(_.days-1)),C=z(K,!0),A=z(y,!1)}d+=`&startDate=${encodeURIComponent(C.toISOString())}`,d+=`&endDate=${encodeURIComponent(A.toISOString())}`}}const h=await Gt(d);h.success&&(n.value=h.data)}catch(d){console.error("åŠ è½½æ¨¡å‹ç»Ÿè®¡å¤±è´¥:",d)}}async function ot(c="requests",x=null){const i=x||Y();try{let d="/admin/api-keys-usage-trend?",h=7;if(i==="hour")if(d+="granularity=hour",l.value.customRange&&l.value.customRange.length===2)d+=`&startDate=${encodeURIComponent(l.value.customRange[0])}`,d+=`&endDate=${encodeURIComponent(l.value.customRange[1])}`;else if(l.value.type==="preset"){const{start:_,end:C}=it(l.value.preset);d+=`&startDate=${encodeURIComponent(_.toISOString())}`,d+=`&endDate=${encodeURIComponent(C.toISOString())}`}else{const _=new Date;d+=`&startDate=${encodeURIComponent(new Date(_.getTime()-24*60*60*1e3).toISOString())}`,d+=`&endDate=${encodeURIComponent(_.toISOString())}`}else h=l.value.type==="preset"?l.value.preset==="today"?1:l.value.preset==="7days"?7:30:ft(l.value.customStart,l.value.customEnd),d+=`granularity=day&days=${h}`;d+=`&metric=${c}`;const y=await Gt(d);y.success&&(Dt.value={data:y.data||[],apiKeyStats:y.apiKeyStats||[],topApiKeys:y.topApiKeys||[],totalApiKeys:y.totalApiKeys||0})}catch(d){console.error("åŠ è½½API Keysè¶‹åŠ¿å¤±è´¥:",d)}}async function Z(c=xt.value,x=null){const i=x||Y();try{let d="/admin/account-usage-trend?",h=7;if(i==="hour")if(d+="granularity=hour",l.value.customRange&&l.value.customRange.length===2)d+=`&startDate=${encodeURIComponent(l.value.customRange[0])}`,d+=`&endDate=${encodeURIComponent(l.value.customRange[1])}`;else if(l.value.type==="preset"){const{start:_,end:C}=it(l.value.preset);d+=`&startDate=${encodeURIComponent(_.toISOString())}`,d+=`&endDate=${encodeURIComponent(C.toISOString())}`}else{const _=new Date;d+=`&startDate=${encodeURIComponent(new Date(_.getTime()-24*60*60*1e3).toISOString())}`,d+=`&endDate=${encodeURIComponent(_.toISOString())}`}else h=l.value.type==="preset"?l.value.preset==="today"?1:l.value.preset==="7days"?7:30:ft(l.value.customStart,l.value.customEnd),d+=`granularity=day&days=${h}`;d+=`&group=${c}`;const y=await Gt(d);y.success&&(et.value={data:y.data||[],topAccounts:y.topAccounts||[],totalAccounts:y.totalAccounts||0,group:y.group||c,groupLabel:y.groupLabel||""})}catch(d){console.error("åŠ è½½è´¦å·ä½¿ç”¨è¶‹åŠ¿å¤±è´¥:",d)}}function H(c,x={}){const{silent:i=!1,skipSave:d=!1}=x,h=J(c,O.value);l.value.type="preset",l.value.preset=h;const y=l.value.presetOptions.find(k=>k.value===h),_=new Date;let C,A;if(O.value==="hour"){const k=it(h);C=k.start,A=k.end}else C=new Date(_),A=new Date(_),h==="today"?(C.setHours(0,0,0,0),A.setHours(23,59,59,999)):y!=null&&y.days&&(C.setDate(_.getDate()-(y.days-1)),C.setHours(0,0,0,0),A.setHours(23,59,59,999));const K=k=>{const N=new Date(k),vt=N.getFullYear(),ht=String(N.getMonth()+1).padStart(2,"0"),bt=String(N.getDate()).padStart(2,"0"),It=String(N.getHours()).padStart(2,"0"),X=String(N.getMinutes()).padStart(2,"0"),Ft=String(N.getSeconds()).padStart(2,"0");return`${vt}-${ht}-${bt} ${It}:${X}:${Ft}`};l.value.customStart=C?C.toISOString().split("T")[0]:"",l.value.customEnd=A?A.toISOString().split("T")[0]:"",l.value.customRange=C&&A?[K(C),K(A)]:null,d||at(l.value.preset,O.value),i||V()}function Nt(c){if(c&&c.length===2){l.value.type="custom",l.value.preset="",l.value.customRange=c,l.value.customStart=c[0].split(" ")[0],l.value.customEnd=c[1].split(" ")[0];const x=h=>{const[y,_]=h.split(" "),[C,A,K]=y.split("-").map(Number),[k,N,vt]=_.split(":").map(Number);return new Date(C,A-1,K,k,N,vt)},i=x(c[0]),d=x(c[1]);if(O.value==="hour"){if((d-i)/36e5>24){jt("å°æ—¶ç²’åº¦ä¸‹æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡24å°æ—¶","warning");return}}else if(Math.ceil((d-i)/864e5)+1>31){jt("æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡ 31 å¤©","warning");return}V()}else c===null&&H(O.value==="hour"?"last24h":q)}function Rt(c,x={}){const{silent:i=!1,skipSave:d=!1,presetOverride:h}=x;if(O.value=c,c==="hour"){if(l.value.presetOptions=lt("hour"),l.value.type==="custom"&&l.value.customRange&&l.value.customRange.length===2){const _=new Date(l.value.customRange[0]);if((new Date(l.value.customRange[1])-_)/(1e3*60*60)>24){jt("å°æ—¶ç²’åº¦ä¸‹æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡24å°æ—¶ï¼Œå·²åˆ‡æ¢åˆ°è¿‘24å°æ—¶","warning"),H("last24h",{silent:i,skipSave:d});return}}}else l.value.presetOptions=lt("day");if(l.value.type==="custom"){d||at(l.value.preset||q,O.value),i||V();return}const y=h||J(l.value.preset,O.value);H(y,{silent:!0,skipSave:!0}),d||at(l.value.preset,O.value),i||V()}async function V(){let c,x="monthly";const i=Y();if(l.value.type==="preset"){const d=l.value.presetOptions.find(h=>h.value===l.value.preset);i==="hour"?(c=1,x="daily"):(c=d?d.days:7,l.value.preset==="today"?x="daily":x="monthly")}else{if(i==="hour"){const d=new Date(l.value.customRange[0]),h=new Date(l.value.customRange[1]),y=Math.ceil((h-d)/(1e3*60*60));c=Math.ceil(y/24)||1}else c=ft(l.value.customStart,l.value.customEnd);x="daily"}await Promise.all([yt(c,i),st(x,i),ot(At.value,i),Z(xt.value,i)])}function dt(c){return xt.value=c,Z(c,Y())}function ft(c,x){if(!c||!x)return 7;const i=new Date(c),d=new Date(x),h=Math.abs(d-i);return Math.ceil(h/(1e3*60*60*24))||7}function Yt(c){return c>new Date}return H(l.value.preset,{silent:!0,skipSave:!0}),at(l.value.preset,O.value),{loading:qt,dashboardData:mt,costsData:j,trendData:rt,dashboardModelStats:n,apiKeysTrendData:Dt,accountUsageTrendData:et,dateFilter:l,trendGranularity:O,apiKeysTrendMetric:At,accountUsageGroup:xt,formattedUptime:Vt,loadDashboardData:$t,loadUsageTrend:yt,loadModelStats:st,loadApiKeysTrend:ot,loadAccountUsageTrend:Z,setDateFilterPreset:H,onCustomDateRangeChange:Nt,setTrendGranularity:Rt,refreshChartsData:V,setAccountUsageGroup:dt,disabledDate:Yt}}),Pe={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6 lg:grid-cols-4"},Ue={class:"stat-card"},Ke={class:"flex items-center justify-between"},Be={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},Me={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Oe={class:"stat-card"},qe={class:"flex items-center justify-between"},Le={class:"flex-1"},Fe={class:"flex flex-wrap items-baseline gap-x-2"},ze={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},Ee={key:0,class:"flex items-center gap-2"},Ge=["title"],je={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},He=["title"],Ve={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ne=["title"],Ye={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},We=["title"],Je={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Qe=["title"],Ze={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Xe=["title"],ta={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},ea=["title"],aa={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},sa={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},oa={key:0,class:"text-red-600"},ra={key:1,class:"text-gray-600 dark:text-gray-400"},na={key:2,class:"text-yellow-600"},la={class:"stat-card"},ia={class:"flex items-center justify-between"},da={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},ca={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ua={class:"stat-card"},pa={class:"flex items-center justify-between"},ga={class:"text-2xl font-bold text-green-600 sm:text-3xl"},ma={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},xa={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6"},ya={class:"stat-card"},fa={class:"flex items-center justify-between"},va={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},ha={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ba={class:"mt-3 flex items-center justify-between gap-3"},ka={class:"text-xs text-gray-500 dark:text-gray-400"},_a=["disabled"],wa={class:"card p-4 sm:p-6"},Ca={class:"mb-3 flex items-center justify-between"},Ta={class:"text-xs text-gray-500 dark:text-gray-400"},Da={key:0,class:"py-6 text-center text-sm text-gray-500 dark:text-gray-400"},Sa={key:1,class:"py-6 text-center text-sm text-green-600 dark:text-green-400"},Aa={key:2,class:"max-h-64 space-y-2 overflow-y-auto"},$a={class:"flex items-center justify-between gap-2"},Ra={class:"truncate text-sm font-medium text-gray-900 dark:text-gray-100"},Ia={class:"rounded bg-gray-100 px-2 py-0.5 text-xs text-gray-600 dark:bg-gray-700 dark:text-gray-300"},Pa={class:"mt-1 text-xs text-gray-600 dark:text-gray-400"},Ua={key:0},Ka={key:1},Ba={key:0,class:"mt-2"},Ma={class:"mb-1 flex items-center justify-between text-xs text-gray-600 dark:text-gray-400"},Oa={class:"text-red-600 dark:text-red-400"},qa={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},La={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6 lg:grid-cols-4"},Fa={class:"stat-card"},za={class:"flex items-center justify-between"},Ea={class:"mr-8 flex-1"},Ga={class:"mb-2 flex flex-wrap items-baseline gap-2"},ja={class:"text-xl font-bold text-blue-600 sm:text-2xl md:text-3xl"},Ha={class:"text-sm font-medium text-green-600"},Va={class:"text-xs text-gray-500 dark:text-gray-400"},Na={class:"flex flex-wrap items-center justify-between gap-x-4"},Ya={class:"font-medium"},Wa={class:"font-medium"},Ja={key:0,class:"text-purple-600"},Qa={class:"font-medium"},Za={key:1,class:"text-purple-600"},Xa={class:"font-medium"},ts={class:"stat-card"},es={class:"flex items-center justify-between"},as={class:"mr-8 flex-1"},ss={class:"mb-2 flex flex-wrap items-baseline gap-2"},os={class:"text-xl font-bold text-emerald-600 sm:text-2xl md:text-3xl"},rs={class:"text-sm font-medium text-green-600"},ns={class:"text-xs text-gray-500 dark:text-gray-400"},ls={class:"flex flex-wrap items-center justify-between gap-x-4"},is={class:"font-medium"},ds={class:"font-medium"},cs={key:0,class:"text-purple-600"},us={class:"font-medium"},ps={key:1,class:"text-purple-600"},gs={class:"font-medium"},ms={class:"stat-card"},xs={class:"flex items-center justify-between"},ys={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},fs={class:"text-xs text-gray-400"},vs={class:"text-2xl font-bold text-orange-600 sm:text-3xl"},hs={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},bs={key:0,class:"text-yellow-600"},ks={class:"stat-card"},_s={class:"flex items-center justify-between"},ws={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},Cs={class:"text-xs text-gray-400"},Ts={class:"text-2xl font-bold text-rose-600 sm:text-3xl"},Ds={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Ss={key:0,class:"text-yellow-600"},As={class:"mb-8"},$s={class:"mb-4 flex flex-col gap-4 sm:mb-6"},Rs={class:"flex flex-col gap-2 lg:flex-row lg:items-center lg:justify-end"},Is={class:"flex flex-shrink-0 gap-1 overflow-x-auto rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},Ps=["onClick"],Us={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},Ks={class:"flex items-center gap-2"},Bs={key:0,class:"text-xs text-orange-600"},Ms={class:"flex items-center gap-2"},Os={class:"flex items-center rounded-lg bg-gray-100 px-3 py-1 dark:bg-gray-700"},qs={class:"relative inline-flex cursor-pointer items-center"},Ls={class:"ml-2.5 flex select-none items-center gap-1 text-sm font-medium text-gray-600 dark:text-gray-300"},Fs=["disabled"],zs={class:"hidden sm:inline"},Es={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},Gs={class:"card p-4 sm:p-6"},js={class:"relative",style:{height:"250px"}},Hs={class:"card p-4 sm:p-6"},Vs={key:0,class:"py-8 text-center"},Ns={key:1,class:"max-h-[250px] overflow-auto sm:max-h-[300px]"},Ys={class:"min-w-full"},Ws={class:"divide-y divide-gray-200 dark:divide-gray-600"},Js={class:"px-2 py-2 text-xs text-gray-900 dark:text-gray-100 sm:px-4 sm:text-sm"},Qs=["title"],Zs={class:"hidden px-2 py-2 text-right text-xs text-gray-600 dark:text-gray-400 sm:table-cell sm:px-4 sm:text-sm"},Xs={class:"px-2 py-2 text-right text-xs text-gray-600 dark:text-gray-400 sm:px-4 sm:text-sm"},to={class:"px-2 py-2 text-right text-xs font-medium text-green-600 sm:px-4 sm:text-sm"},eo={class:"hidden px-2 py-2 text-right text-xs font-medium sm:table-cell sm:px-4 sm:text-sm"},ao={class:"inline-flex items-center rounded-full bg-blue-100 px-2 py-1 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"},so={class:"mb-4 sm:mb-6 md:mb-8"},oo={class:"card p-4 sm:p-6"},ro={class:"sm:h-[300px]",style:{height:"250px"}},no={class:"mb-4 sm:mb-6 md:mb-8"},lo={class:"card p-4 sm:p-6"},io={class:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},co={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},uo={class:"mb-4 text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},po={key:0},go={key:1},mo={class:"sm:h-[400px]",style:{height:"350px"}},xo={class:"mt-8 border-t border-gray-100 pt-6 dark:border-gray-700"},yo={class:"overflow-x-auto"},fo={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},vo={class:"bg-gray-50 dark:bg-gray-800"},ho={class:"flex items-center justify-end gap-1"},bo={key:1,class:"fas fa-sort ml-1 text-gray-400"},ko={class:"flex items-center justify-end gap-1"},_o={key:1,class:"fas fa-sort ml-1 text-gray-400"},wo={class:"flex items-center justify-end gap-1"},Co={key:1,class:"fas fa-sort ml-1 text-gray-400"},To={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},Do={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400"},So={class:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900 dark:text-gray-100"},Ao=["onClick"],$o={class:"text-xs text-gray-400"},Ro={class:"whitespace-nowrap px-6 py-4 text-right text-sm text-gray-500 dark:text-gray-400"},Io={class:"whitespace-nowrap px-6 py-4 text-right text-sm text-gray-500 dark:text-gray-400"},Po={class:"whitespace-nowrap px-6 py-4 text-right text-sm text-green-600 dark:text-green-400"},Uo={class:"whitespace-nowrap px-6 py-4 text-center text-sm font-medium"},Ko=["onClick"],Bo={key:0},Mo={key:0,class:"mt-4 flex justify-end"},Oo={class:"mb-4 sm:mb-6 md:mb-8"},qo={class:"card p-4 sm:p-6"},Lo={class:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Fo={class:"flex flex-col gap-1 sm:flex-row sm:items-center sm:gap-3"},zo={class:"text-xs text-gray-500 dark:text-gray-400 sm:text-sm"},Eo={class:"flex flex-wrap items-center gap-2"},Go={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},jo=["onClick"],Ho={class:"mb-4 flex flex-wrap items-center gap-2 text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},Vo={key:0},No={key:0,class:"py-12 text-center text-sm text-gray-500 dark:text-gray-400"},Yo={key:1,class:"sm:h-[350px]",style:{height:"300px"}},Wo={key:0,class:"py-12 text-center"},Jo={key:1},Qo={class:"mb-6 grid grid-cols-3 gap-4 rounded-lg bg-gray-50 p-4 dark:bg-gray-800"},Zo={class:"text-center"},Xo={class:"text-xl font-bold text-gray-900 dark:text-gray-100"},tr={class:"text-center"},er={class:"text-xl font-bold text-blue-600 dark:text-blue-400"},ar={class:"text-center"},sr={class:"text-xl font-bold text-green-600 dark:text-green-400"},or={class:"mb-6"},rr={class:"h-[300px] w-full"},nr={key:0,class:"mt-6"},lr={class:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700"},ir={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},dr={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},cr={class:"whitespace-nowrap px-4 py-3 text-sm font-medium text-gray-900 dark:text-gray-100"},ur={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},pr={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},gr={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},mr={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},xr={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},yr={class:"whitespace-nowrap px-4 py-3 text-right text-sm font-medium text-blue-600 dark:text-blue-400"},fr={class:"whitespace-nowrap px-4 py-3 text-right text-sm font-medium text-green-600 dark:text-green-400"},vr={key:1,class:"mt-6"},hr={class:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700"},br={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},kr={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},_r={class:"whitespace-nowrap px-6 py-3 text-sm font-medium text-gray-900 dark:text-gray-100"},wr={class:"whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},Cr={class:"whitespace-nowrap px-6 py-3 text-right text-sm font-medium text-blue-600 dark:text-blue-400"},Tr={class:"whitespace-nowrap px-6 py-3 text-right text-sm font-medium text-green-600 dark:text-green-400"},Dr={__name:"DashboardView",setup(qt){const mt=Ie(),j=Ae(),{isDarkMode:rt}=de(j),{dashboardData:n,costsData:Dt,dashboardModelStats:et,trendData:nt,apiKeysTrendData:q,accountUsageTrendData:L,accountUsageGroup:lt,formattedUptime:Lt,dateFilter:F,trendGranularity:J,apiKeysTrendMetric:Q}=de(mt),{loadDashboardData:St,loadApiKeysTrend:Ht,setDateFilterPreset:l,onCustomDateRangeChange:O,setTrendGranularity:At,refreshChartsData:xt,setAccountUsageGroup:Vt,disabledDate:z}=mt,it=[new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)],at=w(null),Y=w(null),$t=w(null),yt=w(null);let st=null,ot=null,Z=null,H=null;const Nt=[{value:"claude",label:"Claude"},{value:"openai",label:"OpenAI"},{value:"gemini",label:"Gemini"},{value:"droid",label:"Droid"}],Rt=w(!1),V=w({totalBalance:0,totalCost:0,lowBalanceCount:0,platforms:{}}),dt=w(!1),ft=w(null),Yt=o=>({claude:"Claude","claude-console":"Claude Console",gemini:"Gemini","gemini-api":"Gemini API",openai:"OpenAI","openai-responses":"OpenAI Responses",azure_openai:"Azure OpenAI",bedrock:"Bedrock",droid:"Droid",ccr:"CCR"})[o]||o,c=Ot(()=>{var u;const o=[],e=((u=V.value)==null?void 0:u.platforms)||{};return Object.entries(e).forEach(([D,f])=>{(Array.isArray(f==null?void 0:f.accounts)?f.accounts:[]).forEach(P=>{var S,v;const b=P==null?void 0:P.data;if(!b)return;const R=(S=b.balance)==null?void 0:S.amount,M=(v=b.quota)==null?void 0:v.percentage,s=typeof R=="number"&&R<10,p=typeof M=="number"&&M>90;(s||p)&&o.push({...b,name:(P==null?void 0:P.name)||b.accountId,platform:b.platform||D})})}),o}),x=o=>{const e=Number(o);return Number.isFinite(e)?e>=1?`$${e.toFixed(2)}`:e>=.01?`$${e.toFixed(3)}`:`$${e.toFixed(6)}`:"$0.00"},i=o=>{if(!o)return"æœªçŸ¥";const e=new Date(o);return Number.isNaN(e.getTime())?"æœªçŸ¥":e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})},d=async()=>{dt.value=!0;const o=await $e();o!=null&&o.success?(V.value=o.data||{totalBalance:0,totalCost:0,lowBalanceCount:0,platforms:{}},ft.value=new Date().toISOString()):o!=null&&o.message&&(console.debug("åŠ è½½ä½™é¢æ±‡æ€»å¤±è´¥:",o.message),jt("åŠ è½½ä½™é¢æ±‡æ€»å¤±è´¥","error")),dt.value=!1},h=w(!1),y=w(30),_=w(null),C=w(0),A=w(null),K=w(!1),k=Ot(()=>({text:rt.value?"#e5e7eb":"#374151",grid:rt.value?"rgba(75, 85, 99, 0.3)":"rgba(0, 0, 0, 0.1)",legend:rt.value?"#e5e7eb":"#374151"}));function N(o){return Number.isFinite(o)?o>=1?`$${o.toFixed(2)}`:o>=.01?`$${o.toFixed(3)}`:`$${o.toFixed(6)}`:"$0.000000"}function vt(o,e){if(!e||e.length===0)return 0;const u=e.reduce((D,f)=>D+f.allTokens,0);return u===0?0:(o/u*100).toFixed(1)}function ht(){if(!at.value)return;st&&st.destroy();const o=et.value||[],e={labels:o.map(u=>u.model),datasets:[{data:o.map(u=>u.allTokens),backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],borderWidth:0}]};st=new Mt(at.value,{type:"doughnut",data:e,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,usePointStyle:!0,font:{size:12},color:k.value.legend}},tooltip:{callbacks:{label:function(u){const D=u.label||"",f=$(u.parsed),T=vt(u.parsed,o);return`${D}: ${f} (${T}%)`}}}}}})}function bt(){var s;if(!Y.value)return;ot&&ot.destroy();const o=nt.value||[],e=o.map(p=>p.inputTokens||0),u=o.map(p=>p.outputTokens||0),D=o.map(p=>p.cacheCreateTokens||0),f=o.map(p=>p.cacheReadTokens||0),T=o.map(p=>p.requests||0),P=o.map(p=>p.cost||0),b=(s=o[0])!=null&&s.date?"date":"hour",M={labels:o.map(p=>{if(p.label)return p.label;if(b==="hour"){const v=new Date(p.hour),B=String(v.getMonth()+1).padStart(2,"0"),tt=String(v.getDate()).padStart(2,"0"),E=String(v.getHours()).padStart(2,"0");return`${B}/${tt} ${E}:00`}const S=p.date;if(S&&S.includes("-")){const v=S.split("-");if(v.length>=3)return`${v[1]}/${v[2]}`}return p.date}),datasets:[{label:"è¾“å…¥Token",data:e,borderColor:j.currentColorScheme.primary,backgroundColor:`${j.currentColorScheme.primary}1a`,tension:.3},{label:"è¾“å‡ºToken",data:u,borderColor:j.currentColorScheme.accent,backgroundColor:`${j.currentColorScheme.accent}1a`,tension:.3},{label:"ç¼“å­˜åˆ›å»ºToken",data:D,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3},{label:"ç¼“å­˜è¯»å–Token",data:f,borderColor:j.currentColorScheme.secondary,backgroundColor:`${j.currentColorScheme.secondary}1a`,tension:.3},{label:"è´¹ç”¨ (USD)",data:P,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.3,yAxisID:"y2"},{label:"è¯·æ±‚æ•°",data:T,borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.3,yAxisID:"y1"}]};ot=new Mt(Y.value,{type:"line",data:M,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{title:{display:!0,text:"Tokenä½¿ç”¨è¶‹åŠ¿",font:{size:16,weight:"bold"},color:k.value.text},legend:{position:"top",labels:{color:k.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:function(p,S){const v=p.dataset.label||"",B=S.dataset.label||"";return v==="è´¹ç”¨ (USD)"||B==="è´¹ç”¨ (USD)"?v==="è´¹ç”¨ (USD)"?-1:1:v==="è¯·æ±‚æ•°"||B==="è¯·æ±‚æ•°"?v==="è¯·æ±‚æ•°"?1:-1:S.parsed.y-p.parsed.y},callbacks:{label:function(p){const S=p.dataset.label||"";let v=p.parsed.y;return S==="è´¹ç”¨ (USD)"?v<.01?S+": $"+v.toFixed(6):S+": $"+v.toFixed(4):S==="è¯·æ±‚æ•°"?S+": "+v.toLocaleString()+" æ¬¡":v>=1e6?S+": "+(v/1e6).toFixed(2)+"M tokens":v>=1e3?S+": "+(v/1e3).toFixed(2)+"K tokens":S+": "+v.toLocaleString()+" tokens"}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:J==="hour"?"æ—¶é—´":"æ—¥æœŸ",color:k.value.text},ticks:{color:k.value.text},grid:{color:k.value.grid}},y:{type:"linear",display:!0,position:"left",min:0,title:{display:!0,text:"Tokenæ•°é‡",color:k.value.text},ticks:{callback:function(p){return $(p)},color:k.value.text},grid:{color:k.value.grid}},y1:{type:"linear",display:!0,position:"right",min:0,title:{display:!0,text:"è¯·æ±‚æ•°",color:k.value.text},grid:{drawOnChartArea:!1},ticks:{callback:function(p){return p.toLocaleString()},color:k.value.text}},y2:{type:"linear",display:!1,position:"right",min:0}}}})}const It=w(!1),X=w(null),Ft=w([]),kt=w([]),Pt=w([]),zt=w(!1),Wt=w(null);let Jt=null;const _t=w(1),wt=w(5),Ct=w("requests"),ct=w("desc"),ue=Ot(()=>{const o=[...q.value.apiKeyStats||[]],e=Ct.value,u=ct.value;return o.sort((D,f)=>{let T,P;switch(e){case"requests":T=D.requests||0,P=f.requests||0;break;case"tokens":T=D.tokens||0,P=f.tokens||0;break;case"cost":T=D.cost||0,P=f.cost||0;break;default:return 0}return u==="asc"?T-P:P-T}),o}),se=Ot(()=>{const o=ue.value,e=(_t.value-1)*wt.value,u=e+wt.value;return o.slice(e,u)}),Qt=o=>{Ct.value===o?ct.value=ct.value==="asc"?"desc":"asc":(Ct.value=o,ct.value="desc"),_t.value=1},oe=o=>{_t.value=o};function Ut(){if(!$t.value)return;Z&&Z.destroy();const o=(q.value.apiKeyStats||[]).slice(0,50),e=Q.value,u=o.map(b=>b.name||b.id),D=o.map(b=>e==="tokens"?b.tokens:b.requests),f=o.map((b,R)=>{const M=["rgba(59, 130, 246, 0.7)","rgba(16, 185, 129, 0.7)","rgba(245, 158, 11, 0.7)","rgba(239, 68, 68, 0.7)","rgba(139, 92, 246, 0.7)","rgba(236, 72, 153, 0.7)","rgba(20, 184, 166, 0.7)","rgba(249, 115, 22, 0.7)","rgba(99, 102, 241, 0.7)","rgba(132, 204, 22, 0.7)"];return M[R%M.length]}),T=f.map(b=>b.replace("0.7","1")),P={labels:u,datasets:[{label:e==="tokens"?"Token æ•°é‡":"è¯·æ±‚æ¬¡æ•°",data:D,backgroundColor:f,borderColor:T,borderWidth:1,borderRadius:4}]};Z=new Mt($t.value,{type:"bar",data:P,options:{indexAxis:"x",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(b){const R=b.parsed.y,M=b.dataIndex,s=o[M];let p="";return e==="tokens"?p=`${$(R)} tokens`:p=`${R.toLocaleString()} æ¬¡`,`${p} (${s.formattedCost})`}}}},scales:{x:{grid:{display:!1},ticks:{color:k.value.text,maxRotation:45,minRotation:45,autoSkip:!1}},y:{grid:{color:k.value.grid},ticks:{color:k.value.text,callback:b=>$(b)}}},onClick:(b,R)=>{if(R.length>0){const M=R[0].index,s=o[M];Zt(s)}}}})}const Zt=async o=>{X.value=o,It.value=!0,zt.value=!0;try{const e=q.value.data||[];Ft.value=e.map(u=>{var f;const D=((f=u.apiKeys)==null?void 0:f[o.id])||{requests:0,tokens:0,cost:0};return{date:u.label||u.date||u.hour,...D}});try{let u="monthly",D=`period=${u}`;F.value.type==="custom"&&F.value.customRange?(u="custom",D=`period=custom&startDate=${encodeURIComponent(F.value.customRange[0])}&endDate=${encodeURIComponent(F.value.customRange[1])}`):F.value.type==="preset"&&F.value.preset==="today"&&(u="daily",D="period=daily");const f=await Re(o.id,D);f.success&&f.data?kt.value=f.data:kt.value=[]}catch(u){console.error("åŠ è½½æ¨¡å‹ç»Ÿè®¡å¤±è´¥:",u),kt.value=[]}try{const u=new Map,D=q.value.data||[];console.log("Loading daily usage for API Key:",o.id),console.log("Full trend data points:",D.length),D.forEach(f=>{var P;const T=(P=f.apiKeys)==null?void 0:P[o.id];if(T&&T.requests>0){let b=f.date||f.label||f.hour;b&&b.includes("T")?b=b.split("T")[0]:b&&b.includes(" ")&&(b=b.split(" ")[0]),u.has(b)||u.set(b,{date:b,requests:0,tokens:0,inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,cost:0});const R=u.get(b);R.requests+=T.requests||0,R.inputTokens+=T.inputTokens||0,R.outputTokens+=T.outputTokens||0,R.cacheCreateTokens+=T.cacheCreateTokens||0,R.cacheReadTokens+=T.cacheReadTokens||0,R.tokens+=T.tokens||0,R.cost+=T.cost||0}}),console.log("Daily usage map:",Array.from(u.entries())),Pt.value=Array.from(u.values()).map(f=>{const T=f.tokens>0?f.tokens:f.inputTokens+f.outputTokens+f.cacheCreateTokens+f.cacheReadTokens;return console.log(`Date: ${f.date}, tokens: ${f.tokens}, calculated: ${f.inputTokens+f.outputTokens+f.cacheCreateTokens+f.cacheReadTokens}, final: ${T}`),{...f,allTokens:T,formatted:{totalCost:f.cost>=.01?`$${f.cost.toFixed(2)}`:"<$0.01"}}}).sort((f,T)=>T.date.localeCompare(f.date))}catch(u){console.error("åŠ è½½æŒ‰å¤©ç”¨é‡ç»Ÿè®¡å¤±è´¥:",u),Pt.value=[]}zt.value=!1,await W(),setTimeout(()=>{pe()},100)}catch(e){console.error("åˆ›å»ºå›¾è¡¨å¤±è´¥:",e),zt.value=!1}};function pe(){if(!Wt.value){console.warn("Canvas ref not available for API Key detail chart");return}try{Jt&&Jt.destroy();const o=Ft.value;if(!o||o.length===0){console.warn("No trend data available for chart");return}const e=o.map(u=>u.date&&u.date.includes("T")?`${new Date(u.date).getHours()}:00`:u.date);console.log("Creating API Key detail chart with",o.length,"data points"),Jt=new Mt(Wt.value,{type:"line",data:{labels:e,datasets:[{label:"Token æ¶ˆè€—",data:o.map(u=>u.tokens),borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",yAxisID:"y",tension:.3,fill:!0},{label:"è¯·æ±‚æ¬¡æ•°",data:o.map(u=>u.requests),borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.1)",yAxisID:"y1",tension:.3,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top",labels:{color:k.value.legend}},tooltip:{callbacks:{label:function(u){const D=u.dataset.label||"",f=u.parsed.y;return u.dataset.yAxisID==="y"?`${D}: ${$(f)}`:`${D}: ${f.toLocaleString()}`}}}},scales:{x:{ticks:{color:k.value.text},grid:{color:k.value.grid}},y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Tokens",color:k.value.text},ticks:{color:k.value.text,callback:u=>$(u)},grid:{color:k.value.grid}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"è¯·æ±‚æ•°",color:k.value.text},ticks:{color:k.value.text},grid:{display:!1}}}}})}catch(o){console.error("Failed to create API Key detail chart:",o)}}async function re(){await Ht(Q.value),await W(),Ut()}function Kt(){var b,R,M;if(!yt.value)return;H&&H.destroy();const o=((b=L.value)==null?void 0:b.data)||[],e=((R=L.value)==null?void 0:R.topAccounts)||[],u=["#2563EB","#059669","#D97706","#DC2626","#7C3AED","#F472B6","#0EA5E9","#F97316","#6366F1","#22C55E"],D=e.map((s,p)=>{var B,tt;const S=o.map(E=>!E.accounts||!E.accounts[s]?0:E.accounts[s].cost||0);return{label:((tt=(B=o.find(E=>E.accounts&&E.accounts[s]))==null?void 0:B.accounts[s])==null?void 0:tt.name)||`è´¦å· ${String(s).slice(0,6)}`,data:S,borderColor:u[p%u.length],backgroundColor:u[p%u.length]+"20",tension:.4,fill:!1}}),f=(M=o[0])!=null&&M.date?"date":"hour",T={labels:o.map(s=>{if(s.label)return s.label;if(f==="hour"){const p=new Date(s.hour),S=String(p.getMonth()+1).padStart(2,"0"),v=String(p.getDate()).padStart(2,"0"),B=String(p.getHours()).padStart(2,"0");return`${S}/${v} ${B}:00`}if(s.date&&s.date.includes("-")){const p=s.date.split("-");if(p.length>=3)return`${p[1]}/${p[2]}`}return s.date}),datasets:D},P=e;H=new Mt(yt.value,{type:"line",data:T,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,font:{size:12},color:k.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:(s,p)=>p.parsed.y-s.parsed.y,callbacks:{label:function(s){var ie;const p=s.dataset.label||"",S=s.parsed.y||0,v=s.dataIndex,B=s.datasetIndex,tt=P[B],E=L.value.data[v],Tt=(ie=E==null?void 0:E.accounts)==null?void 0:ie[tt],te=s.chart.data.datasets.map((Bt,ee)=>({value:Bt.data[v]||0,index:ee})).sort((Bt,ee)=>ee.value-Bt.value).findIndex(Bt=>Bt.index===B)+1;let Et="";te===1?Et="ğŸ¥‡ ":te===2?Et="ğŸ¥ˆ ":te===3&&(Et="ğŸ¥‰ ");const me=(Tt==null?void 0:Tt.formattedCost)||N(S),xe=(Tt==null?void 0:Tt.requests)||0;return`${Et}${p}: ${me} / ${xe.toLocaleString()} æ¬¡`}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:J.value==="hour"?"æ—¶é—´":"æ—¥æœŸ",color:k.value.text},ticks:{color:k.value.text},grid:{color:k.value.grid}},y:{beginAtZero:!0,min:0,title:{display:!0,text:"æ¶ˆè€—é‡‘é¢ (USD)",color:k.value.text},ticks:{callback:s=>N(Number(s)),color:k.value.text},grid:{color:k.value.grid}}}}})}async function ge(o){if(!(lt.value===o||Rt.value)){Rt.value=!0;try{await Vt(o),await W(),Kt()}finally{Rt.value=!1}}}ut(et,()=>{W(()=>ht())}),ut(nt,()=>{W(()=>bt())}),ut(q,()=>{W(()=>Ut())}),ut(L,()=>{W(()=>Kt())});async function Xt(){if(!K.value){K.value=!0;try{await Promise.all([St(),xt(),d()])}finally{K.value=!1}}}function ne(){h.value&&(C.value=y.value,A.value&&clearInterval(A.value),_.value&&clearTimeout(_.value),A.value=setInterval(()=>{C.value--,C.value<=0&&clearInterval(A.value)},1e3),_.value=setTimeout(async()=>{await Xt(),h.value&&ne()},y.value*1e3))}function le(){A.value&&(clearInterval(A.value),A.value=null),_.value&&(clearTimeout(_.value),_.value=null),C.value=0}return ut(h,o=>{o?ne():le()}),ut(rt,()=>{W(()=>{ht(),bt(),Ut(),Kt()})}),ut(()=>j.colorScheme,()=>{W(()=>{ht(),bt(),Ut(),Kt()})}),be(async()=>{await Xt(),await W(),ht(),bt(),Ut(),Kt()}),ke(()=>{le(),st&&st.destroy(),ot&&ot.destroy(),Z&&Z.destroy(),H&&H.destroy()}),(o,e)=>{var T,P,b,R,M;const u=ye,D=fe,f=ve;return m(),g("div",null,[t("div",Pe,[t("div",Ue,[t("div",Ke,[t("div",null,[e[14]||(e[14]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," æ€»API Keys ",-1)),t("p",Be,r(a(n).totalApiKeys),1),t("p",Me," æ´»è·ƒ: "+r(a(n).activeApiKeys||0),1)]),e[15]||(e[15]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-blue-500 to-blue-600"},[t("i",{class:"fas fa-key"})],-1))])]),t("div",Oe,[t("div",qe,[t("div",Le,[e[23]||(e[23]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," æœåŠ¡è´¦æˆ· ",-1)),t("div",Fe,[t("p",ze,r(a(n).totalAccounts),1),a(n).accountsByPlatform?(m(),g("div",Ee,[a(n).accountsByPlatform.claude&&a(n).accountsByPlatform.claude.total>0?(m(),g("div",{key:0,class:"inline-flex items-center gap-0.5",title:`Claude: ${a(n).accountsByPlatform.claude.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.claude.normal})`},[e[16]||(e[16]=t("i",{class:"fas fa-brain text-xs text-indigo-600"},null,-1)),t("span",je,r(a(n).accountsByPlatform.claude.total),1)],8,Ge)):I("",!0),a(n).accountsByPlatform["claude-console"]&&a(n).accountsByPlatform["claude-console"].total>0?(m(),g("div",{key:1,class:"inline-flex items-center gap-0.5",title:`Console: ${a(n).accountsByPlatform["claude-console"].total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform["claude-console"].normal})`},[e[17]||(e[17]=t("i",{class:"fas fa-terminal text-xs text-purple-600"},null,-1)),t("span",Ve,r(a(n).accountsByPlatform["claude-console"].total),1)],8,He)):I("",!0),a(n).accountsByPlatform.gemini&&a(n).accountsByPlatform.gemini.total>0?(m(),g("div",{key:2,class:"inline-flex items-center gap-0.5",title:`Gemini: ${a(n).accountsByPlatform.gemini.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.gemini.normal})`},[e[18]||(e[18]=t("i",{class:"fas fa-robot text-xs text-yellow-600"},null,-1)),t("span",Ye,r(a(n).accountsByPlatform.gemini.total),1)],8,Ne)):I("",!0),a(n).accountsByPlatform.bedrock&&a(n).accountsByPlatform.bedrock.total>0?(m(),g("div",{key:3,class:"inline-flex items-center gap-0.5",title:`Bedrock: ${a(n).accountsByPlatform.bedrock.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.bedrock.normal})`},[e[19]||(e[19]=t("i",{class:"fab fa-aws text-xs text-orange-600"},null,-1)),t("span",Je,r(a(n).accountsByPlatform.bedrock.total),1)],8,We)):I("",!0),a(n).accountsByPlatform.openai&&a(n).accountsByPlatform.openai.total>0?(m(),g("div",{key:4,class:"inline-flex items-center gap-0.5",title:`OpenAI: ${a(n).accountsByPlatform.openai.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.openai.normal})`},[e[20]||(e[20]=t("i",{class:"fas fa-openai text-xs text-gray-100"},null,-1)),t("span",Ze,r(a(n).accountsByPlatform.openai.total),1)],8,Qe)):I("",!0),a(n).accountsByPlatform.azure_openai&&a(n).accountsByPlatform.azure_openai.total>0?(m(),g("div",{key:5,class:"inline-flex items-center gap-0.5",title:`Azure OpenAI: ${a(n).accountsByPlatform.azure_openai.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.azure_openai.normal})`},[e[21]||(e[21]=t("i",{class:"fab fa-microsoft text-xs text-blue-600"},null,-1)),t("span",ta,r(a(n).accountsByPlatform.azure_openai.total),1)],8,Xe)):I("",!0),a(n).accountsByPlatform["openai-responses"]&&a(n).accountsByPlatform["openai-responses"].total>0?(m(),g("div",{key:6,class:"inline-flex items-center gap-0.5",title:`OpenAI Responses: ${a(n).accountsByPlatform["openai-responses"].total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform["openai-responses"].normal})`},[e[22]||(e[22]=t("i",{class:"fas fa-server text-xs text-cyan-600"},null,-1)),t("span",aa,r(a(n).accountsByPlatform["openai-responses"].total),1)],8,ea)):I("",!0)])):I("",!0)]),t("p",sa,[U(" æ­£å¸¸: "+r(a(n).normalAccounts||0)+" ",1),a(n).abnormalAccounts>0?(m(),g("span",oa," | å¼‚å¸¸: "+r(a(n).abnormalAccounts),1)):I("",!0),a(n).pausedAccounts>0?(m(),g("span",ra," | åœæ­¢è°ƒåº¦: "+r(a(n).pausedAccounts),1)):I("",!0),a(n).rateLimitedAccounts>0?(m(),g("span",na," | é™æµ: "+r(a(n).rateLimitedAccounts),1)):I("",!0)])]),e[24]||(e[24]=t("div",{class:"stat-icon ml-2 flex-shrink-0 bg-gradient-to-br from-green-500 to-green-600"},[t("i",{class:"fas fa-user-circle"})],-1))])]),t("div",la,[t("div",ia,[t("div",null,[e[25]||(e[25]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," ä»Šæ—¥è¯·æ±‚ ",-1)),t("p",da,r(a(n).todayRequests),1),t("p",ca," æ€»è¯·æ±‚: "+r(a($)(a(n).totalRequests||0)),1)]),e[26]||(e[26]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-purple-500 to-purple-600"},[t("i",{class:"fas fa-chart-line"})],-1))])]),t("div",ua,[t("div",pa,[t("div",null,[e[27]||(e[27]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," ç³»ç»ŸçŠ¶æ€ ",-1)),t("p",ga,r(a(n).systemStatus),1),t("p",ma," è¿è¡Œæ—¶é—´: "+r(a(Lt)),1)]),e[28]||(e[28]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-yellow-500 to-orange-500"},[t("i",{class:"fas fa-heartbeat"})],-1))])])]),t("div",xa,[t("div",ya,[t("div",fa,[t("div",null,[e[29]||(e[29]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," è´¦æˆ·ä½™é¢/é…é¢ ",-1)),t("p",va,r(x(V.value.totalBalance||0)),1),t("p",ha," ä½ä½™é¢: "+r(V.value.lowBalanceCount||0)+" | æ€»æˆæœ¬: "+r(x(V.value.totalCost||0)),1)]),e[30]||(e[30]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-emerald-500 to-green-600"},[t("i",{class:"fas fa-wallet"})],-1))]),t("div",ba,[t("p",ka," æ›´æ–°æ—¶é—´: "+r(i(ft.value)),1),t("button",{class:"flex items-center gap-2 rounded-lg border border-gray-200 bg-white px-3 py-1.5 text-xs font-medium text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:border-gray-500",disabled:dt.value,onClick:d},[t("i",{class:G(["fas",dt.value?"fa-spinner fa-spin":"fa-sync-alt"])},null,2),e[31]||(e[31]=U(" åˆ·æ–° ",-1))],8,_a)])]),t("div",wa,[t("div",Ca,[e[32]||(e[32]=t("h3",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},"ä½ä½™é¢è´¦æˆ·",-1)),t("span",Ta,r(c.value.length)+" ä¸ª ",1)]),dt.value?(m(),g("div",Da," æ­£åœ¨åŠ è½½... ")):c.value.length===0?(m(),g("div",Sa," å…¨éƒ¨æ­£å¸¸ ")):(m(),g("div",Aa,[(m(!0),g(pt,null,gt(c.value,s=>{var p;return m(),g("div",{key:s.accountId,class:"rounded-lg border border-red-200 bg-red-50 p-3 dark:border-red-900/60 dark:bg-red-900/20"},[t("div",$a,[t("div",Ra,r(s.name||s.accountId),1),t("span",Ia,r(Yt(s.platform)),1)]),t("div",Pa,[s.balance?(m(),g("span",Ua,"ä½™é¢: "+r(s.balance.formattedAmount),1)):(m(),g("span",Ka,"ä»Šæ—¥æˆæœ¬: "+r(x(((p=s.statistics)==null?void 0:p.dailyCost)||0)),1))]),s.quota&&typeof s.quota.percentage=="number"?(m(),g("div",Ba,[t("div",Ma,[e[33]||(e[33]=t("span",null,"é…é¢ä½¿ç”¨",-1)),t("span",Oa,r(s.quota.percentage.toFixed(1))+"% ",1)]),t("div",qa,[t("div",{class:"h-2 rounded-full bg-red-500",style:Te({width:`${Math.min(100,s.quota.percentage)}%`})},null,4)])])):I("",!0)])}),128))]))])]),t("div",La,[t("div",Fa,[t("div",za,[t("div",Ea,[e[38]||(e[38]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," ä»Šæ—¥Token ",-1)),t("div",Ga,[t("p",ja,r(a($)((a(n).todayInputTokens||0)+(a(n).todayOutputTokens||0)+(a(n).todayCacheCreateTokens||0)+(a(n).todayCacheReadTokens||0))),1),t("span",Ha,"/ "+r(a(Dt).todayCosts.formatted.totalCost),1)]),t("div",Va,[t("div",Na,[t("span",null,[e[34]||(e[34]=U("è¾“å…¥: ",-1)),t("span",Ya,r(a($)(a(n).todayInputTokens||0)),1)]),t("span",null,[e[35]||(e[35]=U("è¾“å‡º: ",-1)),t("span",Wa,r(a($)(a(n).todayOutputTokens||0)),1)]),(a(n).todayCacheCreateTokens||0)>0?(m(),g("span",Ja,[e[36]||(e[36]=U("ç¼“å­˜åˆ›å»º: ",-1)),t("span",Qa,r(a($)(a(n).todayCacheCreateTokens||0)),1)])):I("",!0),(a(n).todayCacheReadTokens||0)>0?(m(),g("span",Za,[e[37]||(e[37]=U("ç¼“å­˜è¯»å–: ",-1)),t("span",Xa,r(a($)(a(n).todayCacheReadTokens||0)),1)])):I("",!0)])])]),e[39]||(e[39]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-indigo-500 to-indigo-600"},[t("i",{class:"fas fa-coins"})],-1))])]),t("div",ts,[t("div",es,[t("div",as,[e[44]||(e[44]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," æ€»Tokenæ¶ˆè€— ",-1)),t("div",ss,[t("p",os,r(a($)((a(n).totalInputTokens||0)+(a(n).totalOutputTokens||0)+(a(n).totalCacheCreateTokens||0)+(a(n).totalCacheReadTokens||0))),1),t("span",rs,"/ "+r(a(Dt).totalCosts.formatted.totalCost),1)]),t("div",ns,[t("div",ls,[t("span",null,[e[40]||(e[40]=U("è¾“å…¥: ",-1)),t("span",is,r(a($)(a(n).totalInputTokens||0)),1)]),t("span",null,[e[41]||(e[41]=U("è¾“å‡º: ",-1)),t("span",ds,r(a($)(a(n).totalOutputTokens||0)),1)]),(a(n).totalCacheCreateTokens||0)>0?(m(),g("span",cs,[e[42]||(e[42]=U("ç¼“å­˜åˆ›å»º: ",-1)),t("span",us,r(a($)(a(n).totalCacheCreateTokens||0)),1)])):I("",!0),(a(n).totalCacheReadTokens||0)>0?(m(),g("span",ps,[e[43]||(e[43]=U("ç¼“å­˜è¯»å–: ",-1)),t("span",gs,r(a($)(a(n).totalCacheReadTokens||0)),1)])):I("",!0)])])]),e[45]||(e[45]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-emerald-500 to-emerald-600"},[t("i",{class:"fas fa-database"})],-1))])]),t("div",ms,[t("div",xs,[t("div",null,[t("p",ys,[e[46]||(e[46]=U(" å®æ—¶RPM ",-1)),t("span",fs,"("+r(a(n).metricsWindow)+"åˆ†é’Ÿ)",1)]),t("p",vs,r(a(n).realtimeRPM||0),1),t("p",hs,[e[48]||(e[48]=U(" æ¯åˆ†é’Ÿè¯·æ±‚æ•° ",-1)),a(n).isHistoricalMetrics?(m(),g("span",bs,e[47]||(e[47]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),U(" å†å²æ•°æ® ",-1)]))):I("",!0)])]),e[49]||(e[49]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-orange-500 to-orange-600"},[t("i",{class:"fas fa-tachometer-alt"})],-1))])]),t("div",ks,[t("div",_s,[t("div",null,[t("p",ws,[e[50]||(e[50]=U(" å®æ—¶TPM ",-1)),t("span",Cs,"("+r(a(n).metricsWindow)+"åˆ†é’Ÿ)",1)]),t("p",Ts,r(a($)(a(n).realtimeTPM||0)),1),t("p",Ds,[e[52]||(e[52]=U(" æ¯åˆ†é’ŸTokenæ•° ",-1)),a(n).isHistoricalMetrics?(m(),g("span",Ss,e[51]||(e[51]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),U(" å†å²æ•°æ® ",-1)]))):I("",!0)])]),e[53]||(e[53]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-rose-500 to-rose-600"},[t("i",{class:"fas fa-rocket"})],-1))])])]),t("div",As,[t("div",$s,[e[60]||(e[60]=t("h3",{class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"}," æ¨¡å‹ä½¿ç”¨åˆ†å¸ƒä¸Tokenä½¿ç”¨è¶‹åŠ¿ ",-1)),t("div",Rs,[t("div",Is,[(m(!0),g(pt,null,gt(a(F).presetOptions,s=>(m(),g("button",{key:s.value,class:G(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(F).preset===s.value&&a(F).type==="preset"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:p=>a(l)(s.value)},r(s.label),11,Ps))),128))]),t("div",Us,[t("button",{class:G(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(J)==="day"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[0]||(e[0]=s=>a(At)("day"))},e[54]||(e[54]=[t("i",{class:"fas fa-calendar-day mr-1"},null,-1),U("æŒ‰å¤© ",-1)]),2),t("button",{class:G(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(J)==="hour"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[1]||(e[1]=s=>a(At)("hour"))},e[55]||(e[55]=[t("i",{class:"fas fa-clock mr-1"},null,-1),U("æŒ‰å°æ—¶ ",-1)]),2)]),t("div",Ks,[ae(u,{modelValue:a(F).customRange,"onUpdate:modelValue":e[2]||(e[2]=s=>a(F).customRange=s),class:"custom-date-picker w-full lg:w-auto","default-time":it,"disabled-date":a(z),"end-placeholder":"ç»“æŸæ—¥æœŸ",format:"YYYY-MM-DD HH:mm:ss","range-separator":"è‡³",size:"default","start-placeholder":"å¼€å§‹æ—¥æœŸ",style:{"max-width":"400px"},type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss",onChange:a(O)},null,8,["modelValue","disabled-date","onChange"]),a(J)==="hour"?(m(),g("span",Bs,e[56]||(e[56]=[t("i",{class:"fas fa-info-circle"},null,-1),U(" æœ€å¤š24å°æ—¶ ",-1)]))):I("",!0)]),t("div",Ms,[t("div",Os,[t("label",qs,[_e(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>h.value=s),class:"peer sr-only",type:"checkbox"},null,512),[[we,h.value]]),e[59]||(e[59]=t("div",{class:"peer relative h-5 w-9 rounded-full bg-gray-300 transition-all duration-200 after:absolute after:left-[2px] after:top-0.5 after:h-4 after:w-4 after:rounded-full after:bg-white after:shadow-sm after:transition-transform after:duration-200 after:content-[''] peer-checked:bg-blue-500 peer-checked:after:translate-x-4 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:bg-gray-600 dark:after:bg-gray-300 dark:peer-focus:ring-blue-600"},null,-1)),t("span",Ls,[e[57]||(e[57]=t("i",{class:"fas fa-redo-alt text-xs text-gray-500 dark:text-gray-400"},null,-1)),e[58]||(e[58]=t("span",null,"è‡ªåŠ¨åˆ·æ–°",-1)),h.value?(m(),g("span",{key:0,class:G(["ml-1 font-mono text-xs text-blue-600 transition-opacity",C.value>0?"opacity-100":"opacity-0"])},r(C.value)+"s ",3)):I("",!0)])])]),t("button",{class:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-3 py-1 text-sm font-medium text-blue-600 shadow-sm transition-colors hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 sm:gap-2",disabled:K.value,title:"ç«‹å³åˆ·æ–°æ•°æ®",onClick:e[4]||(e[4]=s=>Xt())},[t("i",{class:G(["fas fa-sync-alt text-xs",{"animate-spin":K.value}])},null,2),t("span",zs,r(K.value?"åˆ·æ–°ä¸­":"åˆ·æ–°"),1)],8,Fs)])])]),t("div",Es,[t("div",Gs,[e[61]||(e[61]=t("h4",{class:"mb-4 text-base font-semibold text-gray-800 dark:text-gray-200 sm:text-lg"}," Tokenä½¿ç”¨åˆ†å¸ƒ ",-1)),t("div",js,[t("canvas",{ref_key:"modelUsageChart",ref:at},null,512)])]),t("div",Hs,[e[64]||(e[64]=t("h4",{class:"mb-4 text-base font-semibold text-gray-800 dark:text-gray-200 sm:text-lg"}," è¯¦ç»†ç»Ÿè®¡æ•°æ® ",-1)),a(et).length===0?(m(),g("div",Vs,e[62]||(e[62]=[t("p",{class:"text-sm text-gray-500 sm:text-base"},"æš‚æ— æ¨¡å‹ä½¿ç”¨æ•°æ®",-1)]))):(m(),g("div",Ns,[t("table",Ys,[e[63]||(e[63]=t("thead",{class:"sticky top-0 bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," æ¨¡å‹ "),t("th",{class:"hidden px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:table-cell sm:px-4"}," è¯·æ±‚æ•° "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," æ€»Token "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," è´¹ç”¨ "),t("th",{class:"hidden px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:table-cell sm:px-4"}," å æ¯” ")])],-1)),t("tbody",Ws,[(m(!0),g(pt,null,gt(a(et),s=>(m(),g("tr",{key:s.model,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",Js,[t("span",{class:"block max-w-[100px] truncate sm:max-w-none",title:s.model},r(s.model),9,Qs)]),t("td",Zs,r(a($)(s.requests)),1),t("td",Xs,r(a($)(s.allTokens)),1),t("td",to,r(s.formatted?s.formatted.total:"$0.000000"),1),t("td",eo,[t("span",ao,r(vt(s.allTokens,a(et)))+"% ",1)])]))),128))])])]))])])]),t("div",so,[t("div",oo,[t("div",ro,[t("canvas",{ref_key:"usageTrendChart",ref:Y},null,512)])])]),t("div",no,[t("div",lo,[t("div",io,[e[67]||(e[67]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg"}," API Keys ä½¿ç”¨æ’è¡Œ ",-1)),t("div",co,[t("button",{class:G(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(Q)==="requests"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[5]||(e[5]=s=>(Q.value="requests",re()))},e[65]||(e[65]=[t("i",{class:"fas fa-exchange-alt mr-1"},null,-1),t("span",{class:"hidden sm:inline"},"è¯·æ±‚æ¬¡æ•°",-1),t("span",{class:"sm:hidden"},"è¯·æ±‚",-1)]),2),t("button",{class:G(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(Q)==="tokens"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[6]||(e[6]=s=>(Q.value="tokens",re()))},e[66]||(e[66]=[t("i",{class:"fas fa-coins mr-1"},null,-1),t("span",{class:"hidden sm:inline"},"Token æ•°é‡",-1),t("span",{class:"sm:hidden"},"Token",-1)]),2)])]),t("div",uo,[(((T=a(q).apiKeyStats)==null?void 0:T.length)||0)>50?(m(),g("span",po," å…± "+r((P=a(q).apiKeyStats)==null?void 0:P.length)+" ä¸ª API Keyï¼Œå›¾è¡¨æ˜¾ç¤º Top 50 ",1)):(m(),g("span",go," å…± "+r(((b=a(q).apiKeyStats)==null?void 0:b.length)||0)+" ä¸ª API Key ",1)),e[68]||(e[68]=t("span",{class:"ml-2 text-gray-400"},"(ç‚¹å‡»æŸ±çŠ¶å›¾æŸ¥çœ‹è¯¦æƒ…)",-1))]),t("div",mo,[t("canvas",{ref_key:"apiKeysUsageTrendChart",ref:$t},null,512)]),t("div",xo,[e[76]||(e[76]=t("h4",{class:"mb-4 text-sm font-semibold text-gray-800 dark:text-gray-200"},"ä½¿ç”¨é‡æ˜ç»†è¡¨",-1)),t("div",yo,[t("table",fo,[t("thead",vo,[t("tr",null,[e[72]||(e[72]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ’å ",-1)),e[73]||(e[73]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," API Key åç§° ",-1)),t("th",{class:"cursor-pointer select-none px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",scope:"col",onClick:e[7]||(e[7]=s=>Qt("requests"))},[t("div",ho,[e[69]||(e[69]=t("span",null,"è¯·æ±‚æ•°",-1)),Ct.value==="requests"?(m(),g("i",{key:0,class:G(["fas ml-1",ct.value==="asc"?"fa-sort-up":"fa-sort-down"])},null,2)):(m(),g("i",bo))])]),t("th",{class:"cursor-pointer select-none px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",scope:"col",onClick:e[8]||(e[8]=s=>Qt("tokens"))},[t("div",ko,[e[70]||(e[70]=t("span",null,"Token æ€»é‡",-1)),Ct.value==="tokens"?(m(),g("i",{key:0,class:G(["fas ml-1",ct.value==="asc"?"fa-sort-up":"fa-sort-down"])},null,2)):(m(),g("i",_o))])]),t("th",{class:"cursor-pointer select-none px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",scope:"col",onClick:e[9]||(e[9]=s=>Qt("cost"))},[t("div",wo,[e[71]||(e[71]=t("span",null,"é¢„ä¼°è´¹ç”¨",-1)),Ct.value==="cost"?(m(),g("i",{key:0,class:G(["fas ml-1",ct.value==="asc"?"fa-sort-up":"fa-sort-down"])},null,2)):(m(),g("i",Co))])]),e[74]||(e[74]=t("th",{class:"px-6 py-3 text-center text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ“ä½œ ",-1))])]),t("tbody",To,[(m(!0),g(pt,null,gt(se.value,(s,p)=>(m(),g("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},[t("td",Do,r((_t.value-1)*wt.value+p+1),1),t("td",So,[t("button",{class:"text-blue-600 hover:text-blue-800 hover:underline dark:text-blue-400 dark:hover:text-blue-300",onClick:S=>Zt(s)},r(s.name||s.id),9,Ao),t("div",$o,r(s.id.substring(0,8))+"...",1)]),t("td",Ro,r(s.requests.toLocaleString()),1),t("td",Io,r(a($)(s.tokens)),1),t("td",Po,r(s.formattedCost),1),t("td",Uo,[t("button",{class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",onClick:S=>Zt(s)}," æŸ¥çœ‹è¯¦æƒ… ",8,Ko)])]))),128)),se.value.length===0?(m(),g("tr",Bo,e[75]||(e[75]=[t("td",{class:"px-6 py-4 text-center text-sm text-gray-500",colspan:"6"},"æš‚æ— æ•°æ®",-1)]))):I("",!0)])])]),(((R=a(q).apiKeyStats)==null?void 0:R.length)||0)>wt.value?(m(),g("div",Mo,[ae(D,{"current-page":_t.value,"onUpdate:currentPage":e[10]||(e[10]=s=>_t.value=s),"page-size":wt.value,"onUpdate:pageSize":e[11]||(e[11]=s=>wt.value=s),background:"",layout:"total, sizes, prev, pager, next","page-sizes":[5,10,20,50],small:"",total:((M=a(q).apiKeyStats)==null?void 0:M.length)||0,onCurrentChange:oe,onSizeChange:e[12]||(e[12]=s=>oe(1))},null,8,["current-page","page-size","total"])])):I("",!0)])])]),t("div",Oo,[t("div",qo,[t("div",Lo,[t("div",Fo,[e[77]||(e[77]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg"}," è´¦å·ä½¿ç”¨è¶‹åŠ¿ ",-1)),t("span",zo," å½“å‰åˆ†ç»„ï¼š"+r(a(L).groupLabel||"æœªé€‰æ‹©"),1)]),t("div",Eo,[t("div",Go,[(m(),g(pt,null,gt(Nt,s=>t("button",{key:s.value,class:G(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(lt)===s.value?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:p=>ge(s.value)},r(s.label),11,jo)),64))])])]),t("div",Ho,[t("span",null,"å…± "+r(a(L).totalAccounts||0)+" ä¸ªè´¦å·",1),a(L).topAccounts&&a(L).topAccounts.length?(m(),g("span",Vo," æ˜¾ç¤ºæ¶ˆè€—æ’åå‰ "+r(a(L).topAccounts.length)+" ä¸ªè´¦å· ",1)):I("",!0)]),!a(L).data||a(L).data.length===0?(m(),g("div",No," æš‚æ— è´¦å·ä½¿ç”¨æ•°æ® ")):(m(),g("div",Yo,[t("canvas",{ref_key:"accountUsageTrendChart",ref:yt},null,512)]))])]),ae(f,{modelValue:It.value,"onUpdate:modelValue":e[13]||(e[13]=s=>It.value=s),"append-to-body":"","destroy-on-close":"",style:{width:"90%","max-width":"1200px"},title:X.value?`API Key è¯¦æƒ…: ${X.value.name||X.value.id}`:"API Key è¯¦æƒ…"},{default:Ce(()=>{var s,p,S;return[zt.value?(m(),g("div",Wo,e[78]||(e[78]=[t("i",{class:"fas fa-spinner fa-spin text-2xl text-blue-500"},null,-1),t("p",{class:"mt-2 text-gray-500"},"åŠ è½½ä¸­...",-1)]))):(m(),g("div",Jo,[t("div",Qo,[t("div",Zo,[e[79]||(e[79]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"æ€»è¯·æ±‚æ•°",-1)),t("p",Xo,r((s=X.value)==null?void 0:s.requests.toLocaleString()),1)]),t("div",tr,[e[80]||(e[80]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Token æ€»é‡",-1)),t("p",er,r(a($)(((p=X.value)==null?void 0:p.tokens)||0)),1)]),t("div",ar,[e[81]||(e[81]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"é¢„ä¼°è´¹ç”¨",-1)),t("p",sr,r((S=X.value)==null?void 0:S.formattedCost),1)])]),t("div",or,[e[82]||(e[82]=t("h4",{class:"mb-3 text-sm font-semibold text-gray-800 dark:text-gray-200"}," ä½¿ç”¨è¶‹åŠ¿ (å½“å‰æ—¶é—´æ®µ) ",-1)),t("div",rr,[t("canvas",{ref_key:"apiKeyDetailChart",ref:Wt},null,512)])]),kt.value&&kt.value.length>0?(m(),g("div",nr,[e[84]||(e[84]=t("h4",{class:"mb-3 text-sm font-semibold text-gray-800 dark:text-gray-200"},"æ¨¡å‹ä½¿ç”¨æ˜ç»†",-1)),t("div",lr,[t("table",ir,[e[83]||(e[83]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ¨¡å‹ "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¯·æ±‚æ•° "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¾“å…¥ Token "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¾“å‡º Token "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," ç¼“å­˜åˆ›å»º "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," ç¼“å­˜è¯»å– "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ€»è®¡ "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è´¹ç”¨ ")])],-1)),t("tbody",dr,[(m(!0),g(pt,null,gt(kt.value,v=>{var B;return m(),g("tr",{key:v.model,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},[t("td",cr,r(v.model),1),t("td",ur,r(v.requests.toLocaleString()),1),t("td",pr,r(a($)(v.inputTokens)),1),t("td",gr,r(a($)(v.outputTokens)),1),t("td",mr,r(a($)(v.cacheCreateTokens)),1),t("td",xr,r(a($)(v.cacheReadTokens)),1),t("td",yr,r(a($)(v.allTokens)),1),t("td",fr,r(((B=v.formatted)==null?void 0:B.totalCost)||"$0.00"),1)])}),128))])])])])):I("",!0),Pt.value&&Pt.value.length>0?(m(),g("div",vr,[e[86]||(e[86]=t("h4",{class:"mb-3 text-sm font-semibold text-gray-800 dark:text-gray-200"},"æŒ‰å¤©ç”¨é‡æ˜ç»†",-1)),t("div",hr,[t("table",br,[e[85]||(e[85]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ—¥æœŸ "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¯·æ±‚æ¬¡æ•° "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ€» Token "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è´¹ç”¨ ")])],-1)),t("tbody",kr,[(m(!0),g(pt,null,gt(Pt.value,v=>{var B,tt;return m(),g("tr",{key:v.date,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},[t("td",_r,r(v.date),1),t("td",wr,r(((B=v.requests)==null?void 0:B.toLocaleString())||0),1),t("td",Cr,r(a($)(v.allTokens)),1),t("td",Tr,r(((tt=v.formatted)==null?void 0:tt.totalCost)||"$0.00"),1)])}),128))])])])])):I("",!0)]))]}),_:1},8,["modelValue","title"])])}}},Ur=Se(Dr,[["__scopeId","data-v-857a69b9"]]);export{Ur as default};
