import{E as xe,a as fe,b as ve}from"./element-plus-_zlBx3PA.js";import{aP as be,r as S,c as Kt,aX as ce,o as bt,q as he,D as J,V as ke,x,z as t,R as ae,P as r,u as a,L as I,O as U,C as G,Q as lt,ac as it,K as _e,al as we,J as Ce,y as f,B as Te}from"./vue-vendor-R8HMg95E.js";import{c as Q,s as Nt,_ as De,a as Se}from"./index-D5LSnW5i.js";import{C as Ut}from"./chart-yFHxLHpB.js";import"./vendor-Dr8jvgFu.js";const Ae=be("dashboard",()=>{const Mt=S(!1),dt=S({totalApiKeys:0,activeApiKeys:0,totalAccounts:0,normalAccounts:0,abnormalAccounts:0,pausedAccounts:0,activeAccounts:0,rateLimitedAccounts:0,accountsByPlatform:{claude:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},"claude-console":{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},gemini:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},azure_openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},bedrock:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0}},todayRequests:0,totalRequests:0,todayTokens:0,todayInputTokens:0,todayOutputTokens:0,totalTokens:0,totalInputTokens:0,totalOutputTokens:0,totalCacheCreateTokens:0,totalCacheReadTokens:0,todayCacheCreateTokens:0,todayCacheReadTokens:0,systemRPM:0,systemTPM:0,realtimeRPM:0,realtimeTPM:0,metricsWindow:5,isHistoricalMetrics:!1,systemStatus:"æ­£å¸¸",uptime:0,systemTimezone:8}),Ft=S({todayCosts:{totalCost:0,formatted:{totalCost:"$0.000000"}},totalCosts:{totalCost:0,formatted:{totalCost:"$0.000000"}}}),ct=S([]),n=S([]),ht=S([]),X=S({data:[],topApiKeys:[],totalApiKeys:0}),kt=S({data:[],topAccounts:[],totalAccounts:0,group:"claude",groupLabel:"Claudeè´¦æˆ·"}),L={preset:"dashboard:date:preset",granularity:"dashboard:trend:granularity"},F="today",_t="day",ut=p=>p==="hour"?[{value:"last24h",label:"è¿‘24å°æ—¶",hours:24},{value:"yesterday",label:"æ˜¨å¤©",hours:24},{value:"dayBefore",label:"å‰å¤©",hours:24}]:[{value:"today",label:"ä»Šæ—¥",days:1},{value:"7days",label:"7å¤©",days:7},{value:"30days",label:"30å¤©",days:30}],q=(p,k)=>{try{return localStorage.getItem(p)||k}catch{return k}},Z=(p,k)=>{try{localStorage.setItem(p,k)}catch{}},N=(p,k)=>ut(k).some(w=>w.value===p)?p:k==="hour"?"last24h":F,Ot=q(L.granularity,_t),wt=["day","hour"].includes(Ot)?Ot:_t,Ht=N(q(L.preset,F),wt),l=S({type:"preset",preset:Ht,customStart:"",customEnd:"",customRange:null,presetOptions:ut(wt)}),O=S(wt),Ct=S("requests"),pt=S("claude"),Vt=S([new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)]),Yt=Kt(()=>{const p=dt.value.uptime,k=Math.floor(p/86400),v=Math.floor(p%86400/3600),d=Math.floor(p%3600/60);return k>0?`${k}å¤© ${v}å°æ—¶`:v>0?`${v}å°æ—¶ ${d}åˆ†é’Ÿ`:`${d}åˆ†é’Ÿ`});function D(p,k=!0){const v=p.getFullYear(),d=p.getMonth(),w=p.getDate();return k?new Date(Date.UTC(v,d,w-1,16,0,0,0)):new Date(Date.UTC(v,d,w,15,59,59,999))}const tt=(p=l.value.preset,k=O.value)=>{Z(L.preset,p),Z(L.granularity,k)},H=()=>l.value.type==="preset"&&l.value.preset==="today"&&O.value==="day"?"hour":O.value;async function Tt(p=null){Mt.value=!0;try{let k={today:"today",all:"all"};p&&(k={today:{today:"today",all:"today"},"7days":{today:"7days",all:"7days"},monthly:{today:"monthly",all:"monthly"},all:{today:"today",all:"all"}}[p]||k);const[v,d,w]=await Promise.all([Q.get("/admin/dashboard"),Q.get(`/admin/usage-costs?period=${k.today}`),Q.get(`/admin/usage-costs?period=${k.all}`)]);if(v.success){const i=v.data.overview||{},c=v.data.recentActivity||{},u=v.data.systemAverages||{},b=v.data.realtimeMetrics||{},g=v.data.systemHealth||{};dt.value={totalApiKeys:i.totalApiKeys||0,activeApiKeys:i.activeApiKeys||0,totalAccounts:i.totalAccounts||i.totalClaudeAccounts||0,normalAccounts:i.normalAccounts||0,abnormalAccounts:i.abnormalAccounts||0,pausedAccounts:i.pausedAccounts||0,activeAccounts:i.activeAccounts||i.activeClaudeAccounts||0,rateLimitedAccounts:i.rateLimitedAccounts||i.rateLimitedClaudeAccounts||0,accountsByPlatform:i.accountsByPlatform||{claude:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},"claude-console":{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},gemini:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},azure_openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},bedrock:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0}},todayRequests:c.requestsToday||0,totalRequests:i.totalRequestsUsed||0,todayTokens:c.tokensToday||0,todayInputTokens:c.inputTokensToday||0,todayOutputTokens:c.outputTokensToday||0,totalTokens:i.totalTokensUsed||0,totalInputTokens:i.totalInputTokensUsed||0,totalOutputTokens:i.totalOutputTokensUsed||0,totalCacheCreateTokens:i.totalCacheCreateTokensUsed||0,totalCacheReadTokens:i.totalCacheReadTokensUsed||0,todayCacheCreateTokens:c.cacheCreateTokensToday||0,todayCacheReadTokens:c.cacheReadTokensToday||0,systemRPM:u.rpm||0,systemTPM:u.tpm||0,realtimeRPM:b.rpm||0,realtimeTPM:b.tpm||0,metricsWindow:b.windowMinutes||5,isHistoricalMetrics:b.isHistorical||!1,systemStatus:g.redisConnected?"æ­£å¸¸":"å¼‚å¸¸",uptime:g.uptime||0,systemTimezone:v.data.systemTimezone||8}}d.success&&w.success&&(Ft.value={todayCosts:d.data.totalCosts||{totalCost:0,formatted:{totalCost:"$0.000000"}},totalCosts:w.data.totalCosts||{totalCost:0,formatted:{totalCost:"$0.000000"}}})}catch(k){console.error("åŠ è½½ä»ªè¡¨æ¿æ•°æ®å¤±è´¥:",k)}finally{Mt.value=!1}}async function et(p=7,k=H()){try{let v="/admin/usage-trend?";if(k==="hour")if(v+="granularity=hour",l.value.customRange&&l.value.customRange.length===2)v+=`&startDate=${encodeURIComponent(l.value.customRange[0])}`,v+=`&endDate=${encodeURIComponent(l.value.customRange[1])}`;else{const w=new Date;let i,c;if(l.value.type==="preset")switch(l.value.preset){case"today":{i=D(w,!0),c=D(w,!1);break}case"last24h":{c=new Date(w),i=new Date(w.getTime()-24*60*60*1e3);break}case"yesterday":{const u=new Date;u.setDate(u.getDate()-1),i=D(u,!0),c=D(u,!1);break}case"dayBefore":{const u=new Date;u.setDate(u.getDate()-2),i=D(u,!0),c=D(u,!1);break}default:i=new Date(w.getTime()-24*60*60*1e3),c=w}else i=new Date(w.getTime()-p*24*60*60*1e3),c=w;v+=`&startDate=${encodeURIComponent(i.toISOString())}`,v+=`&endDate=${encodeURIComponent(c.toISOString())}`}else v+=`granularity=day&days=${p}`;const d=await Q.get(v);d.success&&(n.value=d.data)}catch(v){console.error("åŠ è½½ä½¿ç”¨è¶‹åŠ¿å¤±è´¥:",v)}}async function at(p="daily",k=null){const v=k||H();try{let d=`/admin/model-stats?period=${p}`;if(l.value.type==="custom"||v==="hour"){if(l.value.customRange&&l.value.customRange.length===2)d+=`&startDate=${encodeURIComponent(l.value.customRange[0])}`,d+=`&endDate=${encodeURIComponent(l.value.customRange[1])}`;else if(v==="hour"&&l.value.type==="preset"){const i=new Date;let c,u;switch(l.value.preset){case"today":{c=D(i,!0),u=D(i,!1);break}case"last24h":{u=new Date(i),c=new Date(i.getTime()-24*60*60*1e3);break}case"yesterday":{const b=new Date;b.setDate(b.getDate()-1),c=D(b,!0),u=D(b,!1);break}case"dayBefore":{const b=new Date;b.setDate(b.getDate()-2),c=D(b,!0),u=D(b,!1);break}default:c=new Date(i.getTime()-24*60*60*1e3),u=i}d+=`&startDate=${encodeURIComponent(c.toISOString())}`,d+=`&endDate=${encodeURIComponent(u.toISOString())}`}}else if(l.value.type==="preset"&&v==="day"){const i=new Date;let c,u;const b=l.value.presetOptions.find(g=>g.value===l.value.preset);if(b){if(l.value.preset==="today")c=D(i,!0),u=D(i,!1);else{const g=new Date;g.setDate(g.getDate()-(b.days-1)),c=D(g,!0),u=D(i,!1)}d+=`&startDate=${encodeURIComponent(c.toISOString())}`,d+=`&endDate=${encodeURIComponent(u.toISOString())}`}}const w=await Q.get(d);w.success&&(ht.value=w.data)}catch(d){console.error("åŠ è½½æ¨¡å‹ç»Ÿè®¡å¤±è´¥:",d)}}async function st(p="requests",k=null){const v=k||H();try{let d="/admin/api-keys-usage-trend?",w=7;if(v==="hour")if(d+="granularity=hour",l.value.customRange&&l.value.customRange.length===2)d+=`&startDate=${encodeURIComponent(l.value.customRange[0])}`,d+=`&endDate=${encodeURIComponent(l.value.customRange[1])}`;else{const c=new Date;let u,b;if(l.value.type==="preset")switch(l.value.preset){case"today":{u=D(c,!0),b=D(c,!1);break}case"last24h":{b=new Date(c),u=new Date(c.getTime()-24*60*60*1e3);break}case"yesterday":{const g=new Date;g.setDate(g.getDate()-1),u=D(g,!0),b=D(g,!1);break}case"dayBefore":{const g=new Date;g.setDate(g.getDate()-2),u=D(g,!0),b=D(g,!1);break}default:u=new Date(c.getTime()-24*60*60*1e3),b=c}else u=new Date(c.getTime()-24*60*60*1e3),b=c;d+=`&startDate=${encodeURIComponent(u.toISOString())}`,d+=`&endDate=${encodeURIComponent(b.toISOString())}`}else w=l.value.type==="preset"?l.value.preset==="today"?1:l.value.preset==="7days"?7:30:St(l.value.customStart,l.value.customEnd),d+=`granularity=day&days=${w}`;d+=`&metric=${p}`;const i=await Q.get(d);i.success&&(X.value={data:i.data||[],apiKeyStats:i.apiKeyStats||[],topApiKeys:i.topApiKeys||[],totalApiKeys:i.totalApiKeys||0})}catch(d){console.error("åŠ è½½API Keysè¶‹åŠ¿å¤±è´¥:",d)}}async function V(p=pt.value,k=null){const v=k||H();try{let d="/admin/account-usage-trend?",w=7;if(v==="hour")if(d+="granularity=hour",l.value.customRange&&l.value.customRange.length===2)d+=`&startDate=${encodeURIComponent(l.value.customRange[0])}`,d+=`&endDate=${encodeURIComponent(l.value.customRange[1])}`;else{const c=new Date;let u,b;if(l.value.type==="preset")switch(l.value.preset){case"today":{u=D(c,!0),b=D(c,!1);break}case"last24h":{b=new Date(c),u=new Date(c.getTime()-24*60*60*1e3);break}case"yesterday":{const g=new Date;g.setDate(g.getDate()-1),u=D(g,!0),b=D(g,!1);break}case"dayBefore":{const g=new Date;g.setDate(g.getDate()-2),u=D(g,!0),b=D(g,!1);break}default:u=new Date(c.getTime()-24*60*60*1e3),b=c}else u=new Date(c.getTime()-24*60*60*1e3),b=c;d+=`&startDate=${encodeURIComponent(u.toISOString())}`,d+=`&endDate=${encodeURIComponent(b.toISOString())}`}else w=l.value.type==="preset"?l.value.preset==="today"?1:l.value.preset==="7days"?7:30:St(l.value.customStart,l.value.customEnd),d+=`granularity=day&days=${w}`;d+=`&group=${p}`;const i=await Q.get(d);i.success&&(kt.value={data:i.data||[],topAccounts:i.topAccounts||[],totalAccounts:i.totalAccounts||0,group:i.group||p,groupLabel:i.groupLabel||""})}catch(d){console.error("åŠ è½½è´¦å·ä½¿ç”¨è¶‹åŠ¿å¤±è´¥:",d)}}function ot(p,k={}){const{silent:v=!1,skipSave:d=!1}=k,w=N(p,O.value);l.value.type="preset",l.value.preset=w;const i=l.value.presetOptions.find(T=>T.value===w),c=new Date;let u,b;if(O.value==="hour")switch(w){case"today":{u=D(c,!0),b=D(c,!1);break}case"last24h":{b=new Date(c),u=new Date(c.getTime()-24*60*60*1e3);break}case"yesterday":{const T=new Date;T.setDate(T.getDate()-1),u=D(T,!0),b=D(T,!1);break}case"dayBefore":{const T=new Date;T.setDate(T.getDate()-2),u=D(T,!0),b=D(T,!1);break}default:b=new Date(c),u=new Date(c.getTime()-24*60*60*1e3)}else u=new Date(c),b=new Date(c),w==="today"?(u.setHours(0,0,0,0),b.setHours(23,59,59,999)):i!=null&&i.days&&(u.setDate(c.getDate()-(i.days-1)),u.setHours(0,0,0,0),b.setHours(23,59,59,999));const g=T=>{const z=new Date(T),gt=z.getFullYear(),qt=String(z.getMonth()+1).padStart(2,"0"),$t=String(z.getDate()).padStart(2,"0"),Rt=String(z.getHours()).padStart(2,"0"),Pt=String(z.getMinutes()).padStart(2,"0"),Y=String(z.getSeconds()).padStart(2,"0");return`${gt}-${qt}-${$t} ${Rt}:${Pt}:${Y}`};l.value.customStart=u?u.toISOString().split("T")[0]:"",l.value.customEnd=b?b.toISOString().split("T")[0]:"",l.value.customRange=u&&b?[g(u),g(b)]:null,d||tt(l.value.preset,O.value),v||j()}function Dt(p){if(p&&p.length===2){l.value.type="custom",l.value.preset="",l.value.customRange=p,l.value.customStart=p[0].split(" ")[0],l.value.customEnd=p[1].split(" ")[0];const k=w=>{const[i,c]=w.split(" "),[u,b,g]=i.split("-").map(Number),[T,z,gt]=c.split(":").map(Number);return new Date(u,b-1,g,T,z,gt)},v=k(p[0]),d=k(p[1]);if(O.value==="hour"){if((d-v)/36e5>24){Nt("å°æ—¶ç²’åº¦ä¸‹æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡24å°æ—¶","warning");return}}else if(Math.ceil((d-v)/864e5)+1>31){Nt("æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡ 31 å¤©","warning");return}j()}else p===null&&ot(O.value==="hour"?"last24h":F)}function rt(p,k={}){const{silent:v=!1,skipSave:d=!1,presetOverride:w}=k;if(O.value=p,p==="hour"){if(l.value.presetOptions=ut("hour"),l.value.type==="custom"&&l.value.customRange&&l.value.customRange.length===2){const c=new Date(l.value.customRange[0]);if((new Date(l.value.customRange[1])-c)/(1e3*60*60)>24){Nt("å°æ—¶ç²’åº¦ä¸‹æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡24å°æ—¶ï¼Œå·²åˆ‡æ¢åˆ°è¿‘24å°æ—¶","warning"),ot("last24h",{silent:v,skipSave:d});return}}}else l.value.presetOptions=ut("day");if(l.value.type==="custom"){d||tt(l.value.preset||F,O.value),v||j();return}const i=w||N(l.value.preset,O.value);ot(i,{silent:!0,skipSave:!0}),d||tt(l.value.preset,O.value),v||j()}async function j(){let p,k="monthly";const v=H();if(l.value.type==="preset"){const d=l.value.presetOptions.find(w=>w.value===l.value.preset);v==="hour"?(p=1,k="daily"):(p=d?d.days:7,l.value.preset==="today"?k="daily":k="monthly")}else{if(v==="hour"){const d=new Date(l.value.customRange[0]),w=new Date(l.value.customRange[1]),i=Math.ceil((w-d)/(1e3*60*60));p=Math.ceil(i/24)||1}else p=St(l.value.customStart,l.value.customEnd);k="daily"}await Promise.all([et(p,v),at(k,v),st(Ct.value,v),V(pt.value,v)])}function Lt(p){return pt.value=p,V(p,H())}function St(p,k){if(!p||!k)return 7;const v=new Date(p),d=new Date(k),w=Math.abs(d-v);return Math.ceil(w/(1e3*60*60*24))||7}function At(p){return p>new Date}return ot(l.value.preset,{silent:!0,skipSave:!0}),tt(l.value.preset,O.value),{loading:Mt,dashboardData:dt,costsData:Ft,modelStats:ct,trendData:n,dashboardModelStats:ht,apiKeysTrendData:X,accountUsageTrendData:kt,dateFilter:l,trendGranularity:O,apiKeysTrendMetric:Ct,accountUsageGroup:pt,defaultTime:Vt,formattedUptime:Yt,loadDashboardData:Tt,loadUsageTrend:et,loadModelStats:at,loadApiKeysTrend:st,loadAccountUsageTrend:V,setDateFilterPreset:ot,onCustomDateRangeChange:Dt,setTrendGranularity:rt,refreshChartsData:j,setAccountUsageGroup:Lt,disabledDate:At}}),$e={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6 lg:grid-cols-4"},Re={class:"stat-card"},Pe={class:"flex items-center justify-between"},Ie={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},Be={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Ue={class:"stat-card"},Ke={class:"flex items-center justify-between"},Me={class:"flex-1"},Fe={class:"flex flex-wrap items-baseline gap-x-2"},Oe={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},Le={key:0,class:"flex items-center gap-2"},qe=["title"],ze={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ee=["title"],Ge={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},je=["title"],Ne={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},He=["title"],Ve={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ye=["title"],We={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Je=["title"],Qe={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Xe=["title"],Ze={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},ta={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ea={key:0,class:"text-red-600"},aa={key:1,class:"text-gray-600 dark:text-gray-400"},sa={key:2,class:"text-yellow-600"},oa={class:"stat-card"},ra={class:"flex items-center justify-between"},na={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},la={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ia={class:"stat-card"},da={class:"flex items-center justify-between"},ca={class:"text-2xl font-bold text-green-600 sm:text-3xl"},ua={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},pa={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6"},ga={class:"stat-card"},ma={class:"flex items-center justify-between"},ya={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},xa={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},fa={class:"mt-3 flex items-center justify-between gap-3"},va={class:"text-xs text-gray-500 dark:text-gray-400"},ba=["disabled"],ha={class:"card p-4 sm:p-6"},ka={class:"mb-3 flex items-center justify-between"},_a={class:"text-xs text-gray-500 dark:text-gray-400"},wa={key:0,class:"py-6 text-center text-sm text-gray-500 dark:text-gray-400"},Ca={key:1,class:"py-6 text-center text-sm text-green-600 dark:text-green-400"},Ta={key:2,class:"max-h-64 space-y-2 overflow-y-auto"},Da={class:"flex items-center justify-between gap-2"},Sa={class:"truncate text-sm font-medium text-gray-900 dark:text-gray-100"},Aa={class:"rounded bg-gray-100 px-2 py-0.5 text-xs text-gray-600 dark:bg-gray-700 dark:text-gray-300"},$a={class:"mt-1 text-xs text-gray-600 dark:text-gray-400"},Ra={key:0},Pa={key:1},Ia={key:0,class:"mt-2"},Ba={class:"mb-1 flex items-center justify-between text-xs text-gray-600 dark:text-gray-400"},Ua={class:"text-red-600 dark:text-red-400"},Ka={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},Ma={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6 lg:grid-cols-4"},Fa={class:"stat-card"},Oa={class:"flex items-center justify-between"},La={class:"mr-8 flex-1"},qa={class:"mb-2 flex flex-wrap items-baseline gap-2"},za={class:"text-xl font-bold text-blue-600 sm:text-2xl md:text-3xl"},Ea={class:"text-sm font-medium text-green-600"},Ga={class:"text-xs text-gray-500 dark:text-gray-400"},ja={class:"flex flex-wrap items-center justify-between gap-x-4"},Na={class:"font-medium"},Ha={class:"font-medium"},Va={key:0,class:"text-purple-600"},Ya={class:"font-medium"},Wa={key:1,class:"text-purple-600"},Ja={class:"font-medium"},Qa={class:"stat-card"},Xa={class:"flex items-center justify-between"},Za={class:"mr-8 flex-1"},ts={class:"mb-2 flex flex-wrap items-baseline gap-2"},es={class:"text-xl font-bold text-emerald-600 sm:text-2xl md:text-3xl"},as={class:"text-sm font-medium text-green-600"},ss={class:"text-xs text-gray-500 dark:text-gray-400"},os={class:"flex flex-wrap items-center justify-between gap-x-4"},rs={class:"font-medium"},ns={class:"font-medium"},ls={key:0,class:"text-purple-600"},is={class:"font-medium"},ds={key:1,class:"text-purple-600"},cs={class:"font-medium"},us={class:"stat-card"},ps={class:"flex items-center justify-between"},gs={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},ms={class:"text-xs text-gray-400"},ys={class:"text-2xl font-bold text-orange-600 sm:text-3xl"},xs={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},fs={key:0,class:"text-yellow-600"},vs={class:"stat-card"},bs={class:"flex items-center justify-between"},hs={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},ks={class:"text-xs text-gray-400"},_s={class:"text-2xl font-bold text-rose-600 sm:text-3xl"},ws={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Cs={key:0,class:"text-yellow-600"},Ts={class:"mb-8"},Ds={class:"mb-4 flex flex-col gap-4 sm:mb-6"},Ss={class:"flex flex-col gap-2 lg:flex-row lg:items-center lg:justify-end"},As={class:"flex flex-shrink-0 gap-1 overflow-x-auto rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},$s=["onClick"],Rs={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},Ps={class:"flex items-center gap-2"},Is={key:0,class:"text-xs text-orange-600"},Bs={class:"flex items-center gap-2"},Us={class:"flex items-center rounded-lg bg-gray-100 px-3 py-1 dark:bg-gray-700"},Ks={class:"relative inline-flex cursor-pointer items-center"},Ms={class:"ml-2.5 flex select-none items-center gap-1 text-sm font-medium text-gray-600 dark:text-gray-300"},Fs=["disabled"],Os={class:"hidden sm:inline"},Ls={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},qs={class:"card p-4 sm:p-6"},zs={class:"relative",style:{height:"250px"}},Es={class:"card p-4 sm:p-6"},Gs={key:0,class:"py-8 text-center"},js={key:1,class:"max-h-[250px] overflow-auto sm:max-h-[300px]"},Ns={class:"min-w-full"},Hs={class:"divide-y divide-gray-200 dark:divide-gray-600"},Vs={class:"px-2 py-2 text-xs text-gray-900 dark:text-gray-100 sm:px-4 sm:text-sm"},Ys=["title"],Ws={class:"hidden px-2 py-2 text-right text-xs text-gray-600 dark:text-gray-400 sm:table-cell sm:px-4 sm:text-sm"},Js={class:"px-2 py-2 text-right text-xs text-gray-600 dark:text-gray-400 sm:px-4 sm:text-sm"},Qs={class:"px-2 py-2 text-right text-xs font-medium text-green-600 sm:px-4 sm:text-sm"},Xs={class:"hidden px-2 py-2 text-right text-xs font-medium sm:table-cell sm:px-4 sm:text-sm"},Zs={class:"inline-flex items-center rounded-full bg-blue-100 px-2 py-1 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"},to={class:"mb-4 sm:mb-6 md:mb-8"},eo={class:"card p-4 sm:p-6"},ao={class:"sm:h-[300px]",style:{height:"250px"}},so={class:"mb-4 sm:mb-6 md:mb-8"},oo={class:"card p-4 sm:p-6"},ro={class:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},no={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},lo={class:"mb-4 text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},io={key:0},co={key:1},uo={class:"sm:h-[400px]",style:{height:"350px"}},po={class:"mt-8 border-t border-gray-100 pt-6 dark:border-gray-700"},go={class:"overflow-x-auto"},mo={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},yo={class:"bg-gray-50 dark:bg-gray-800"},xo={class:"flex items-center justify-end gap-1"},fo={key:1,class:"fas fa-sort ml-1 text-gray-400"},vo={class:"flex items-center justify-end gap-1"},bo={key:1,class:"fas fa-sort ml-1 text-gray-400"},ho={class:"flex items-center justify-end gap-1"},ko={key:1,class:"fas fa-sort ml-1 text-gray-400"},_o={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},wo={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400"},Co={class:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900 dark:text-gray-100"},To=["onClick"],Do={class:"text-xs text-gray-400"},So={class:"whitespace-nowrap px-6 py-4 text-right text-sm text-gray-500 dark:text-gray-400"},Ao={class:"whitespace-nowrap px-6 py-4 text-right text-sm text-gray-500 dark:text-gray-400"},$o={class:"whitespace-nowrap px-6 py-4 text-right text-sm text-green-600 dark:text-green-400"},Ro={class:"whitespace-nowrap px-6 py-4 text-center text-sm font-medium"},Po=["onClick"],Io={key:0},Bo={key:0,class:"mt-4 flex justify-end"},Uo={class:"mb-4 sm:mb-6 md:mb-8"},Ko={class:"card p-4 sm:p-6"},Mo={class:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Fo={class:"flex flex-col gap-1 sm:flex-row sm:items-center sm:gap-3"},Oo={class:"text-xs text-gray-500 dark:text-gray-400 sm:text-sm"},Lo={class:"flex flex-wrap items-center gap-2"},qo={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},zo=["onClick"],Eo={class:"mb-4 flex flex-wrap items-center gap-2 text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},Go={key:0},jo={key:0,class:"py-12 text-center text-sm text-gray-500 dark:text-gray-400"},No={key:1,class:"sm:h-[350px]",style:{height:"300px"}},Ho={key:0,class:"py-12 text-center"},Vo={key:1},Yo={class:"mb-6 grid grid-cols-3 gap-4 rounded-lg bg-gray-50 p-4 dark:bg-gray-800"},Wo={class:"text-center"},Jo={class:"text-xl font-bold text-gray-900 dark:text-gray-100"},Qo={class:"text-center"},Xo={class:"text-xl font-bold text-blue-600 dark:text-blue-400"},Zo={class:"text-center"},tr={class:"text-xl font-bold text-green-600 dark:text-green-400"},er={class:"mb-6"},ar={class:"h-[300px] w-full"},sr={key:0,class:"mt-6"},or={class:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700"},rr={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},nr={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},lr={class:"whitespace-nowrap px-4 py-3 text-sm font-medium text-gray-900 dark:text-gray-100"},ir={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},dr={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},cr={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},ur={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},pr={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},gr={class:"whitespace-nowrap px-4 py-3 text-right text-sm font-medium text-blue-600 dark:text-blue-400"},mr={class:"whitespace-nowrap px-4 py-3 text-right text-sm font-medium text-green-600 dark:text-green-400"},yr={key:1,class:"mt-6"},xr={class:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700"},fr={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},vr={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},br={class:"whitespace-nowrap px-6 py-3 text-sm font-medium text-gray-900 dark:text-gray-100"},hr={class:"whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},kr={class:"whitespace-nowrap px-6 py-3 text-right text-sm font-medium text-blue-600 dark:text-blue-400"},_r={class:"whitespace-nowrap px-6 py-3 text-right text-sm font-medium text-green-600 dark:text-green-400"},wr={__name:"DashboardView",setup(Mt){const dt=Ae(),Ft=Se(),{isDarkMode:ct}=ce(Ft),{dashboardData:n,costsData:ht,dashboardModelStats:X,trendData:kt,apiKeysTrendData:L,accountUsageTrendData:F,accountUsageGroup:_t,formattedUptime:ut,dateFilter:q,trendGranularity:Z,apiKeysTrendMetric:N,defaultTime:Ot}=ce(dt),{loadDashboardData:wt,loadApiKeysTrend:Ht,setDateFilterPreset:l,onCustomDateRangeChange:O,setTrendGranularity:Ct,refreshChartsData:pt,setAccountUsageGroup:Vt,disabledDate:Yt}=dt,D=S(null),tt=S(null),H=S(null),Tt=S(null);let et=null,at=null,st=null,V=null;const ot=[{value:"claude",label:"Claude"},{value:"openai",label:"OpenAI"},{value:"gemini",label:"Gemini"},{value:"droid",label:"Droid"}],Dt=S(!1),rt=S({totalBalance:0,totalCost:0,lowBalanceCount:0,platforms:{}}),j=S(!1),Lt=S(null),St=o=>({claude:"Claude","claude-console":"Claude Console",gemini:"Gemini","gemini-api":"Gemini API",openai:"OpenAI","openai-responses":"OpenAI Responses",azure_openai:"Azure OpenAI",bedrock:"Bedrock",droid:"Droid",ccr:"CCR"})[o]||o,At=Kt(()=>{var m;const o=[],e=((m=rt.value)==null?void 0:m.platforms)||{};return Object.entries(e).forEach(([$,h])=>{(Array.isArray(h==null?void 0:h.accounts)?h.accounts:[]).forEach(B=>{var R,_;const C=B==null?void 0:B.data;if(!C)return;const P=(R=C.balance)==null?void 0:R.amount,M=(_=C.quota)==null?void 0:_.percentage,s=typeof P=="number"&&P<10,y=typeof M=="number"&&M>90;(s||y)&&o.push({...C,name:(B==null?void 0:B.name)||C.accountId,platform:C.platform||$})})}),o}),p=o=>{const e=Number(o);return Number.isFinite(e)?e>=1?`$${e.toFixed(2)}`:e>=.01?`$${e.toFixed(3)}`:`$${e.toFixed(6)}`:"$0.00"},k=o=>{if(!o)return"æœªçŸ¥";const e=new Date(o);return Number.isNaN(e.getTime())?"æœªçŸ¥":e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})},v=async()=>{j.value=!0;try{const o=await Q.get("/admin/accounts/balance/summary");o!=null&&o.success&&(rt.value=o.data||{totalBalance:0,totalCost:0,lowBalanceCount:0,platforms:{}},Lt.value=new Date().toISOString())}catch(o){console.debug("åŠ è½½ä½™é¢æ±‡æ€»å¤±è´¥:",o),Nt("åŠ è½½ä½™é¢æ±‡æ€»å¤±è´¥","error")}finally{j.value=!1}},d=S(!1),w=S(30),i=S(null),c=S(0),u=S(null),b=S(!1),g=Kt(()=>({text:ct.value?"#e5e7eb":"#374151",grid:ct.value?"rgba(75, 85, 99, 0.3)":"rgba(0, 0, 0, 0.1)",legend:ct.value?"#e5e7eb":"#374151"}));function T(o){if(o==null||o===void 0)return"0";const e=Number(o);return Number.isFinite(e)?e>=1e6?(e/1e6).toFixed(2)+"M":e>=1e3?(e/1e3).toFixed(2)+"K":e.toString():"0"}function z(o){if(o==null||o===void 0)return"0";const e=Number(o);return Number.isFinite(e)?e>=1e6?(e/1e6).toFixed(2)+"M":e>=1e3?(e/1e3).toFixed(1)+"k":e.toLocaleString():"0"}function gt(o){return Number.isFinite(o)?o>=1?`$${o.toFixed(2)}`:o>=.01?`$${o.toFixed(3)}`:`$${o.toFixed(6)}`:"$0.000000"}function qt(o,e){if(!e||e.length===0)return 0;const m=e.reduce(($,h)=>$+h.allTokens,0);return m===0?0:(o/m*100).toFixed(1)}function $t(){if(!D.value)return;et&&et.destroy();const o=X.value||[],e={labels:o.map(m=>m.model),datasets:[{data:o.map(m=>m.allTokens),backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],borderWidth:0}]};et=new Ut(D.value,{type:"doughnut",data:e,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,usePointStyle:!0,font:{size:12},color:g.value.legend}},tooltip:{callbacks:{label:function(m){const $=m.label||"",h=T(m.parsed),A=qt(m.parsed,o);return`${$}: ${h} (${A}%)`}}}}}})}function Rt(){var s;if(!tt.value)return;at&&at.destroy();const o=kt.value||[],e=o.map(y=>y.inputTokens||0),m=o.map(y=>y.outputTokens||0),$=o.map(y=>y.cacheCreateTokens||0),h=o.map(y=>y.cacheReadTokens||0),A=o.map(y=>y.requests||0),B=o.map(y=>y.cost||0),C=(s=o[0])!=null&&s.date?"date":"hour",M={labels:o.map(y=>{if(y.label)return y.label;if(C==="hour"){const _=new Date(y.hour),K=String(_.getMonth()+1).padStart(2,"0"),W=String(_.getDate()).padStart(2,"0"),E=String(_.getHours()).padStart(2,"0");return`${K}/${W} ${E}:00`}const R=y.date;if(R&&R.includes("-")){const _=R.split("-");if(_.length>=3)return`${_[1]}/${_[2]}`}return y.date}),datasets:[{label:"è¾“å…¥Token",data:e,borderColor:"rgb(102, 126, 234)",backgroundColor:"rgba(102, 126, 234, 0.1)",tension:.3},{label:"è¾“å‡ºToken",data:m,borderColor:"rgb(240, 147, 251)",backgroundColor:"rgba(240, 147, 251, 0.1)",tension:.3},{label:"ç¼“å­˜åˆ›å»ºToken",data:$,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3},{label:"ç¼“å­˜è¯»å–Token",data:h,borderColor:"rgb(147, 51, 234)",backgroundColor:"rgba(147, 51, 234, 0.1)",tension:.3},{label:"è´¹ç”¨ (USD)",data:B,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.3,yAxisID:"y2"},{label:"è¯·æ±‚æ•°",data:A,borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.3,yAxisID:"y1"}]};at=new Ut(tt.value,{type:"line",data:M,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{title:{display:!0,text:"Tokenä½¿ç”¨è¶‹åŠ¿",font:{size:16,weight:"bold"},color:g.value.text},legend:{position:"top",labels:{color:g.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:function(y,R){const _=y.dataset.label||"",K=R.dataset.label||"";return _==="è´¹ç”¨ (USD)"||K==="è´¹ç”¨ (USD)"?_==="è´¹ç”¨ (USD)"?-1:1:_==="è¯·æ±‚æ•°"||K==="è¯·æ±‚æ•°"?_==="è¯·æ±‚æ•°"?1:-1:R.parsed.y-y.parsed.y},callbacks:{label:function(y){const R=y.dataset.label||"";let _=y.parsed.y;return R==="è´¹ç”¨ (USD)"?_<.01?R+": $"+_.toFixed(6):R+": $"+_.toFixed(4):R==="è¯·æ±‚æ•°"?R+": "+_.toLocaleString()+" æ¬¡":_>=1e6?R+": "+(_/1e6).toFixed(2)+"M tokens":_>=1e3?R+": "+(_/1e3).toFixed(2)+"K tokens":R+": "+_.toLocaleString()+" tokens"}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:Z==="hour"?"æ—¶é—´":"æ—¥æœŸ",color:g.value.text},ticks:{color:g.value.text},grid:{color:g.value.grid}},y:{type:"linear",display:!0,position:"left",min:0,title:{display:!0,text:"Tokenæ•°é‡",color:g.value.text},ticks:{callback:function(y){return T(y)},color:g.value.text},grid:{color:g.value.grid}},y1:{type:"linear",display:!0,position:"right",min:0,title:{display:!0,text:"è¯·æ±‚æ•°",color:g.value.text},grid:{drawOnChartArea:!1},ticks:{callback:function(y){return y.toLocaleString()},color:g.value.text}},y2:{type:"linear",display:!1,position:"right",min:0}}}})}const Pt=S(!1),Y=S(null),se=S([]),mt=S([]),It=S([]),zt=S(!1),Wt=S(null);let Jt=null;const yt=S(1),xt=S(5),ft=S("requests"),nt=S("desc"),ue=Kt(()=>{const o=[...L.value.apiKeyStats||[]],e=ft.value,m=nt.value;return o.sort(($,h)=>{let A,B;switch(e){case"requests":A=$.requests||0,B=h.requests||0;break;case"tokens":A=$.tokens||0,B=h.tokens||0;break;case"cost":A=$.cost||0,B=h.cost||0;break;default:return 0}return m==="asc"?A-B:B-A}),o}),oe=Kt(()=>{const o=ue.value,e=(yt.value-1)*xt.value,m=e+xt.value;return o.slice(e,m)}),Qt=o=>{ft.value===o?nt.value=nt.value==="asc"?"desc":"asc":(ft.value=o,nt.value="desc"),yt.value=1},re=o=>{yt.value=o};function Et(){if(!H.value)return;st&&st.destroy();const o=(L.value.apiKeyStats||[]).slice(0,50),e=N.value,m=o.map(C=>C.name||C.id),$=o.map(C=>e==="tokens"?C.tokens:C.requests),h=o.map((C,P)=>{const M=["rgba(59, 130, 246, 0.7)","rgba(16, 185, 129, 0.7)","rgba(245, 158, 11, 0.7)","rgba(239, 68, 68, 0.7)","rgba(139, 92, 246, 0.7)","rgba(236, 72, 153, 0.7)","rgba(20, 184, 166, 0.7)","rgba(249, 115, 22, 0.7)","rgba(99, 102, 241, 0.7)","rgba(132, 204, 22, 0.7)"];return M[P%M.length]}),A=h.map(C=>C.replace("0.7","1")),B={labels:m,datasets:[{label:e==="tokens"?"Token æ•°é‡":"è¯·æ±‚æ¬¡æ•°",data:$,backgroundColor:h,borderColor:A,borderWidth:1,borderRadius:4}]};st=new Ut(H.value,{type:"bar",data:B,options:{indexAxis:"x",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(C){const P=C.parsed.y,M=C.dataIndex,s=o[M];let y="";return e==="tokens"?y=`${T(P)} tokens`:y=`${P.toLocaleString()} æ¬¡`,`${y} (${s.formattedCost})`}}}},scales:{x:{grid:{display:!1},ticks:{color:g.value.text,maxRotation:45,minRotation:45,autoSkip:!1}},y:{grid:{color:g.value.grid},ticks:{color:g.value.text,callback:C=>T(C)}}},onClick:(C,P)=>{if(P.length>0){const M=P[0].index,s=o[M];Xt(s)}}}})}const Xt=async o=>{Y.value=o,Pt.value=!0,zt.value=!0;try{const e=L.value.data||[];se.value=e.map(m=>{var h;const $=((h=m.apiKeys)==null?void 0:h[o.id])||{requests:0,tokens:0,cost:0};return{date:m.label||m.date||m.hour,...$}});try{let m="monthly",$=`period=${m}`;q.value.type==="custom"&&q.value.customRange?(m="custom",$=`period=custom&startDate=${encodeURIComponent(q.value.customRange[0])}&endDate=${encodeURIComponent(q.value.customRange[1])}`):q.value.type==="preset"&&q.value.preset==="today"&&(m="daily",$="period=daily");const h=await Q.get(`/admin/api-keys/${o.id}/model-stats?${$}`);h.success&&h.data?mt.value=h.data:mt.value=[]}catch(m){console.error("åŠ è½½æ¨¡å‹ç»Ÿè®¡å¤±è´¥:",m),mt.value=[]}try{const m=new Map,$=L.value.data||[];console.log("Loading daily usage for API Key:",o.id),console.log("Full trend data points:",$.length),$.forEach(h=>{var B;const A=(B=h.apiKeys)==null?void 0:B[o.id];if(A&&A.requests>0){let C=h.date||h.label||h.hour;C&&C.includes("T")?C=C.split("T")[0]:C&&C.includes(" ")&&(C=C.split(" ")[0]),m.has(C)||m.set(C,{date:C,requests:0,tokens:0,inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,cost:0});const P=m.get(C);P.requests+=A.requests||0,P.inputTokens+=A.inputTokens||0,P.outputTokens+=A.outputTokens||0,P.cacheCreateTokens+=A.cacheCreateTokens||0,P.cacheReadTokens+=A.cacheReadTokens||0,P.tokens+=A.tokens||0,P.cost+=A.cost||0}}),console.log("Daily usage map:",Array.from(m.entries())),It.value=Array.from(m.values()).map(h=>{const A=h.tokens>0?h.tokens:h.inputTokens+h.outputTokens+h.cacheCreateTokens+h.cacheReadTokens;return console.log(`Date: ${h.date}, tokens: ${h.tokens}, calculated: ${h.inputTokens+h.outputTokens+h.cacheCreateTokens+h.cacheReadTokens}, final: ${A}`),{...h,allTokens:A,formatted:{totalCost:h.cost>=.01?`$${h.cost.toFixed(2)}`:"<$0.01"}}}).sort((h,A)=>A.date.localeCompare(h.date))}catch(m){console.error("åŠ è½½æŒ‰å¤©ç”¨é‡ç»Ÿè®¡å¤±è´¥:",m),It.value=[]}zt.value=!1,await J(),setTimeout(()=>{pe()},100)}catch(e){console.error("åˆ›å»ºå›¾è¡¨å¤±è´¥:",e),zt.value=!1}};function pe(){if(!Wt.value){console.warn("Canvas ref not available for API Key detail chart");return}try{Jt&&Jt.destroy();const o=se.value;if(!o||o.length===0){console.warn("No trend data available for chart");return}const e=o.map(m=>m.date&&m.date.includes("T")?`${new Date(m.date).getHours()}:00`:m.date);console.log("Creating API Key detail chart with",o.length,"data points"),Jt=new Ut(Wt.value,{type:"line",data:{labels:e,datasets:[{label:"Token æ¶ˆè€—",data:o.map(m=>m.tokens),borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",yAxisID:"y",tension:.3,fill:!0},{label:"è¯·æ±‚æ¬¡æ•°",data:o.map(m=>m.requests),borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.1)",yAxisID:"y1",tension:.3,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top",labels:{color:g.value.legend}},tooltip:{callbacks:{label:function(m){const $=m.dataset.label||"",h=m.parsed.y;return m.dataset.yAxisID==="y"?`${$}: ${z(h)}`:`${$}: ${h.toLocaleString()}`}}}},scales:{x:{ticks:{color:g.value.text},grid:{color:g.value.grid}},y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Tokens",color:g.value.text},ticks:{color:g.value.text,callback:m=>z(m)},grid:{color:g.value.grid}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"è¯·æ±‚æ•°",color:g.value.text},ticks:{color:g.value.text},grid:{display:!1}}}}})}catch(o){console.error("Failed to create API Key detail chart:",o)}}async function ne(){await Ht(N.value),await J(),Et()}function Gt(){var C,P,M;if(!Tt.value)return;V&&V.destroy();const o=((C=F.value)==null?void 0:C.data)||[],e=((P=F.value)==null?void 0:P.topAccounts)||[],m=["#2563EB","#059669","#D97706","#DC2626","#7C3AED","#F472B6","#0EA5E9","#F97316","#6366F1","#22C55E"],$=e.map((s,y)=>{var K,W;const R=o.map(E=>!E.accounts||!E.accounts[s]?0:E.accounts[s].cost||0);return{label:((W=(K=o.find(E=>E.accounts&&E.accounts[s]))==null?void 0:K.accounts[s])==null?void 0:W.name)||`è´¦å· ${String(s).slice(0,6)}`,data:R,borderColor:m[y%m.length],backgroundColor:m[y%m.length]+"20",tension:.4,fill:!1}}),h=(M=o[0])!=null&&M.date?"date":"hour",A={labels:o.map(s=>{if(s.label)return s.label;if(h==="hour"){const y=new Date(s.hour),R=String(y.getMonth()+1).padStart(2,"0"),_=String(y.getDate()).padStart(2,"0"),K=String(y.getHours()).padStart(2,"0");return`${R}/${_} ${K}:00`}if(s.date&&s.date.includes("-")){const y=s.date.split("-");if(y.length>=3)return`${y[1]}/${y[2]}`}return s.date}),datasets:$},B=e;V=new Ut(Tt.value,{type:"line",data:A,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,font:{size:12},color:g.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:(s,y)=>y.parsed.y-s.parsed.y,callbacks:{label:function(s){var de;const y=s.dataset.label||"",R=s.parsed.y||0,_=s.dataIndex,K=s.datasetIndex,W=B[K],E=F.value.data[_],vt=(de=E==null?void 0:E.accounts)==null?void 0:de[W],te=s.chart.data.datasets.map((Bt,ee)=>({value:Bt.data[_]||0,index:ee})).sort((Bt,ee)=>ee.value-Bt.value).findIndex(Bt=>Bt.index===K)+1;let jt="";te===1?jt="ğŸ¥‡ ":te===2?jt="ğŸ¥ˆ ":te===3&&(jt="ğŸ¥‰ ");const me=(vt==null?void 0:vt.formattedCost)||gt(R),ye=(vt==null?void 0:vt.requests)||0;return`${jt}${y}: ${me} / ${ye.toLocaleString()} æ¬¡`}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:Z.value==="hour"?"æ—¶é—´":"æ—¥æœŸ",color:g.value.text},ticks:{color:g.value.text},grid:{color:g.value.grid}},y:{beginAtZero:!0,min:0,title:{display:!0,text:"æ¶ˆè€—é‡‘é¢ (USD)",color:g.value.text},ticks:{callback:s=>gt(Number(s)),color:g.value.text},grid:{color:g.value.grid}}}}})}async function ge(o){if(!(_t.value===o||Dt.value)){Dt.value=!0;try{await Vt(o),await J(),Gt()}finally{Dt.value=!1}}}bt(X,()=>{J(()=>$t())}),bt(kt,()=>{J(()=>Rt())}),bt(L,()=>{J(()=>Et())}),bt(F,()=>{J(()=>Gt())});async function Zt(){if(!b.value){b.value=!0;try{await Promise.all([wt(),pt(),v()])}finally{b.value=!1}}}function le(){d.value&&(c.value=w.value,u.value&&clearInterval(u.value),i.value&&clearTimeout(i.value),u.value=setInterval(()=>{c.value--,c.value<=0&&clearInterval(u.value)},1e3),i.value=setTimeout(async()=>{await Zt(),d.value&&le()},w.value*1e3))}function ie(){u.value&&(clearInterval(u.value),u.value=null),i.value&&(clearTimeout(i.value),i.value=null),c.value=0}return bt(d,o=>{o?le():ie()}),bt(ct,()=>{J(()=>{$t(),Rt(),Et(),Gt()})}),he(async()=>{await Zt(),await J(),$t(),Rt(),Et(),Gt()}),ke(()=>{ie(),et&&et.destroy(),at&&at.destroy(),st&&st.destroy(),V&&V.destroy()}),(o,e)=>{var A,B,C,P,M;const m=xe,$=fe,h=ve;return f(),x("div",null,[t("div",$e,[t("div",Re,[t("div",Pe,[t("div",null,[e[14]||(e[14]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," æ€»API Keys ",-1)),t("p",Ie,r(a(n).totalApiKeys),1),t("p",Be," æ´»è·ƒ: "+r(a(n).activeApiKeys||0),1)]),e[15]||(e[15]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-blue-500 to-blue-600"},[t("i",{class:"fas fa-key"})],-1))])]),t("div",Ue,[t("div",Ke,[t("div",Me,[e[23]||(e[23]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," æœåŠ¡è´¦æˆ· ",-1)),t("div",Fe,[t("p",Oe,r(a(n).totalAccounts),1),a(n).accountsByPlatform?(f(),x("div",Le,[a(n).accountsByPlatform.claude&&a(n).accountsByPlatform.claude.total>0?(f(),x("div",{key:0,class:"inline-flex items-center gap-0.5",title:`Claude: ${a(n).accountsByPlatform.claude.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.claude.normal})`},[e[16]||(e[16]=t("i",{class:"fas fa-brain text-xs text-indigo-600"},null,-1)),t("span",ze,r(a(n).accountsByPlatform.claude.total),1)],8,qe)):I("",!0),a(n).accountsByPlatform["claude-console"]&&a(n).accountsByPlatform["claude-console"].total>0?(f(),x("div",{key:1,class:"inline-flex items-center gap-0.5",title:`Console: ${a(n).accountsByPlatform["claude-console"].total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform["claude-console"].normal})`},[e[17]||(e[17]=t("i",{class:"fas fa-terminal text-xs text-purple-600"},null,-1)),t("span",Ge,r(a(n).accountsByPlatform["claude-console"].total),1)],8,Ee)):I("",!0),a(n).accountsByPlatform.gemini&&a(n).accountsByPlatform.gemini.total>0?(f(),x("div",{key:2,class:"inline-flex items-center gap-0.5",title:`Gemini: ${a(n).accountsByPlatform.gemini.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.gemini.normal})`},[e[18]||(e[18]=t("i",{class:"fas fa-robot text-xs text-yellow-600"},null,-1)),t("span",Ne,r(a(n).accountsByPlatform.gemini.total),1)],8,je)):I("",!0),a(n).accountsByPlatform.bedrock&&a(n).accountsByPlatform.bedrock.total>0?(f(),x("div",{key:3,class:"inline-flex items-center gap-0.5",title:`Bedrock: ${a(n).accountsByPlatform.bedrock.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.bedrock.normal})`},[e[19]||(e[19]=t("i",{class:"fab fa-aws text-xs text-orange-600"},null,-1)),t("span",Ve,r(a(n).accountsByPlatform.bedrock.total),1)],8,He)):I("",!0),a(n).accountsByPlatform.openai&&a(n).accountsByPlatform.openai.total>0?(f(),x("div",{key:4,class:"inline-flex items-center gap-0.5",title:`OpenAI: ${a(n).accountsByPlatform.openai.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.openai.normal})`},[e[20]||(e[20]=t("i",{class:"fas fa-openai text-xs text-gray-100"},null,-1)),t("span",We,r(a(n).accountsByPlatform.openai.total),1)],8,Ye)):I("",!0),a(n).accountsByPlatform.azure_openai&&a(n).accountsByPlatform.azure_openai.total>0?(f(),x("div",{key:5,class:"inline-flex items-center gap-0.5",title:`Azure OpenAI: ${a(n).accountsByPlatform.azure_openai.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.azure_openai.normal})`},[e[21]||(e[21]=t("i",{class:"fab fa-microsoft text-xs text-blue-600"},null,-1)),t("span",Qe,r(a(n).accountsByPlatform.azure_openai.total),1)],8,Je)):I("",!0),a(n).accountsByPlatform["openai-responses"]&&a(n).accountsByPlatform["openai-responses"].total>0?(f(),x("div",{key:6,class:"inline-flex items-center gap-0.5",title:`OpenAI Responses: ${a(n).accountsByPlatform["openai-responses"].total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform["openai-responses"].normal})`},[e[22]||(e[22]=t("i",{class:"fas fa-server text-xs text-cyan-600"},null,-1)),t("span",Ze,r(a(n).accountsByPlatform["openai-responses"].total),1)],8,Xe)):I("",!0)])):I("",!0)]),t("p",ta,[U(" æ­£å¸¸: "+r(a(n).normalAccounts||0)+" ",1),a(n).abnormalAccounts>0?(f(),x("span",ea," | å¼‚å¸¸: "+r(a(n).abnormalAccounts),1)):I("",!0),a(n).pausedAccounts>0?(f(),x("span",aa," | åœæ­¢è°ƒåº¦: "+r(a(n).pausedAccounts),1)):I("",!0),a(n).rateLimitedAccounts>0?(f(),x("span",sa," | é™æµ: "+r(a(n).rateLimitedAccounts),1)):I("",!0)])]),e[24]||(e[24]=t("div",{class:"stat-icon ml-2 flex-shrink-0 bg-gradient-to-br from-green-500 to-green-600"},[t("i",{class:"fas fa-user-circle"})],-1))])]),t("div",oa,[t("div",ra,[t("div",null,[e[25]||(e[25]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," ä»Šæ—¥è¯·æ±‚ ",-1)),t("p",na,r(a(n).todayRequests),1),t("p",la," æ€»è¯·æ±‚: "+r(T(a(n).totalRequests||0)),1)]),e[26]||(e[26]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-purple-500 to-purple-600"},[t("i",{class:"fas fa-chart-line"})],-1))])]),t("div",ia,[t("div",da,[t("div",null,[e[27]||(e[27]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," ç³»ç»ŸçŠ¶æ€ ",-1)),t("p",ca,r(a(n).systemStatus),1),t("p",ua," è¿è¡Œæ—¶é—´: "+r(a(ut)),1)]),e[28]||(e[28]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-yellow-500 to-orange-500"},[t("i",{class:"fas fa-heartbeat"})],-1))])])]),t("div",pa,[t("div",ga,[t("div",ma,[t("div",null,[e[29]||(e[29]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," è´¦æˆ·ä½™é¢/é…é¢ ",-1)),t("p",ya,r(p(rt.value.totalBalance||0)),1),t("p",xa," ä½ä½™é¢: "+r(rt.value.lowBalanceCount||0)+" | æ€»æˆæœ¬: "+r(p(rt.value.totalCost||0)),1)]),e[30]||(e[30]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-emerald-500 to-green-600"},[t("i",{class:"fas fa-wallet"})],-1))]),t("div",fa,[t("p",va," æ›´æ–°æ—¶é—´: "+r(k(Lt.value)),1),t("button",{class:"flex items-center gap-2 rounded-lg border border-gray-200 bg-white px-3 py-1.5 text-xs font-medium text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:border-gray-500",disabled:j.value,onClick:v},[t("i",{class:G(["fas",j.value?"fa-spinner fa-spin":"fa-sync-alt"])},null,2),e[31]||(e[31]=U(" åˆ·æ–° ",-1))],8,ba)])]),t("div",ha,[t("div",ka,[e[32]||(e[32]=t("h3",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},"ä½ä½™é¢è´¦æˆ·",-1)),t("span",_a,r(At.value.length)+" ä¸ª ",1)]),j.value?(f(),x("div",wa," æ­£åœ¨åŠ è½½... ")):At.value.length===0?(f(),x("div",Ca," å…¨éƒ¨æ­£å¸¸ ")):(f(),x("div",Ta,[(f(!0),x(lt,null,it(At.value,s=>{var y;return f(),x("div",{key:s.accountId,class:"rounded-lg border border-red-200 bg-red-50 p-3 dark:border-red-900/60 dark:bg-red-900/20"},[t("div",Da,[t("div",Sa,r(s.name||s.accountId),1),t("span",Aa,r(St(s.platform)),1)]),t("div",$a,[s.balance?(f(),x("span",Ra,"ä½™é¢: "+r(s.balance.formattedAmount),1)):(f(),x("span",Pa,"ä»Šæ—¥æˆæœ¬: "+r(p(((y=s.statistics)==null?void 0:y.dailyCost)||0)),1))]),s.quota&&typeof s.quota.percentage=="number"?(f(),x("div",Ia,[t("div",Ba,[e[33]||(e[33]=t("span",null,"é…é¢ä½¿ç”¨",-1)),t("span",Ua,r(s.quota.percentage.toFixed(1))+"% ",1)]),t("div",Ka,[t("div",{class:"h-2 rounded-full bg-red-500",style:Te({width:`${Math.min(100,s.quota.percentage)}%`})},null,4)])])):I("",!0)])}),128))]))])]),t("div",Ma,[t("div",Fa,[t("div",Oa,[t("div",La,[e[38]||(e[38]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," ä»Šæ—¥Token ",-1)),t("div",qa,[t("p",za,r(T((a(n).todayInputTokens||0)+(a(n).todayOutputTokens||0)+(a(n).todayCacheCreateTokens||0)+(a(n).todayCacheReadTokens||0))),1),t("span",Ea,"/ "+r(a(ht).todayCosts.formatted.totalCost),1)]),t("div",Ga,[t("div",ja,[t("span",null,[e[34]||(e[34]=U("è¾“å…¥: ",-1)),t("span",Na,r(T(a(n).todayInputTokens||0)),1)]),t("span",null,[e[35]||(e[35]=U("è¾“å‡º: ",-1)),t("span",Ha,r(T(a(n).todayOutputTokens||0)),1)]),(a(n).todayCacheCreateTokens||0)>0?(f(),x("span",Va,[e[36]||(e[36]=U("ç¼“å­˜åˆ›å»º: ",-1)),t("span",Ya,r(T(a(n).todayCacheCreateTokens||0)),1)])):I("",!0),(a(n).todayCacheReadTokens||0)>0?(f(),x("span",Wa,[e[37]||(e[37]=U("ç¼“å­˜è¯»å–: ",-1)),t("span",Ja,r(T(a(n).todayCacheReadTokens||0)),1)])):I("",!0)])])]),e[39]||(e[39]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-indigo-500 to-indigo-600"},[t("i",{class:"fas fa-coins"})],-1))])]),t("div",Qa,[t("div",Xa,[t("div",Za,[e[44]||(e[44]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," æ€»Tokenæ¶ˆè€— ",-1)),t("div",ts,[t("p",es,r(T((a(n).totalInputTokens||0)+(a(n).totalOutputTokens||0)+(a(n).totalCacheCreateTokens||0)+(a(n).totalCacheReadTokens||0))),1),t("span",as,"/ "+r(a(ht).totalCosts.formatted.totalCost),1)]),t("div",ss,[t("div",os,[t("span",null,[e[40]||(e[40]=U("è¾“å…¥: ",-1)),t("span",rs,r(T(a(n).totalInputTokens||0)),1)]),t("span",null,[e[41]||(e[41]=U("è¾“å‡º: ",-1)),t("span",ns,r(T(a(n).totalOutputTokens||0)),1)]),(a(n).totalCacheCreateTokens||0)>0?(f(),x("span",ls,[e[42]||(e[42]=U("ç¼“å­˜åˆ›å»º: ",-1)),t("span",is,r(T(a(n).totalCacheCreateTokens||0)),1)])):I("",!0),(a(n).totalCacheReadTokens||0)>0?(f(),x("span",ds,[e[43]||(e[43]=U("ç¼“å­˜è¯»å–: ",-1)),t("span",cs,r(T(a(n).totalCacheReadTokens||0)),1)])):I("",!0)])])]),e[45]||(e[45]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-emerald-500 to-emerald-600"},[t("i",{class:"fas fa-database"})],-1))])]),t("div",us,[t("div",ps,[t("div",null,[t("p",gs,[e[46]||(e[46]=U(" å®æ—¶RPM ",-1)),t("span",ms,"("+r(a(n).metricsWindow)+"åˆ†é’Ÿ)",1)]),t("p",ys,r(a(n).realtimeRPM||0),1),t("p",xs,[e[48]||(e[48]=U(" æ¯åˆ†é’Ÿè¯·æ±‚æ•° ",-1)),a(n).isHistoricalMetrics?(f(),x("span",fs,e[47]||(e[47]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),U(" å†å²æ•°æ® ",-1)]))):I("",!0)])]),e[49]||(e[49]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-orange-500 to-orange-600"},[t("i",{class:"fas fa-tachometer-alt"})],-1))])]),t("div",vs,[t("div",bs,[t("div",null,[t("p",hs,[e[50]||(e[50]=U(" å®æ—¶TPM ",-1)),t("span",ks,"("+r(a(n).metricsWindow)+"åˆ†é’Ÿ)",1)]),t("p",_s,r(T(a(n).realtimeTPM||0)),1),t("p",ws,[e[52]||(e[52]=U(" æ¯åˆ†é’ŸTokenæ•° ",-1)),a(n).isHistoricalMetrics?(f(),x("span",Cs,e[51]||(e[51]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),U(" å†å²æ•°æ® ",-1)]))):I("",!0)])]),e[53]||(e[53]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-rose-500 to-rose-600"},[t("i",{class:"fas fa-rocket"})],-1))])])]),t("div",Ts,[t("div",Ds,[e[60]||(e[60]=t("h3",{class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"}," æ¨¡å‹ä½¿ç”¨åˆ†å¸ƒä¸Tokenä½¿ç”¨è¶‹åŠ¿ ",-1)),t("div",Ss,[t("div",As,[(f(!0),x(lt,null,it(a(q).presetOptions,s=>(f(),x("button",{key:s.value,class:G(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(q).preset===s.value&&a(q).type==="preset"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:y=>a(l)(s.value)},r(s.label),11,$s))),128))]),t("div",Rs,[t("button",{class:G(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(Z)==="day"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[0]||(e[0]=s=>a(Ct)("day"))},e[54]||(e[54]=[t("i",{class:"fas fa-calendar-day mr-1"},null,-1),U("æŒ‰å¤© ",-1)]),2),t("button",{class:G(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(Z)==="hour"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[1]||(e[1]=s=>a(Ct)("hour"))},e[55]||(e[55]=[t("i",{class:"fas fa-clock mr-1"},null,-1),U("æŒ‰å°æ—¶ ",-1)]),2)]),t("div",Ps,[ae(m,{modelValue:a(q).customRange,"onUpdate:modelValue":e[2]||(e[2]=s=>a(q).customRange=s),class:"custom-date-picker w-full lg:w-auto","default-time":a(Ot),"disabled-date":a(Yt),"end-placeholder":"ç»“æŸæ—¥æœŸ",format:"YYYY-MM-DD HH:mm:ss","range-separator":"è‡³",size:"default","start-placeholder":"å¼€å§‹æ—¥æœŸ",style:{"max-width":"400px"},type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss",onChange:a(O)},null,8,["modelValue","default-time","disabled-date","onChange"]),a(Z)==="hour"?(f(),x("span",Is,e[56]||(e[56]=[t("i",{class:"fas fa-info-circle"},null,-1),U(" æœ€å¤š24å°æ—¶ ",-1)]))):I("",!0)]),t("div",Bs,[t("div",Us,[t("label",Ks,[_e(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>d.value=s),class:"peer sr-only",type:"checkbox"},null,512),[[we,d.value]]),e[59]||(e[59]=t("div",{class:"peer relative h-5 w-9 rounded-full bg-gray-300 transition-all duration-200 after:absolute after:left-[2px] after:top-0.5 after:h-4 after:w-4 after:rounded-full after:bg-white after:shadow-sm after:transition-transform after:duration-200 after:content-[''] peer-checked:bg-blue-500 peer-checked:after:translate-x-4 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:bg-gray-600 dark:after:bg-gray-300 dark:peer-focus:ring-blue-600"},null,-1)),t("span",Ms,[e[57]||(e[57]=t("i",{class:"fas fa-redo-alt text-xs text-gray-500 dark:text-gray-400"},null,-1)),e[58]||(e[58]=t("span",null,"è‡ªåŠ¨åˆ·æ–°",-1)),d.value?(f(),x("span",{key:0,class:G(["ml-1 font-mono text-xs text-blue-600 transition-opacity",c.value>0?"opacity-100":"opacity-0"])},r(c.value)+"s ",3)):I("",!0)])])]),t("button",{class:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-3 py-1 text-sm font-medium text-blue-600 shadow-sm transition-colors hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 sm:gap-2",disabled:b.value,title:"ç«‹å³åˆ·æ–°æ•°æ®",onClick:e[4]||(e[4]=s=>Zt())},[t("i",{class:G(["fas fa-sync-alt text-xs",{"animate-spin":b.value}])},null,2),t("span",Os,r(b.value?"åˆ·æ–°ä¸­":"åˆ·æ–°"),1)],8,Fs)])])]),t("div",Ls,[t("div",qs,[e[61]||(e[61]=t("h4",{class:"mb-4 text-base font-semibold text-gray-800 dark:text-gray-200 sm:text-lg"}," Tokenä½¿ç”¨åˆ†å¸ƒ ",-1)),t("div",zs,[t("canvas",{ref_key:"modelUsageChart",ref:D},null,512)])]),t("div",Es,[e[64]||(e[64]=t("h4",{class:"mb-4 text-base font-semibold text-gray-800 dark:text-gray-200 sm:text-lg"}," è¯¦ç»†ç»Ÿè®¡æ•°æ® ",-1)),a(X).length===0?(f(),x("div",Gs,e[62]||(e[62]=[t("p",{class:"text-sm text-gray-500 sm:text-base"},"æš‚æ— æ¨¡å‹ä½¿ç”¨æ•°æ®",-1)]))):(f(),x("div",js,[t("table",Ns,[e[63]||(e[63]=t("thead",{class:"sticky top-0 bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," æ¨¡å‹ "),t("th",{class:"hidden px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:table-cell sm:px-4"}," è¯·æ±‚æ•° "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," æ€»Token "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," è´¹ç”¨ "),t("th",{class:"hidden px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:table-cell sm:px-4"}," å æ¯” ")])],-1)),t("tbody",Hs,[(f(!0),x(lt,null,it(a(X),s=>(f(),x("tr",{key:s.model,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",Vs,[t("span",{class:"block max-w-[100px] truncate sm:max-w-none",title:s.model},r(s.model),9,Ys)]),t("td",Ws,r(T(s.requests)),1),t("td",Js,r(T(s.allTokens)),1),t("td",Qs,r(s.formatted?s.formatted.total:"$0.000000"),1),t("td",Xs,[t("span",Zs,r(qt(s.allTokens,a(X)))+"% ",1)])]))),128))])])]))])])]),t("div",to,[t("div",eo,[t("div",ao,[t("canvas",{ref_key:"usageTrendChart",ref:tt},null,512)])])]),t("div",so,[t("div",oo,[t("div",ro,[e[67]||(e[67]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg"}," API Keys ä½¿ç”¨æ’è¡Œ ",-1)),t("div",no,[t("button",{class:G(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(N)==="requests"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[5]||(e[5]=s=>(N.value="requests",ne()))},e[65]||(e[65]=[t("i",{class:"fas fa-exchange-alt mr-1"},null,-1),t("span",{class:"hidden sm:inline"},"è¯·æ±‚æ¬¡æ•°",-1),t("span",{class:"sm:hidden"},"è¯·æ±‚",-1)]),2),t("button",{class:G(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(N)==="tokens"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[6]||(e[6]=s=>(N.value="tokens",ne()))},e[66]||(e[66]=[t("i",{class:"fas fa-coins mr-1"},null,-1),t("span",{class:"hidden sm:inline"},"Token æ•°é‡",-1),t("span",{class:"sm:hidden"},"Token",-1)]),2)])]),t("div",lo,[(((A=a(L).apiKeyStats)==null?void 0:A.length)||0)>50?(f(),x("span",io," å…± "+r((B=a(L).apiKeyStats)==null?void 0:B.length)+" ä¸ª API Keyï¼Œå›¾è¡¨æ˜¾ç¤º Top 50 ",1)):(f(),x("span",co," å…± "+r(((C=a(L).apiKeyStats)==null?void 0:C.length)||0)+" ä¸ª API Key ",1)),e[68]||(e[68]=t("span",{class:"ml-2 text-gray-400"},"(ç‚¹å‡»æŸ±çŠ¶å›¾æŸ¥çœ‹è¯¦æƒ…)",-1))]),t("div",uo,[t("canvas",{ref_key:"apiKeysUsageTrendChart",ref:H},null,512)]),t("div",po,[e[76]||(e[76]=t("h4",{class:"mb-4 text-sm font-semibold text-gray-800 dark:text-gray-200"},"ä½¿ç”¨é‡æ˜ç»†è¡¨",-1)),t("div",go,[t("table",mo,[t("thead",yo,[t("tr",null,[e[72]||(e[72]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ’å ",-1)),e[73]||(e[73]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," API Key åç§° ",-1)),t("th",{class:"cursor-pointer select-none px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",scope:"col",onClick:e[7]||(e[7]=s=>Qt("requests"))},[t("div",xo,[e[69]||(e[69]=t("span",null,"è¯·æ±‚æ•°",-1)),ft.value==="requests"?(f(),x("i",{key:0,class:G(["fas ml-1",nt.value==="asc"?"fa-sort-up":"fa-sort-down"])},null,2)):(f(),x("i",fo))])]),t("th",{class:"cursor-pointer select-none px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",scope:"col",onClick:e[8]||(e[8]=s=>Qt("tokens"))},[t("div",vo,[e[70]||(e[70]=t("span",null,"Token æ€»é‡",-1)),ft.value==="tokens"?(f(),x("i",{key:0,class:G(["fas ml-1",nt.value==="asc"?"fa-sort-up":"fa-sort-down"])},null,2)):(f(),x("i",bo))])]),t("th",{class:"cursor-pointer select-none px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",scope:"col",onClick:e[9]||(e[9]=s=>Qt("cost"))},[t("div",ho,[e[71]||(e[71]=t("span",null,"é¢„ä¼°è´¹ç”¨",-1)),ft.value==="cost"?(f(),x("i",{key:0,class:G(["fas ml-1",nt.value==="asc"?"fa-sort-up":"fa-sort-down"])},null,2)):(f(),x("i",ko))])]),e[74]||(e[74]=t("th",{class:"px-6 py-3 text-center text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ“ä½œ ",-1))])]),t("tbody",_o,[(f(!0),x(lt,null,it(oe.value,(s,y)=>(f(),x("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},[t("td",wo,r((yt.value-1)*xt.value+y+1),1),t("td",Co,[t("button",{class:"text-blue-600 hover:text-blue-800 hover:underline dark:text-blue-400 dark:hover:text-blue-300",onClick:R=>Xt(s)},r(s.name||s.id),9,To),t("div",Do,r(s.id.substring(0,8))+"...",1)]),t("td",So,r(s.requests.toLocaleString()),1),t("td",Ao,r(T(s.tokens)),1),t("td",$o,r(s.formattedCost),1),t("td",Ro,[t("button",{class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",onClick:R=>Xt(s)}," æŸ¥çœ‹è¯¦æƒ… ",8,Po)])]))),128)),oe.value.length===0?(f(),x("tr",Io,e[75]||(e[75]=[t("td",{class:"px-6 py-4 text-center text-sm text-gray-500",colspan:"6"},"æš‚æ— æ•°æ®",-1)]))):I("",!0)])])]),(((P=a(L).apiKeyStats)==null?void 0:P.length)||0)>xt.value?(f(),x("div",Bo,[ae($,{"current-page":yt.value,"onUpdate:currentPage":e[10]||(e[10]=s=>yt.value=s),"page-size":xt.value,"onUpdate:pageSize":e[11]||(e[11]=s=>xt.value=s),background:"",layout:"total, sizes, prev, pager, next","page-sizes":[5,10,20,50],small:"",total:((M=a(L).apiKeyStats)==null?void 0:M.length)||0,onCurrentChange:re,onSizeChange:e[12]||(e[12]=s=>re(1))},null,8,["current-page","page-size","total"])])):I("",!0)])])]),t("div",Uo,[t("div",Ko,[t("div",Mo,[t("div",Fo,[e[77]||(e[77]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg"}," è´¦å·ä½¿ç”¨è¶‹åŠ¿ ",-1)),t("span",Oo," å½“å‰åˆ†ç»„ï¼š"+r(a(F).groupLabel||"æœªé€‰æ‹©"),1)]),t("div",Lo,[t("div",qo,[(f(),x(lt,null,it(ot,s=>t("button",{key:s.value,class:G(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(_t)===s.value?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:y=>ge(s.value)},r(s.label),11,zo)),64))])])]),t("div",Eo,[t("span",null,"å…± "+r(a(F).totalAccounts||0)+" ä¸ªè´¦å·",1),a(F).topAccounts&&a(F).topAccounts.length?(f(),x("span",Go," æ˜¾ç¤ºæ¶ˆè€—æ’åå‰ "+r(a(F).topAccounts.length)+" ä¸ªè´¦å· ",1)):I("",!0)]),!a(F).data||a(F).data.length===0?(f(),x("div",jo," æš‚æ— è´¦å·ä½¿ç”¨æ•°æ® ")):(f(),x("div",No,[t("canvas",{ref_key:"accountUsageTrendChart",ref:Tt},null,512)]))])]),ae(h,{modelValue:Pt.value,"onUpdate:modelValue":e[13]||(e[13]=s=>Pt.value=s),"append-to-body":"","destroy-on-close":"",style:{width:"90%","max-width":"1200px"},title:Y.value?`API Key è¯¦æƒ…: ${Y.value.name||Y.value.id}`:"API Key è¯¦æƒ…"},{default:Ce(()=>{var s,y,R;return[zt.value?(f(),x("div",Ho,e[78]||(e[78]=[t("i",{class:"fas fa-spinner fa-spin text-2xl text-blue-500"},null,-1),t("p",{class:"mt-2 text-gray-500"},"åŠ è½½ä¸­...",-1)]))):(f(),x("div",Vo,[t("div",Yo,[t("div",Wo,[e[79]||(e[79]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"æ€»è¯·æ±‚æ•°",-1)),t("p",Jo,r((s=Y.value)==null?void 0:s.requests.toLocaleString()),1)]),t("div",Qo,[e[80]||(e[80]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Token æ€»é‡",-1)),t("p",Xo,r(T(((y=Y.value)==null?void 0:y.tokens)||0)),1)]),t("div",Zo,[e[81]||(e[81]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"é¢„ä¼°è´¹ç”¨",-1)),t("p",tr,r((R=Y.value)==null?void 0:R.formattedCost),1)])]),t("div",er,[e[82]||(e[82]=t("h4",{class:"mb-3 text-sm font-semibold text-gray-800 dark:text-gray-200"}," ä½¿ç”¨è¶‹åŠ¿ (å½“å‰æ—¶é—´æ®µ) ",-1)),t("div",ar,[t("canvas",{ref_key:"apiKeyDetailChart",ref:Wt},null,512)])]),mt.value&&mt.value.length>0?(f(),x("div",sr,[e[84]||(e[84]=t("h4",{class:"mb-3 text-sm font-semibold text-gray-800 dark:text-gray-200"},"æ¨¡å‹ä½¿ç”¨æ˜ç»†",-1)),t("div",or,[t("table",rr,[e[83]||(e[83]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ¨¡å‹ "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¯·æ±‚æ•° "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¾“å…¥ Token "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¾“å‡º Token "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," ç¼“å­˜åˆ›å»º "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," ç¼“å­˜è¯»å– "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ€»è®¡ "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è´¹ç”¨ ")])],-1)),t("tbody",nr,[(f(!0),x(lt,null,it(mt.value,_=>{var K;return f(),x("tr",{key:_.model,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},[t("td",lr,r(_.model),1),t("td",ir,r(_.requests.toLocaleString()),1),t("td",dr,r(T(_.inputTokens)),1),t("td",cr,r(T(_.outputTokens)),1),t("td",ur,r(T(_.cacheCreateTokens)),1),t("td",pr,r(T(_.cacheReadTokens)),1),t("td",gr,r(T(_.allTokens)),1),t("td",mr,r(((K=_.formatted)==null?void 0:K.totalCost)||"$0.00"),1)])}),128))])])])])):I("",!0),It.value&&It.value.length>0?(f(),x("div",yr,[e[86]||(e[86]=t("h4",{class:"mb-3 text-sm font-semibold text-gray-800 dark:text-gray-200"},"æŒ‰å¤©ç”¨é‡æ˜ç»†",-1)),t("div",xr,[t("table",fr,[e[85]||(e[85]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ—¥æœŸ "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¯·æ±‚æ¬¡æ•° "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ€» Token "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è´¹ç”¨ ")])],-1)),t("tbody",vr,[(f(!0),x(lt,null,it(It.value,_=>{var K,W;return f(),x("tr",{key:_.date,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},[t("td",br,r(_.date),1),t("td",hr,r(((K=_.requests)==null?void 0:K.toLocaleString())||0),1),t("td",kr,r(z(_.allTokens)),1),t("td",_r,r(((W=_.formatted)==null?void 0:W.totalCost)||"$0.00"),1)])}),128))])])])])):I("",!0)]))]}),_:1},8,["modelValue","title"])])}}},Rr=De(wr,[["__scopeId","data-v-8ee7cd17"]]);export{Rr as default};
