import{E as pe,a as ge,b as me}from"./element-plus-_zlBx3PA.js";import{aP as ye,r as A,c as Et,aX as le,o as xt,q as xe,D as W,V as fe,x as v,z as t,R as Zt,P as r,u as a,L as I,O as B,C as J,Q as nt,ac as lt,K as ve,al as be,J as he,y as b,B as ke}from"./vue-vendor-R8HMg95E.js";import{c as Q,s as Gt,_ as _e,a as we}from"./index-Bl8egcFM.js";import{C as It}from"./chart-yFHxLHpB.js";import"./vendor-Dr8jvgFu.js";const Ce=ye("dashboard",()=>{const Bt=A(!1),it=A({totalApiKeys:0,activeApiKeys:0,totalAccounts:0,normalAccounts:0,abnormalAccounts:0,pausedAccounts:0,activeAccounts:0,rateLimitedAccounts:0,accountsByPlatform:{claude:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},"claude-console":{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},gemini:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},azure_openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},bedrock:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0}},todayRequests:0,totalRequests:0,todayTokens:0,todayInputTokens:0,todayOutputTokens:0,totalTokens:0,totalInputTokens:0,totalOutputTokens:0,totalCacheCreateTokens:0,totalCacheReadTokens:0,todayCacheCreateTokens:0,todayCacheReadTokens:0,systemRPM:0,systemTPM:0,realtimeRPM:0,realtimeTPM:0,metricsWindow:5,isHistoricalMetrics:!1,systemStatus:"æ­£å¸¸",uptime:0,systemTimezone:8}),Ut=A({todayCosts:{totalCost:0,formatted:{totalCost:"$0.000000"}},totalCosts:{totalCost:0,formatted:{totalCost:"$0.000000"}}}),dt=A([]),n=A([]),ft=A([]),X=A({data:[],topApiKeys:[],totalApiKeys:0}),vt=A({data:[],topAccounts:[],totalAccounts:0,group:"claude",groupLabel:"Claudeè´¦æˆ·"}),L={preset:"dashboard:date:preset",granularity:"dashboard:trend:granularity"},F="today",bt="day",ct=p=>p==="hour"?[{value:"last24h",label:"è¿‘24å°æ—¶",hours:24},{value:"yesterday",label:"æ˜¨å¤©",hours:24},{value:"dayBefore",label:"å‰å¤©",hours:24}]:[{value:"today",label:"ä»Šæ—¥",days:1},{value:"7days",label:"7å¤©",days:7},{value:"30days",label:"30å¤©",days:30}],q=(p,k)=>{try{return localStorage.getItem(p)||k}catch{return k}},Z=(p,k)=>{try{localStorage.setItem(p,k)}catch{}},N=(p,k)=>ct(k).some(w=>w.value===p)?p:k==="hour"?"last24h":F,Kt=q(L.granularity,bt),ht=["day","hour"].includes(Kt)?Kt:bt,Nt=N(q(L.preset,F),ht),l=A({type:"preset",preset:Nt,customStart:"",customEnd:"",customRange:null,presetOptions:ct(ht)}),O=A(ht),kt=A("requests"),ut=A("claude"),jt=A([new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)]),Ht=Et(()=>{const p=it.value.uptime,k=Math.floor(p/86400),x=Math.floor(p%86400/3600),d=Math.floor(p%3600/60);return k>0?`${k}å¤© ${x}å°æ—¶`:x>0?`${x}å°æ—¶ ${d}åˆ†é’Ÿ`:`${d}åˆ†é’Ÿ`});function D(p,k=!0){const x=p.getFullYear(),d=p.getMonth(),w=p.getDate();return k?new Date(Date.UTC(x,d,w-1,16,0,0,0)):new Date(Date.UTC(x,d,w,15,59,59,999))}const tt=(p=l.value.preset,k=O.value)=>{Z(L.preset,p),Z(L.granularity,k)},j=()=>l.value.type==="preset"&&l.value.preset==="today"&&O.value==="day"?"hour":O.value;async function _t(p=null){Bt.value=!0;try{let k={today:"today",all:"all"};p&&(k={today:{today:"today",all:"today"},"7days":{today:"7days",all:"7days"},monthly:{today:"monthly",all:"monthly"},all:{today:"today",all:"all"}}[p]||k);const[x,d,w]=await Promise.all([Q.get("/admin/dashboard"),Q.get(`/admin/usage-costs?period=${k.today}`),Q.get(`/admin/usage-costs?period=${k.all}`)]);if(x.success){const i=x.data.overview||{},c=x.data.recentActivity||{},u=x.data.systemAverages||{},f=x.data.realtimeMetrics||{},g=x.data.systemHealth||{};it.value={totalApiKeys:i.totalApiKeys||0,activeApiKeys:i.activeApiKeys||0,totalAccounts:i.totalAccounts||i.totalClaudeAccounts||0,normalAccounts:i.normalAccounts||0,abnormalAccounts:i.abnormalAccounts||0,pausedAccounts:i.pausedAccounts||0,activeAccounts:i.activeAccounts||i.activeClaudeAccounts||0,rateLimitedAccounts:i.rateLimitedAccounts||i.rateLimitedClaudeAccounts||0,accountsByPlatform:i.accountsByPlatform||{claude:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},"claude-console":{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},gemini:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},azure_openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},bedrock:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0}},todayRequests:c.requestsToday||0,totalRequests:i.totalRequestsUsed||0,todayTokens:c.tokensToday||0,todayInputTokens:c.inputTokensToday||0,todayOutputTokens:c.outputTokensToday||0,totalTokens:i.totalTokensUsed||0,totalInputTokens:i.totalInputTokensUsed||0,totalOutputTokens:i.totalOutputTokensUsed||0,totalCacheCreateTokens:i.totalCacheCreateTokensUsed||0,totalCacheReadTokens:i.totalCacheReadTokensUsed||0,todayCacheCreateTokens:c.cacheCreateTokensToday||0,todayCacheReadTokens:c.cacheReadTokensToday||0,systemRPM:u.rpm||0,systemTPM:u.tpm||0,realtimeRPM:f.rpm||0,realtimeTPM:f.tpm||0,metricsWindow:f.windowMinutes||5,isHistoricalMetrics:f.isHistorical||!1,systemStatus:g.redisConnected?"æ­£å¸¸":"å¼‚å¸¸",uptime:g.uptime||0,systemTimezone:x.data.systemTimezone||8}}d.success&&w.success&&(Ut.value={todayCosts:d.data.totalCosts||{totalCost:0,formatted:{totalCost:"$0.000000"}},totalCosts:w.data.totalCosts||{totalCost:0,formatted:{totalCost:"$0.000000"}}})}catch(k){console.error("åŠ è½½ä»ªè¡¨æ¿æ•°æ®å¤±è´¥:",k)}finally{Bt.value=!1}}async function et(p=7,k=j()){try{let x="/admin/usage-trend?";if(k==="hour")if(x+="granularity=hour",l.value.customRange&&l.value.customRange.length===2)x+=`&startDate=${encodeURIComponent(l.value.customRange[0])}`,x+=`&endDate=${encodeURIComponent(l.value.customRange[1])}`;else{const w=new Date;let i,c;if(l.value.type==="preset")switch(l.value.preset){case"today":{i=D(w,!0),c=D(w,!1);break}case"last24h":{c=new Date(w),i=new Date(w.getTime()-24*60*60*1e3);break}case"yesterday":{const u=new Date;u.setDate(u.getDate()-1),i=D(u,!0),c=D(u,!1);break}case"dayBefore":{const u=new Date;u.setDate(u.getDate()-2),i=D(u,!0),c=D(u,!1);break}default:i=new Date(w.getTime()-24*60*60*1e3),c=w}else i=new Date(w.getTime()-p*24*60*60*1e3),c=w;x+=`&startDate=${encodeURIComponent(i.toISOString())}`,x+=`&endDate=${encodeURIComponent(c.toISOString())}`}else x+=`granularity=day&days=${p}`;const d=await Q.get(x);d.success&&(n.value=d.data)}catch(x){console.error("åŠ è½½ä½¿ç”¨è¶‹åŠ¿å¤±è´¥:",x)}}async function at(p="daily",k=null){const x=k||j();try{let d=`/admin/model-stats?period=${p}`;if(l.value.type==="custom"||x==="hour"){if(l.value.customRange&&l.value.customRange.length===2)d+=`&startDate=${encodeURIComponent(l.value.customRange[0])}`,d+=`&endDate=${encodeURIComponent(l.value.customRange[1])}`;else if(x==="hour"&&l.value.type==="preset"){const i=new Date;let c,u;switch(l.value.preset){case"today":{c=D(i,!0),u=D(i,!1);break}case"last24h":{u=new Date(i),c=new Date(i.getTime()-24*60*60*1e3);break}case"yesterday":{const f=new Date;f.setDate(f.getDate()-1),c=D(f,!0),u=D(f,!1);break}case"dayBefore":{const f=new Date;f.setDate(f.getDate()-2),c=D(f,!0),u=D(f,!1);break}default:c=new Date(i.getTime()-24*60*60*1e3),u=i}d+=`&startDate=${encodeURIComponent(c.toISOString())}`,d+=`&endDate=${encodeURIComponent(u.toISOString())}`}}else if(l.value.type==="preset"&&x==="day"){const i=new Date;let c,u;const f=l.value.presetOptions.find(g=>g.value===l.value.preset);if(f){if(l.value.preset==="today")c=D(i,!0),u=D(i,!1);else{const g=new Date;g.setDate(g.getDate()-(f.days-1)),c=D(g,!0),u=D(i,!1)}d+=`&startDate=${encodeURIComponent(c.toISOString())}`,d+=`&endDate=${encodeURIComponent(u.toISOString())}`}}const w=await Q.get(d);w.success&&(ft.value=w.data)}catch(d){console.error("åŠ è½½æ¨¡å‹ç»Ÿè®¡å¤±è´¥:",d)}}async function st(p="requests",k=null){const x=k||j();try{let d="/admin/api-keys-usage-trend?",w=7;if(x==="hour")if(d+="granularity=hour",l.value.customRange&&l.value.customRange.length===2)d+=`&startDate=${encodeURIComponent(l.value.customRange[0])}`,d+=`&endDate=${encodeURIComponent(l.value.customRange[1])}`;else{const c=new Date;let u,f;if(l.value.type==="preset")switch(l.value.preset){case"today":{u=D(c,!0),f=D(c,!1);break}case"last24h":{f=new Date(c),u=new Date(c.getTime()-24*60*60*1e3);break}case"yesterday":{const g=new Date;g.setDate(g.getDate()-1),u=D(g,!0),f=D(g,!1);break}case"dayBefore":{const g=new Date;g.setDate(g.getDate()-2),u=D(g,!0),f=D(g,!1);break}default:u=new Date(c.getTime()-24*60*60*1e3),f=c}else u=new Date(c.getTime()-24*60*60*1e3),f=c;d+=`&startDate=${encodeURIComponent(u.toISOString())}`,d+=`&endDate=${encodeURIComponent(f.toISOString())}`}else w=l.value.type==="preset"?l.value.preset==="today"?1:l.value.preset==="7days"?7:30:Ct(l.value.customStart,l.value.customEnd),d+=`granularity=day&days=${w}`;d+=`&metric=${p}`;const i=await Q.get(d);i.success&&(X.value={data:i.data||[],apiKeyStats:i.apiKeyStats||[],topApiKeys:i.topApiKeys||[],totalApiKeys:i.totalApiKeys||0})}catch(d){console.error("åŠ è½½API Keysè¶‹åŠ¿å¤±è´¥:",d)}}async function H(p=ut.value,k=null){const x=k||j();try{let d="/admin/account-usage-trend?",w=7;if(x==="hour")if(d+="granularity=hour",l.value.customRange&&l.value.customRange.length===2)d+=`&startDate=${encodeURIComponent(l.value.customRange[0])}`,d+=`&endDate=${encodeURIComponent(l.value.customRange[1])}`;else{const c=new Date;let u,f;if(l.value.type==="preset")switch(l.value.preset){case"today":{u=D(c,!0),f=D(c,!1);break}case"last24h":{f=new Date(c),u=new Date(c.getTime()-24*60*60*1e3);break}case"yesterday":{const g=new Date;g.setDate(g.getDate()-1),u=D(g,!0),f=D(g,!1);break}case"dayBefore":{const g=new Date;g.setDate(g.getDate()-2),u=D(g,!0),f=D(g,!1);break}default:u=new Date(c.getTime()-24*60*60*1e3),f=c}else u=new Date(c.getTime()-24*60*60*1e3),f=c;d+=`&startDate=${encodeURIComponent(u.toISOString())}`,d+=`&endDate=${encodeURIComponent(f.toISOString())}`}else w=l.value.type==="preset"?l.value.preset==="today"?1:l.value.preset==="7days"?7:30:Ct(l.value.customStart,l.value.customEnd),d+=`granularity=day&days=${w}`;d+=`&group=${p}`;const i=await Q.get(d);i.success&&(vt.value={data:i.data||[],topAccounts:i.topAccounts||[],totalAccounts:i.totalAccounts||0,group:i.group||p,groupLabel:i.groupLabel||""})}catch(d){console.error("åŠ è½½è´¦å·ä½¿ç”¨è¶‹åŠ¿å¤±è´¥:",d)}}function ot(p,k={}){const{silent:x=!1,skipSave:d=!1}=k,w=N(p,O.value);l.value.type="preset",l.value.preset=w;const i=l.value.presetOptions.find(T=>T.value===w),c=new Date;let u,f;if(O.value==="hour")switch(w){case"today":{u=D(c,!0),f=D(c,!1);break}case"last24h":{f=new Date(c),u=new Date(c.getTime()-24*60*60*1e3);break}case"yesterday":{const T=new Date;T.setDate(T.getDate()-1),u=D(T,!0),f=D(T,!1);break}case"dayBefore":{const T=new Date;T.setDate(T.getDate()-2),u=D(T,!0),f=D(T,!1);break}default:f=new Date(c),u=new Date(c.getTime()-24*60*60*1e3)}else u=new Date(c),f=new Date(c),w==="today"?(u.setHours(0,0,0,0),f.setHours(23,59,59,999)):i!=null&&i.days&&(u.setDate(c.getDate()-(i.days-1)),u.setHours(0,0,0,0),f.setHours(23,59,59,999));const g=T=>{const z=new Date(T),pt=z.getFullYear(),Ft=String(z.getMonth()+1).padStart(2,"0"),Dt=String(z.getDate()).padStart(2,"0"),At=String(z.getHours()).padStart(2,"0"),St=String(z.getMinutes()).padStart(2,"0"),V=String(z.getSeconds()).padStart(2,"0");return`${pt}-${Ft}-${Dt} ${At}:${St}:${V}`};l.value.customStart=u?u.toISOString().split("T")[0]:"",l.value.customEnd=f?f.toISOString().split("T")[0]:"",l.value.customRange=u&&f?[g(u),g(f)]:null,d||tt(l.value.preset,O.value),x||G()}function wt(p){if(p&&p.length===2){l.value.type="custom",l.value.preset="",l.value.customRange=p,l.value.customStart=p[0].split(" ")[0],l.value.customEnd=p[1].split(" ")[0];const k=w=>{const[i,c]=w.split(" "),[u,f,g]=i.split("-").map(Number),[T,z,pt]=c.split(":").map(Number);return new Date(u,f-1,g,T,z,pt)},x=k(p[0]),d=k(p[1]);if(O.value==="hour"){if((d-x)/36e5>24){Gt("å°æ—¶ç²’åº¦ä¸‹æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡24å°æ—¶","warning");return}}else if(Math.ceil((d-x)/864e5)+1>31){Gt("æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡ 31 å¤©","warning");return}G()}else p===null&&ot(O.value==="hour"?"last24h":F)}function rt(p,k={}){const{silent:x=!1,skipSave:d=!1,presetOverride:w}=k;if(O.value=p,p==="hour"){if(l.value.presetOptions=ct("hour"),l.value.type==="custom"&&l.value.customRange&&l.value.customRange.length===2){const c=new Date(l.value.customRange[0]);if((new Date(l.value.customRange[1])-c)/(1e3*60*60)>24){Gt("å°æ—¶ç²’åº¦ä¸‹æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡24å°æ—¶ï¼Œå·²åˆ‡æ¢åˆ°è¿‘24å°æ—¶","warning"),ot("last24h",{silent:x,skipSave:d});return}}}else l.value.presetOptions=ct("day");if(l.value.type==="custom"){d||tt(l.value.preset||F,O.value),x||G();return}const i=w||N(l.value.preset,O.value);ot(i,{silent:!0,skipSave:!0}),d||tt(l.value.preset,O.value),x||G()}async function G(){let p,k="monthly";const x=j();if(l.value.type==="preset"){const d=l.value.presetOptions.find(w=>w.value===l.value.preset);x==="hour"?(p=1,k="daily"):(p=d?d.days:7,l.value.preset==="today"?k="daily":k="monthly")}else{if(x==="hour"){const d=new Date(l.value.customRange[0]),w=new Date(l.value.customRange[1]),i=Math.ceil((w-d)/(1e3*60*60));p=Math.ceil(i/24)||1}else p=Ct(l.value.customStart,l.value.customEnd);k="daily"}await Promise.all([et(p,x),at(k,x),st(kt.value,x),H(ut.value,x)])}function Mt(p){return ut.value=p,H(p,j())}function Ct(p,k){if(!p||!k)return 7;const x=new Date(p),d=new Date(k),w=Math.abs(d-x);return Math.ceil(w/(1e3*60*60*24))||7}function Tt(p){return p>new Date}return ot(l.value.preset,{silent:!0,skipSave:!0}),tt(l.value.preset,O.value),{loading:Bt,dashboardData:it,costsData:Ut,modelStats:dt,trendData:n,dashboardModelStats:ft,apiKeysTrendData:X,accountUsageTrendData:vt,dateFilter:l,trendGranularity:O,apiKeysTrendMetric:kt,accountUsageGroup:ut,defaultTime:jt,formattedUptime:Ht,loadDashboardData:_t,loadUsageTrend:et,loadModelStats:at,loadApiKeysTrend:st,loadAccountUsageTrend:H,setDateFilterPreset:ot,onCustomDateRangeChange:wt,setTrendGranularity:rt,refreshChartsData:G,setAccountUsageGroup:Mt,disabledDate:Tt}}),Te={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6 lg:grid-cols-4"},De={class:"stat-card"},Ae={class:"flex items-center justify-between"},Se={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},$e={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Re={class:"stat-card"},Pe={class:"flex items-center justify-between"},Ie={class:"flex-1"},Be={class:"flex flex-wrap items-baseline gap-x-2"},Ue={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},Ke={key:0,class:"flex items-center gap-2"},Me=["title"],Fe={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Oe=["title"],Le={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},qe=["title"],ze={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ee=["title"],Ge={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ne=["title"],je={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},He=["title"],Ve={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ye=["title"],We={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Je={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Qe={key:0,class:"text-red-600"},Xe={key:1,class:"text-gray-600 dark:text-gray-400"},Ze={key:2,class:"text-yellow-600"},ta={class:"stat-card"},ea={class:"flex items-center justify-between"},aa={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},sa={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},oa={class:"stat-card"},ra={class:"flex items-center justify-between"},na={class:"text-2xl font-bold text-green-600 sm:text-3xl"},la={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ia={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6"},da={class:"stat-card"},ca={class:"flex items-center justify-between"},ua={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},pa={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ga={class:"mt-3 flex items-center justify-between gap-3"},ma={class:"text-xs text-gray-500 dark:text-gray-400"},ya=["disabled"],xa={class:"card p-4 sm:p-6"},fa={class:"mb-3 flex items-center justify-between"},va={class:"text-xs text-gray-500 dark:text-gray-400"},ba={key:0,class:"py-6 text-center text-sm text-gray-500 dark:text-gray-400"},ha={key:1,class:"py-6 text-center text-sm text-green-600 dark:text-green-400"},ka={key:2,class:"max-h-64 space-y-2 overflow-y-auto"},_a={class:"flex items-center justify-between gap-2"},wa={class:"truncate text-sm font-medium text-gray-900 dark:text-gray-100"},Ca={class:"rounded bg-gray-100 px-2 py-0.5 text-xs text-gray-600 dark:bg-gray-700 dark:text-gray-300"},Ta={class:"mt-1 text-xs text-gray-600 dark:text-gray-400"},Da={key:0},Aa={key:1},Sa={key:0,class:"mt-2"},$a={class:"mb-1 flex items-center justify-between text-xs text-gray-600 dark:text-gray-400"},Ra={class:"text-red-600 dark:text-red-400"},Pa={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},Ia={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6 lg:grid-cols-4"},Ba={class:"stat-card"},Ua={class:"flex items-center justify-between"},Ka={class:"mr-8 flex-1"},Ma={class:"mb-2 flex flex-wrap items-baseline gap-2"},Fa={class:"text-xl font-bold text-blue-600 sm:text-2xl md:text-3xl"},Oa={class:"text-sm font-medium text-green-600"},La={class:"text-xs text-gray-500 dark:text-gray-400"},qa={class:"flex flex-wrap items-center justify-between gap-x-4"},za={class:"font-medium"},Ea={class:"font-medium"},Ga={key:0,class:"text-purple-600"},Na={class:"font-medium"},ja={key:1,class:"text-purple-600"},Ha={class:"font-medium"},Va={class:"stat-card"},Ya={class:"flex items-center justify-between"},Wa={class:"mr-8 flex-1"},Ja={class:"mb-2 flex flex-wrap items-baseline gap-2"},Qa={class:"text-xl font-bold text-emerald-600 sm:text-2xl md:text-3xl"},Xa={class:"text-sm font-medium text-green-600"},Za={class:"text-xs text-gray-500 dark:text-gray-400"},ts={class:"flex flex-wrap items-center justify-between gap-x-4"},es={class:"font-medium"},as={class:"font-medium"},ss={key:0,class:"text-purple-600"},os={class:"font-medium"},rs={key:1,class:"text-purple-600"},ns={class:"font-medium"},ls={class:"stat-card"},is={class:"flex items-center justify-between"},ds={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},cs={class:"text-xs text-gray-400"},us={class:"text-2xl font-bold text-orange-600 sm:text-3xl"},ps={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},gs={key:0,class:"text-yellow-600"},ms={class:"stat-card"},ys={class:"flex items-center justify-between"},xs={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},fs={class:"text-xs text-gray-400"},vs={class:"text-2xl font-bold text-rose-600 sm:text-3xl"},bs={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},hs={key:0,class:"text-yellow-600"},ks={class:"mb-8"},_s={class:"mb-4 flex flex-col gap-4 sm:mb-6"},ws={class:"flex flex-col gap-2 lg:flex-row lg:items-center lg:justify-end"},Cs={class:"flex flex-shrink-0 gap-1 overflow-x-auto rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},Ts=["onClick"],Ds={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},As={class:"flex items-center gap-2"},Ss={key:0,class:"text-xs text-orange-600"},$s={class:"flex items-center gap-2"},Rs={class:"flex items-center rounded-lg bg-gray-100 px-3 py-1 dark:bg-gray-700"},Ps={class:"relative inline-flex cursor-pointer items-center"},Is={class:"ml-2.5 flex select-none items-center gap-1 text-sm font-medium text-gray-600 dark:text-gray-300"},Bs=["disabled"],Us={class:"hidden sm:inline"},Ks={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},Ms={class:"card p-4 sm:p-6"},Fs={class:"relative",style:{height:"250px"}},Os={class:"card p-4 sm:p-6"},Ls={key:0,class:"py-8 text-center"},qs={key:1,class:"max-h-[250px] overflow-auto sm:max-h-[300px]"},zs={class:"min-w-full"},Es={class:"divide-y divide-gray-200 dark:divide-gray-600"},Gs={class:"px-2 py-2 text-xs text-gray-900 dark:text-gray-100 sm:px-4 sm:text-sm"},Ns=["title"],js={class:"hidden px-2 py-2 text-right text-xs text-gray-600 dark:text-gray-400 sm:table-cell sm:px-4 sm:text-sm"},Hs={class:"px-2 py-2 text-right text-xs text-gray-600 dark:text-gray-400 sm:px-4 sm:text-sm"},Vs={class:"px-2 py-2 text-right text-xs font-medium text-green-600 sm:px-4 sm:text-sm"},Ys={class:"hidden px-2 py-2 text-right text-xs font-medium sm:table-cell sm:px-4 sm:text-sm"},Ws={class:"inline-flex items-center rounded-full bg-blue-100 px-2 py-1 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"},Js={class:"mb-4 sm:mb-6 md:mb-8"},Qs={class:"card p-4 sm:p-6"},Xs={class:"sm:h-[300px]",style:{height:"250px"}},Zs={class:"mb-4 sm:mb-6 md:mb-8"},to={class:"card p-4 sm:p-6"},eo={class:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},ao={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},so={class:"mb-4 text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},oo={key:0},ro={key:1},no={class:"sm:h-[400px]",style:{height:"350px"}},lo={class:"mt-8 border-t border-gray-100 pt-6 dark:border-gray-700"},io={class:"overflow-x-auto"},co={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},uo={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},po={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400"},go={class:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900 dark:text-gray-100"},mo=["onClick"],yo={class:"text-xs text-gray-400"},xo={class:"whitespace-nowrap px-6 py-4 text-right text-sm text-gray-500 dark:text-gray-400"},fo={class:"whitespace-nowrap px-6 py-4 text-right text-sm text-gray-500 dark:text-gray-400"},vo={class:"whitespace-nowrap px-6 py-4 text-right text-sm text-green-600 dark:text-green-400"},bo={class:"whitespace-nowrap px-6 py-4 text-center text-sm font-medium"},ho=["onClick"],ko={key:0},_o={key:0,class:"mt-4 flex justify-end"},wo={class:"mb-4 sm:mb-6 md:mb-8"},Co={class:"card p-4 sm:p-6"},To={class:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Do={class:"flex flex-col gap-1 sm:flex-row sm:items-center sm:gap-3"},Ao={class:"text-xs text-gray-500 dark:text-gray-400 sm:text-sm"},So={class:"flex flex-wrap items-center gap-2"},$o={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},Ro=["onClick"],Po={class:"mb-4 flex flex-wrap items-center gap-2 text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},Io={key:0},Bo={key:0,class:"py-12 text-center text-sm text-gray-500 dark:text-gray-400"},Uo={key:1,class:"sm:h-[350px]",style:{height:"300px"}},Ko={key:0,class:"py-12 text-center"},Mo={key:1},Fo={class:"mb-6 grid grid-cols-3 gap-4 rounded-lg bg-gray-50 p-4 dark:bg-gray-800"},Oo={class:"text-center"},Lo={class:"text-xl font-bold text-gray-900 dark:text-gray-100"},qo={class:"text-center"},zo={class:"text-xl font-bold text-blue-600 dark:text-blue-400"},Eo={class:"text-center"},Go={class:"text-xl font-bold text-green-600 dark:text-green-400"},No={class:"mb-6"},jo={class:"h-[300px] w-full"},Ho={key:0,class:"mt-6"},Vo={class:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700"},Yo={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Wo={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},Jo={class:"whitespace-nowrap px-4 py-3 text-sm font-medium text-gray-900 dark:text-gray-100"},Qo={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},Xo={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},Zo={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},tr={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},er={class:"whitespace-nowrap px-4 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},ar={class:"whitespace-nowrap px-4 py-3 text-right text-sm font-medium text-blue-600 dark:text-blue-400"},sr={class:"whitespace-nowrap px-4 py-3 text-right text-sm font-medium text-green-600 dark:text-green-400"},or={key:1,class:"mt-6"},rr={class:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700"},nr={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},lr={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900"},ir={class:"whitespace-nowrap px-6 py-3 text-sm font-medium text-gray-900 dark:text-gray-100"},dr={class:"whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 dark:text-gray-400"},cr={class:"whitespace-nowrap px-6 py-3 text-right text-sm font-medium text-blue-600 dark:text-blue-400"},ur={class:"whitespace-nowrap px-6 py-3 text-right text-sm font-medium text-green-600 dark:text-green-400"},pr={__name:"DashboardView",setup(Bt){const it=Ce(),Ut=we(),{isDarkMode:dt}=le(Ut),{dashboardData:n,costsData:ft,dashboardModelStats:X,trendData:vt,apiKeysTrendData:L,accountUsageTrendData:F,accountUsageGroup:bt,formattedUptime:ct,dateFilter:q,trendGranularity:Z,apiKeysTrendMetric:N,defaultTime:Kt}=le(it),{loadDashboardData:ht,loadApiKeysTrend:Nt,setDateFilterPreset:l,onCustomDateRangeChange:O,setTrendGranularity:kt,refreshChartsData:ut,setAccountUsageGroup:jt,disabledDate:Ht}=it,D=A(null),tt=A(null),j=A(null),_t=A(null);let et=null,at=null,st=null,H=null;const ot=[{value:"claude",label:"Claude"},{value:"openai",label:"OpenAI"},{value:"gemini",label:"Gemini"},{value:"droid",label:"Droid"}],wt=A(!1),rt=A({totalBalance:0,totalCost:0,lowBalanceCount:0,platforms:{}}),G=A(!1),Mt=A(null),Ct=o=>({claude:"Claude","claude-console":"Claude Console",gemini:"Gemini","gemini-api":"Gemini API",openai:"OpenAI","openai-responses":"OpenAI Responses",azure_openai:"Azure OpenAI",bedrock:"Bedrock",droid:"Droid",ccr:"CCR"})[o]||o,Tt=Et(()=>{var m;const o=[],e=((m=rt.value)==null?void 0:m.platforms)||{};return Object.entries(e).forEach(([$,h])=>{(Array.isArray(h==null?void 0:h.accounts)?h.accounts:[]).forEach(U=>{var S,_;const C=U==null?void 0:U.data;if(!C)return;const P=(S=C.balance)==null?void 0:S.amount,M=(_=C.quota)==null?void 0:_.percentage,s=typeof P=="number"&&P<10,y=typeof M=="number"&&M>90;(s||y)&&o.push({...C,name:(U==null?void 0:U.name)||C.accountId,platform:C.platform||$})})}),o}),p=o=>{const e=Number(o);return Number.isFinite(e)?e>=1?`$${e.toFixed(2)}`:e>=.01?`$${e.toFixed(3)}`:`$${e.toFixed(6)}`:"$0.00"},k=o=>{if(!o)return"æœªçŸ¥";const e=new Date(o);return Number.isNaN(e.getTime())?"æœªçŸ¥":e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})},x=async()=>{G.value=!0;try{const o=await Q.get("/admin/accounts/balance/summary");o!=null&&o.success&&(rt.value=o.data||{totalBalance:0,totalCost:0,lowBalanceCount:0,platforms:{}},Mt.value=new Date().toISOString())}catch(o){console.debug("åŠ è½½ä½™é¢æ±‡æ€»å¤±è´¥:",o),Gt("åŠ è½½ä½™é¢æ±‡æ€»å¤±è´¥","error")}finally{G.value=!1}},d=A(!1),w=A(30),i=A(null),c=A(0),u=A(null),f=A(!1),g=Et(()=>({text:dt.value?"#e5e7eb":"#374151",grid:dt.value?"rgba(75, 85, 99, 0.3)":"rgba(0, 0, 0, 0.1)",legend:dt.value?"#e5e7eb":"#374151"}));function T(o){if(o==null||o===void 0)return"0";const e=Number(o);return Number.isFinite(e)?e>=1e6?(e/1e6).toFixed(2)+"M":e>=1e3?(e/1e3).toFixed(2)+"K":e.toString():"0"}function z(o){if(o==null||o===void 0)return"0";const e=Number(o);return Number.isFinite(e)?e>=1e6?(e/1e6).toFixed(2)+"M":e>=1e3?(e/1e3).toFixed(1)+"k":e.toLocaleString():"0"}function pt(o){return Number.isFinite(o)?o>=1?`$${o.toFixed(2)}`:o>=.01?`$${o.toFixed(3)}`:`$${o.toFixed(6)}`:"$0.000000"}function Ft(o,e){if(!e||e.length===0)return 0;const m=e.reduce(($,h)=>$+h.allTokens,0);return m===0?0:(o/m*100).toFixed(1)}function Dt(){if(!D.value)return;et&&et.destroy();const o=X.value||[],e={labels:o.map(m=>m.model),datasets:[{data:o.map(m=>m.allTokens),backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],borderWidth:0}]};et=new It(D.value,{type:"doughnut",data:e,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,usePointStyle:!0,font:{size:12},color:g.value.legend}},tooltip:{callbacks:{label:function(m){const $=m.label||"",h=T(m.parsed),R=Ft(m.parsed,o);return`${$}: ${h} (${R}%)`}}}}}})}function At(){var s;if(!tt.value)return;at&&at.destroy();const o=vt.value||[],e=o.map(y=>y.inputTokens||0),m=o.map(y=>y.outputTokens||0),$=o.map(y=>y.cacheCreateTokens||0),h=o.map(y=>y.cacheReadTokens||0),R=o.map(y=>y.requests||0),U=o.map(y=>y.cost||0),C=(s=o[0])!=null&&s.date?"date":"hour",M={labels:o.map(y=>{if(y.label)return y.label;if(C==="hour"){const _=new Date(y.hour),K=String(_.getMonth()+1).padStart(2,"0"),Y=String(_.getDate()).padStart(2,"0"),E=String(_.getHours()).padStart(2,"0");return`${K}/${Y} ${E}:00`}const S=y.date;if(S&&S.includes("-")){const _=S.split("-");if(_.length>=3)return`${_[1]}/${_[2]}`}return y.date}),datasets:[{label:"è¾“å…¥Token",data:e,borderColor:"rgb(102, 126, 234)",backgroundColor:"rgba(102, 126, 234, 0.1)",tension:.3},{label:"è¾“å‡ºToken",data:m,borderColor:"rgb(240, 147, 251)",backgroundColor:"rgba(240, 147, 251, 0.1)",tension:.3},{label:"ç¼“å­˜åˆ›å»ºToken",data:$,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3},{label:"ç¼“å­˜è¯»å–Token",data:h,borderColor:"rgb(147, 51, 234)",backgroundColor:"rgba(147, 51, 234, 0.1)",tension:.3},{label:"è´¹ç”¨ (USD)",data:U,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.3,yAxisID:"y2"},{label:"è¯·æ±‚æ•°",data:R,borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.3,yAxisID:"y1"}]};at=new It(tt.value,{type:"line",data:M,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{title:{display:!0,text:"Tokenä½¿ç”¨è¶‹åŠ¿",font:{size:16,weight:"bold"},color:g.value.text},legend:{position:"top",labels:{color:g.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:function(y,S){const _=y.dataset.label||"",K=S.dataset.label||"";return _==="è´¹ç”¨ (USD)"||K==="è´¹ç”¨ (USD)"?_==="è´¹ç”¨ (USD)"?-1:1:_==="è¯·æ±‚æ•°"||K==="è¯·æ±‚æ•°"?_==="è¯·æ±‚æ•°"?1:-1:S.parsed.y-y.parsed.y},callbacks:{label:function(y){const S=y.dataset.label||"";let _=y.parsed.y;return S==="è´¹ç”¨ (USD)"?_<.01?S+": $"+_.toFixed(6):S+": $"+_.toFixed(4):S==="è¯·æ±‚æ•°"?S+": "+_.toLocaleString()+" æ¬¡":_>=1e6?S+": "+(_/1e6).toFixed(2)+"M tokens":_>=1e3?S+": "+(_/1e3).toFixed(2)+"K tokens":S+": "+_.toLocaleString()+" tokens"}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:Z==="hour"?"æ—¶é—´":"æ—¥æœŸ",color:g.value.text},ticks:{color:g.value.text},grid:{color:g.value.grid}},y:{type:"linear",display:!0,position:"left",min:0,title:{display:!0,text:"Tokenæ•°é‡",color:g.value.text},ticks:{callback:function(y){return T(y)},color:g.value.text},grid:{color:g.value.grid}},y1:{type:"linear",display:!0,position:"right",min:0,title:{display:!0,text:"è¯·æ±‚æ•°",color:g.value.text},grid:{drawOnChartArea:!1},ticks:{callback:function(y){return y.toLocaleString()},color:g.value.text}},y2:{type:"linear",display:!1,position:"right",min:0}}}})}const St=A(!1),V=A(null),te=A([]),gt=A([]),$t=A([]),Ot=A(!1),Vt=A(null);let Yt=null;const Rt=A(1),mt=A(5),ee=Et(()=>{const o=L.value.apiKeyStats||[],e=(Rt.value-1)*mt.value,m=e+mt.value;return o.slice(e,m)}),ae=o=>{Rt.value=o};function Lt(){if(!j.value)return;st&&st.destroy();const o=(L.value.apiKeyStats||[]).slice(0,20),e=N.value,m=o.map(C=>C.name||C.id),$=o.map(C=>e==="tokens"?C.tokens:C.requests),h=o.map((C,P)=>{const M=["rgba(59, 130, 246, 0.7)","rgba(16, 185, 129, 0.7)","rgba(245, 158, 11, 0.7)","rgba(239, 68, 68, 0.7)","rgba(139, 92, 246, 0.7)","rgba(236, 72, 153, 0.7)","rgba(20, 184, 166, 0.7)","rgba(249, 115, 22, 0.7)","rgba(99, 102, 241, 0.7)","rgba(132, 204, 22, 0.7)"];return M[P%M.length]}),R=h.map(C=>C.replace("0.7","1")),U={labels:m,datasets:[{label:e==="tokens"?"Token æ•°é‡":"è¯·æ±‚æ¬¡æ•°",data:$,backgroundColor:h,borderColor:R,borderWidth:1,borderRadius:4}]};st=new It(j.value,{type:"bar",data:U,options:{indexAxis:"x",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(C){const P=C.parsed.y,M=C.dataIndex,s=o[M];let y="";return e==="tokens"?y=`${T(P)} tokens`:y=`${P.toLocaleString()} æ¬¡`,`${y} (${s.formattedCost})`}}}},scales:{x:{grid:{display:!1},ticks:{color:g.value.text,maxRotation:45,minRotation:45,autoSkip:!1}},y:{grid:{color:g.value.grid},ticks:{color:g.value.text,callback:C=>T(C)}}},onClick:(C,P)=>{if(P.length>0){const M=P[0].index,s=o[M];Wt(s)}}}})}const Wt=async o=>{V.value=o,St.value=!0,Ot.value=!0;try{const e=L.value.data||[];te.value=e.map(m=>{var h;const $=((h=m.apiKeys)==null?void 0:h[o.id])||{requests:0,tokens:0,cost:0};return{date:m.label||m.date||m.hour,...$}});try{let m="monthly",$=`period=${m}`;q.value.type==="custom"&&q.value.customRange?(m="custom",$=`period=custom&startDate=${encodeURIComponent(q.value.customRange[0])}&endDate=${encodeURIComponent(q.value.customRange[1])}`):q.value.type==="preset"&&q.value.preset==="today"&&(m="daily",$="period=daily");const h=await Q.get(`/admin/api-keys/${o.id}/model-stats?${$}`);h.success&&h.data?gt.value=h.data:gt.value=[]}catch(m){console.error("åŠ è½½æ¨¡å‹ç»Ÿè®¡å¤±è´¥:",m),gt.value=[]}try{const m=new Map,$=L.value.data||[];console.log("Loading daily usage for API Key:",o.id),console.log("Full trend data points:",$.length),$.forEach(h=>{var U;const R=(U=h.apiKeys)==null?void 0:U[o.id];if(R&&R.requests>0){let C=h.date||h.label||h.hour;C&&C.includes("T")?C=C.split("T")[0]:C&&C.includes(" ")&&(C=C.split(" ")[0]),m.has(C)||m.set(C,{date:C,requests:0,tokens:0,inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,cost:0});const P=m.get(C);P.requests+=R.requests||0,P.inputTokens+=R.inputTokens||0,P.outputTokens+=R.outputTokens||0,P.cacheCreateTokens+=R.cacheCreateTokens||0,P.cacheReadTokens+=R.cacheReadTokens||0,P.tokens+=R.tokens||0,P.cost+=R.cost||0}}),console.log("Daily usage map:",Array.from(m.entries())),$t.value=Array.from(m.values()).map(h=>{const R=h.tokens>0?h.tokens:h.inputTokens+h.outputTokens+h.cacheCreateTokens+h.cacheReadTokens;return console.log(`Date: ${h.date}, tokens: ${h.tokens}, calculated: ${h.inputTokens+h.outputTokens+h.cacheCreateTokens+h.cacheReadTokens}, final: ${R}`),{...h,allTokens:R,formatted:{totalCost:h.cost>=.01?`$${h.cost.toFixed(2)}`:"<$0.01"}}}).sort((h,R)=>R.date.localeCompare(h.date))}catch(m){console.error("åŠ è½½æŒ‰å¤©ç”¨é‡ç»Ÿè®¡å¤±è´¥:",m),$t.value=[]}Ot.value=!1,await W(),setTimeout(()=>{ie()},100)}catch(e){console.error("åˆ›å»ºå›¾è¡¨å¤±è´¥:",e),Ot.value=!1}};function ie(){if(!Vt.value){console.warn("Canvas ref not available for API Key detail chart");return}try{Yt&&Yt.destroy();const o=te.value;if(!o||o.length===0){console.warn("No trend data available for chart");return}const e=o.map(m=>m.date&&m.date.includes("T")?`${new Date(m.date).getHours()}:00`:m.date);console.log("Creating API Key detail chart with",o.length,"data points"),Yt=new It(Vt.value,{type:"line",data:{labels:e,datasets:[{label:"Token æ¶ˆè€—",data:o.map(m=>m.tokens),borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",yAxisID:"y",tension:.3,fill:!0},{label:"è¯·æ±‚æ¬¡æ•°",data:o.map(m=>m.requests),borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.1)",yAxisID:"y1",tension:.3,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top",labels:{color:g.value.legend}},tooltip:{callbacks:{label:function(m){const $=m.dataset.label||"",h=m.parsed.y;return m.dataset.yAxisID==="y"?`${$}: ${z(h)}`:`${$}: ${h.toLocaleString()}`}}}},scales:{x:{ticks:{color:g.value.text},grid:{color:g.value.grid}},y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Tokens",color:g.value.text},ticks:{color:g.value.text,callback:m=>z(m)},grid:{color:g.value.grid}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"è¯·æ±‚æ•°",color:g.value.text},ticks:{color:g.value.text},grid:{display:!1}}}}})}catch(o){console.error("Failed to create API Key detail chart:",o)}}async function se(){await Nt(N.value),await W(),Lt()}function qt(){var C,P,M;if(!_t.value)return;H&&H.destroy();const o=((C=F.value)==null?void 0:C.data)||[],e=((P=F.value)==null?void 0:P.topAccounts)||[],m=["#2563EB","#059669","#D97706","#DC2626","#7C3AED","#F472B6","#0EA5E9","#F97316","#6366F1","#22C55E"],$=e.map((s,y)=>{var K,Y;const S=o.map(E=>!E.accounts||!E.accounts[s]?0:E.accounts[s].cost||0);return{label:((Y=(K=o.find(E=>E.accounts&&E.accounts[s]))==null?void 0:K.accounts[s])==null?void 0:Y.name)||`è´¦å· ${String(s).slice(0,6)}`,data:S,borderColor:m[y%m.length],backgroundColor:m[y%m.length]+"20",tension:.4,fill:!1}}),h=(M=o[0])!=null&&M.date?"date":"hour",R={labels:o.map(s=>{if(s.label)return s.label;if(h==="hour"){const y=new Date(s.hour),S=String(y.getMonth()+1).padStart(2,"0"),_=String(y.getDate()).padStart(2,"0"),K=String(y.getHours()).padStart(2,"0");return`${S}/${_} ${K}:00`}if(s.date&&s.date.includes("-")){const y=s.date.split("-");if(y.length>=3)return`${y[1]}/${y[2]}`}return s.date}),datasets:$},U=e;H=new It(_t.value,{type:"line",data:R,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,font:{size:12},color:g.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:(s,y)=>y.parsed.y-s.parsed.y,callbacks:{label:function(s){var ne;const y=s.dataset.label||"",S=s.parsed.y||0,_=s.dataIndex,K=s.datasetIndex,Y=U[K],E=F.value.data[_],yt=(ne=E==null?void 0:E.accounts)==null?void 0:ne[Y],Qt=s.chart.data.datasets.map((Pt,Xt)=>({value:Pt.data[_]||0,index:Xt})).sort((Pt,Xt)=>Xt.value-Pt.value).findIndex(Pt=>Pt.index===K)+1;let zt="";Qt===1?zt="ğŸ¥‡ ":Qt===2?zt="ğŸ¥ˆ ":Qt===3&&(zt="ğŸ¥‰ ");const ce=(yt==null?void 0:yt.formattedCost)||pt(S),ue=(yt==null?void 0:yt.requests)||0;return`${zt}${y}: ${ce} / ${ue.toLocaleString()} æ¬¡`}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:Z.value==="hour"?"æ—¶é—´":"æ—¥æœŸ",color:g.value.text},ticks:{color:g.value.text},grid:{color:g.value.grid}},y:{beginAtZero:!0,min:0,title:{display:!0,text:"æ¶ˆè€—é‡‘é¢ (USD)",color:g.value.text},ticks:{callback:s=>pt(Number(s)),color:g.value.text},grid:{color:g.value.grid}}}}})}async function de(o){if(!(bt.value===o||wt.value)){wt.value=!0;try{await jt(o),await W(),qt()}finally{wt.value=!1}}}xt(X,()=>{W(()=>Dt())}),xt(vt,()=>{W(()=>At())}),xt(L,()=>{W(()=>Lt())}),xt(F,()=>{W(()=>qt())});async function Jt(){if(!f.value){f.value=!0;try{await Promise.all([ht(),ut(),x()])}finally{f.value=!1}}}function oe(){d.value&&(c.value=w.value,u.value&&clearInterval(u.value),i.value&&clearTimeout(i.value),u.value=setInterval(()=>{c.value--,c.value<=0&&clearInterval(u.value)},1e3),i.value=setTimeout(async()=>{await Jt(),d.value&&oe()},w.value*1e3))}function re(){u.value&&(clearInterval(u.value),u.value=null),i.value&&(clearTimeout(i.value),i.value=null),c.value=0}return xt(d,o=>{o?oe():re()}),xt(dt,()=>{W(()=>{Dt(),At(),Lt(),qt()})}),xe(async()=>{await Jt(),await W(),Dt(),At(),Lt(),qt()}),fe(()=>{re(),et&&et.destroy(),at&&at.destroy(),st&&st.destroy(),H&&H.destroy()}),(o,e)=>{var R,U,C,P,M;const m=pe,$=ge,h=me;return b(),v("div",null,[t("div",Te,[t("div",De,[t("div",Ae,[t("div",null,[e[11]||(e[11]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," æ€»API Keys ",-1)),t("p",Se,r(a(n).totalApiKeys),1),t("p",$e," æ´»è·ƒ: "+r(a(n).activeApiKeys||0),1)]),e[12]||(e[12]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-blue-500 to-blue-600"},[t("i",{class:"fas fa-key"})],-1))])]),t("div",Re,[t("div",Pe,[t("div",Ie,[e[20]||(e[20]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," æœåŠ¡è´¦æˆ· ",-1)),t("div",Be,[t("p",Ue,r(a(n).totalAccounts),1),a(n).accountsByPlatform?(b(),v("div",Ke,[a(n).accountsByPlatform.claude&&a(n).accountsByPlatform.claude.total>0?(b(),v("div",{key:0,class:"inline-flex items-center gap-0.5",title:`Claude: ${a(n).accountsByPlatform.claude.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.claude.normal})`},[e[13]||(e[13]=t("i",{class:"fas fa-brain text-xs text-indigo-600"},null,-1)),t("span",Fe,r(a(n).accountsByPlatform.claude.total),1)],8,Me)):I("",!0),a(n).accountsByPlatform["claude-console"]&&a(n).accountsByPlatform["claude-console"].total>0?(b(),v("div",{key:1,class:"inline-flex items-center gap-0.5",title:`Console: ${a(n).accountsByPlatform["claude-console"].total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform["claude-console"].normal})`},[e[14]||(e[14]=t("i",{class:"fas fa-terminal text-xs text-purple-600"},null,-1)),t("span",Le,r(a(n).accountsByPlatform["claude-console"].total),1)],8,Oe)):I("",!0),a(n).accountsByPlatform.gemini&&a(n).accountsByPlatform.gemini.total>0?(b(),v("div",{key:2,class:"inline-flex items-center gap-0.5",title:`Gemini: ${a(n).accountsByPlatform.gemini.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.gemini.normal})`},[e[15]||(e[15]=t("i",{class:"fas fa-robot text-xs text-yellow-600"},null,-1)),t("span",ze,r(a(n).accountsByPlatform.gemini.total),1)],8,qe)):I("",!0),a(n).accountsByPlatform.bedrock&&a(n).accountsByPlatform.bedrock.total>0?(b(),v("div",{key:3,class:"inline-flex items-center gap-0.5",title:`Bedrock: ${a(n).accountsByPlatform.bedrock.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.bedrock.normal})`},[e[16]||(e[16]=t("i",{class:"fab fa-aws text-xs text-orange-600"},null,-1)),t("span",Ge,r(a(n).accountsByPlatform.bedrock.total),1)],8,Ee)):I("",!0),a(n).accountsByPlatform.openai&&a(n).accountsByPlatform.openai.total>0?(b(),v("div",{key:4,class:"inline-flex items-center gap-0.5",title:`OpenAI: ${a(n).accountsByPlatform.openai.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.openai.normal})`},[e[17]||(e[17]=t("i",{class:"fas fa-openai text-xs text-gray-100"},null,-1)),t("span",je,r(a(n).accountsByPlatform.openai.total),1)],8,Ne)):I("",!0),a(n).accountsByPlatform.azure_openai&&a(n).accountsByPlatform.azure_openai.total>0?(b(),v("div",{key:5,class:"inline-flex items-center gap-0.5",title:`Azure OpenAI: ${a(n).accountsByPlatform.azure_openai.total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform.azure_openai.normal})`},[e[18]||(e[18]=t("i",{class:"fab fa-microsoft text-xs text-blue-600"},null,-1)),t("span",Ve,r(a(n).accountsByPlatform.azure_openai.total),1)],8,He)):I("",!0),a(n).accountsByPlatform["openai-responses"]&&a(n).accountsByPlatform["openai-responses"].total>0?(b(),v("div",{key:6,class:"inline-flex items-center gap-0.5",title:`OpenAI Responses: ${a(n).accountsByPlatform["openai-responses"].total} ä¸ª (æ­£å¸¸: ${a(n).accountsByPlatform["openai-responses"].normal})`},[e[19]||(e[19]=t("i",{class:"fas fa-server text-xs text-cyan-600"},null,-1)),t("span",We,r(a(n).accountsByPlatform["openai-responses"].total),1)],8,Ye)):I("",!0)])):I("",!0)]),t("p",Je,[B(" æ­£å¸¸: "+r(a(n).normalAccounts||0)+" ",1),a(n).abnormalAccounts>0?(b(),v("span",Qe," | å¼‚å¸¸: "+r(a(n).abnormalAccounts),1)):I("",!0),a(n).pausedAccounts>0?(b(),v("span",Xe," | åœæ­¢è°ƒåº¦: "+r(a(n).pausedAccounts),1)):I("",!0),a(n).rateLimitedAccounts>0?(b(),v("span",Ze," | é™æµ: "+r(a(n).rateLimitedAccounts),1)):I("",!0)])]),e[21]||(e[21]=t("div",{class:"stat-icon ml-2 flex-shrink-0 bg-gradient-to-br from-green-500 to-green-600"},[t("i",{class:"fas fa-user-circle"})],-1))])]),t("div",ta,[t("div",ea,[t("div",null,[e[22]||(e[22]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," ä»Šæ—¥è¯·æ±‚ ",-1)),t("p",aa,r(a(n).todayRequests),1),t("p",sa," æ€»è¯·æ±‚: "+r(T(a(n).totalRequests||0)),1)]),e[23]||(e[23]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-purple-500 to-purple-600"},[t("i",{class:"fas fa-chart-line"})],-1))])]),t("div",oa,[t("div",ra,[t("div",null,[e[24]||(e[24]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," ç³»ç»ŸçŠ¶æ€ ",-1)),t("p",na,r(a(n).systemStatus),1),t("p",la," è¿è¡Œæ—¶é—´: "+r(a(ct)),1)]),e[25]||(e[25]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-yellow-500 to-orange-500"},[t("i",{class:"fas fa-heartbeat"})],-1))])])]),t("div",ia,[t("div",da,[t("div",ca,[t("div",null,[e[26]||(e[26]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," è´¦æˆ·ä½™é¢/é…é¢ ",-1)),t("p",ua,r(p(rt.value.totalBalance||0)),1),t("p",pa," ä½ä½™é¢: "+r(rt.value.lowBalanceCount||0)+" | æ€»æˆæœ¬: "+r(p(rt.value.totalCost||0)),1)]),e[27]||(e[27]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-emerald-500 to-green-600"},[t("i",{class:"fas fa-wallet"})],-1))]),t("div",ga,[t("p",ma," æ›´æ–°æ—¶é—´: "+r(k(Mt.value)),1),t("button",{class:"flex items-center gap-2 rounded-lg border border-gray-200 bg-white px-3 py-1.5 text-xs font-medium text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:border-gray-500",disabled:G.value,onClick:x},[t("i",{class:J(["fas",G.value?"fa-spinner fa-spin":"fa-sync-alt"])},null,2),e[28]||(e[28]=B(" åˆ·æ–° ",-1))],8,ya)])]),t("div",xa,[t("div",fa,[e[29]||(e[29]=t("h3",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},"ä½ä½™é¢è´¦æˆ·",-1)),t("span",va,r(Tt.value.length)+" ä¸ª ",1)]),G.value?(b(),v("div",ba," æ­£åœ¨åŠ è½½... ")):Tt.value.length===0?(b(),v("div",ha," å…¨éƒ¨æ­£å¸¸ ")):(b(),v("div",ka,[(b(!0),v(nt,null,lt(Tt.value,s=>{var y;return b(),v("div",{key:s.accountId,class:"rounded-lg border border-red-200 bg-red-50 p-3 dark:border-red-900/60 dark:bg-red-900/20"},[t("div",_a,[t("div",wa,r(s.name||s.accountId),1),t("span",Ca,r(Ct(s.platform)),1)]),t("div",Ta,[s.balance?(b(),v("span",Da,"ä½™é¢: "+r(s.balance.formattedAmount),1)):(b(),v("span",Aa,"ä»Šæ—¥æˆæœ¬: "+r(p(((y=s.statistics)==null?void 0:y.dailyCost)||0)),1))]),s.quota&&typeof s.quota.percentage=="number"?(b(),v("div",Sa,[t("div",$a,[e[30]||(e[30]=t("span",null,"é…é¢ä½¿ç”¨",-1)),t("span",Ra,r(s.quota.percentage.toFixed(1))+"% ",1)]),t("div",Pa,[t("div",{class:"h-2 rounded-full bg-red-500",style:ke({width:`${Math.min(100,s.quota.percentage)}%`})},null,4)])])):I("",!0)])}),128))]))])]),t("div",Ia,[t("div",Ba,[t("div",Ua,[t("div",Ka,[e[35]||(e[35]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," ä»Šæ—¥Token ",-1)),t("div",Ma,[t("p",Fa,r(T((a(n).todayInputTokens||0)+(a(n).todayOutputTokens||0)+(a(n).todayCacheCreateTokens||0)+(a(n).todayCacheReadTokens||0))),1),t("span",Oa,"/ "+r(a(ft).todayCosts.formatted.totalCost),1)]),t("div",La,[t("div",qa,[t("span",null,[e[31]||(e[31]=B("è¾“å…¥: ",-1)),t("span",za,r(T(a(n).todayInputTokens||0)),1)]),t("span",null,[e[32]||(e[32]=B("è¾“å‡º: ",-1)),t("span",Ea,r(T(a(n).todayOutputTokens||0)),1)]),(a(n).todayCacheCreateTokens||0)>0?(b(),v("span",Ga,[e[33]||(e[33]=B("ç¼“å­˜åˆ›å»º: ",-1)),t("span",Na,r(T(a(n).todayCacheCreateTokens||0)),1)])):I("",!0),(a(n).todayCacheReadTokens||0)>0?(b(),v("span",ja,[e[34]||(e[34]=B("ç¼“å­˜è¯»å–: ",-1)),t("span",Ha,r(T(a(n).todayCacheReadTokens||0)),1)])):I("",!0)])])]),e[36]||(e[36]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-indigo-500 to-indigo-600"},[t("i",{class:"fas fa-coins"})],-1))])]),t("div",Va,[t("div",Ya,[t("div",Wa,[e[41]||(e[41]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," æ€»Tokenæ¶ˆè€— ",-1)),t("div",Ja,[t("p",Qa,r(T((a(n).totalInputTokens||0)+(a(n).totalOutputTokens||0)+(a(n).totalCacheCreateTokens||0)+(a(n).totalCacheReadTokens||0))),1),t("span",Xa,"/ "+r(a(ft).totalCosts.formatted.totalCost),1)]),t("div",Za,[t("div",ts,[t("span",null,[e[37]||(e[37]=B("è¾“å…¥: ",-1)),t("span",es,r(T(a(n).totalInputTokens||0)),1)]),t("span",null,[e[38]||(e[38]=B("è¾“å‡º: ",-1)),t("span",as,r(T(a(n).totalOutputTokens||0)),1)]),(a(n).totalCacheCreateTokens||0)>0?(b(),v("span",ss,[e[39]||(e[39]=B("ç¼“å­˜åˆ›å»º: ",-1)),t("span",os,r(T(a(n).totalCacheCreateTokens||0)),1)])):I("",!0),(a(n).totalCacheReadTokens||0)>0?(b(),v("span",rs,[e[40]||(e[40]=B("ç¼“å­˜è¯»å–: ",-1)),t("span",ns,r(T(a(n).totalCacheReadTokens||0)),1)])):I("",!0)])])]),e[42]||(e[42]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-emerald-500 to-emerald-600"},[t("i",{class:"fas fa-database"})],-1))])]),t("div",ls,[t("div",is,[t("div",null,[t("p",ds,[e[43]||(e[43]=B(" å®æ—¶RPM ",-1)),t("span",cs,"("+r(a(n).metricsWindow)+"åˆ†é’Ÿ)",1)]),t("p",us,r(a(n).realtimeRPM||0),1),t("p",ps,[e[45]||(e[45]=B(" æ¯åˆ†é’Ÿè¯·æ±‚æ•° ",-1)),a(n).isHistoricalMetrics?(b(),v("span",gs,e[44]||(e[44]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),B(" å†å²æ•°æ® ",-1)]))):I("",!0)])]),e[46]||(e[46]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-orange-500 to-orange-600"},[t("i",{class:"fas fa-tachometer-alt"})],-1))])]),t("div",ms,[t("div",ys,[t("div",null,[t("p",xs,[e[47]||(e[47]=B(" å®æ—¶TPM ",-1)),t("span",fs,"("+r(a(n).metricsWindow)+"åˆ†é’Ÿ)",1)]),t("p",vs,r(T(a(n).realtimeTPM||0)),1),t("p",bs,[e[49]||(e[49]=B(" æ¯åˆ†é’ŸTokenæ•° ",-1)),a(n).isHistoricalMetrics?(b(),v("span",hs,e[48]||(e[48]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),B(" å†å²æ•°æ® ",-1)]))):I("",!0)])]),e[50]||(e[50]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-rose-500 to-rose-600"},[t("i",{class:"fas fa-rocket"})],-1))])])]),t("div",ks,[t("div",_s,[e[57]||(e[57]=t("h3",{class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"}," æ¨¡å‹ä½¿ç”¨åˆ†å¸ƒä¸Tokenä½¿ç”¨è¶‹åŠ¿ ",-1)),t("div",ws,[t("div",Cs,[(b(!0),v(nt,null,lt(a(q).presetOptions,s=>(b(),v("button",{key:s.value,class:J(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(q).preset===s.value&&a(q).type==="preset"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:y=>a(l)(s.value)},r(s.label),11,Ts))),128))]),t("div",Ds,[t("button",{class:J(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(Z)==="day"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[0]||(e[0]=s=>a(kt)("day"))},e[51]||(e[51]=[t("i",{class:"fas fa-calendar-day mr-1"},null,-1),B("æŒ‰å¤© ",-1)]),2),t("button",{class:J(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(Z)==="hour"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[1]||(e[1]=s=>a(kt)("hour"))},e[52]||(e[52]=[t("i",{class:"fas fa-clock mr-1"},null,-1),B("æŒ‰å°æ—¶ ",-1)]),2)]),t("div",As,[Zt(m,{modelValue:a(q).customRange,"onUpdate:modelValue":e[2]||(e[2]=s=>a(q).customRange=s),class:"custom-date-picker w-full lg:w-auto","default-time":a(Kt),"disabled-date":a(Ht),"end-placeholder":"ç»“æŸæ—¥æœŸ",format:"YYYY-MM-DD HH:mm:ss","range-separator":"è‡³",size:"default","start-placeholder":"å¼€å§‹æ—¥æœŸ",style:{"max-width":"400px"},type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss",onChange:a(O)},null,8,["modelValue","default-time","disabled-date","onChange"]),a(Z)==="hour"?(b(),v("span",Ss,e[53]||(e[53]=[t("i",{class:"fas fa-info-circle"},null,-1),B(" æœ€å¤š24å°æ—¶ ",-1)]))):I("",!0)]),t("div",$s,[t("div",Rs,[t("label",Ps,[ve(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>d.value=s),class:"peer sr-only",type:"checkbox"},null,512),[[be,d.value]]),e[56]||(e[56]=t("div",{class:"peer relative h-5 w-9 rounded-full bg-gray-300 transition-all duration-200 after:absolute after:left-[2px] after:top-0.5 after:h-4 after:w-4 after:rounded-full after:bg-white after:shadow-sm after:transition-transform after:duration-200 after:content-[''] peer-checked:bg-blue-500 peer-checked:after:translate-x-4 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:bg-gray-600 dark:after:bg-gray-300 dark:peer-focus:ring-blue-600"},null,-1)),t("span",Is,[e[54]||(e[54]=t("i",{class:"fas fa-redo-alt text-xs text-gray-500 dark:text-gray-400"},null,-1)),e[55]||(e[55]=t("span",null,"è‡ªåŠ¨åˆ·æ–°",-1)),d.value?(b(),v("span",{key:0,class:J(["ml-1 font-mono text-xs text-blue-600 transition-opacity",c.value>0?"opacity-100":"opacity-0"])},r(c.value)+"s ",3)):I("",!0)])])]),t("button",{class:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-3 py-1 text-sm font-medium text-blue-600 shadow-sm transition-colors hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 sm:gap-2",disabled:f.value,title:"ç«‹å³åˆ·æ–°æ•°æ®",onClick:e[4]||(e[4]=s=>Jt())},[t("i",{class:J(["fas fa-sync-alt text-xs",{"animate-spin":f.value}])},null,2),t("span",Us,r(f.value?"åˆ·æ–°ä¸­":"åˆ·æ–°"),1)],8,Bs)])])]),t("div",Ks,[t("div",Ms,[e[58]||(e[58]=t("h4",{class:"mb-4 text-base font-semibold text-gray-800 dark:text-gray-200 sm:text-lg"}," Tokenä½¿ç”¨åˆ†å¸ƒ ",-1)),t("div",Fs,[t("canvas",{ref_key:"modelUsageChart",ref:D},null,512)])]),t("div",Os,[e[61]||(e[61]=t("h4",{class:"mb-4 text-base font-semibold text-gray-800 dark:text-gray-200 sm:text-lg"}," è¯¦ç»†ç»Ÿè®¡æ•°æ® ",-1)),a(X).length===0?(b(),v("div",Ls,e[59]||(e[59]=[t("p",{class:"text-sm text-gray-500 sm:text-base"},"æš‚æ— æ¨¡å‹ä½¿ç”¨æ•°æ®",-1)]))):(b(),v("div",qs,[t("table",zs,[e[60]||(e[60]=t("thead",{class:"sticky top-0 bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," æ¨¡å‹ "),t("th",{class:"hidden px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:table-cell sm:px-4"}," è¯·æ±‚æ•° "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," æ€»Token "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," è´¹ç”¨ "),t("th",{class:"hidden px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:table-cell sm:px-4"}," å æ¯” ")])],-1)),t("tbody",Es,[(b(!0),v(nt,null,lt(a(X),s=>(b(),v("tr",{key:s.model,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",Gs,[t("span",{class:"block max-w-[100px] truncate sm:max-w-none",title:s.model},r(s.model),9,Ns)]),t("td",js,r(T(s.requests)),1),t("td",Hs,r(T(s.allTokens)),1),t("td",Vs,r(s.formatted?s.formatted.total:"$0.000000"),1),t("td",Ys,[t("span",Ws,r(Ft(s.allTokens,a(X)))+"% ",1)])]))),128))])])]))])])]),t("div",Js,[t("div",Qs,[t("div",Xs,[t("canvas",{ref_key:"usageTrendChart",ref:tt},null,512)])])]),t("div",Zs,[t("div",to,[t("div",eo,[e[64]||(e[64]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg"}," API Keys ä½¿ç”¨æ’è¡Œ ",-1)),t("div",ao,[t("button",{class:J(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(N)==="requests"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[5]||(e[5]=s=>(N.value="requests",se()))},e[62]||(e[62]=[t("i",{class:"fas fa-exchange-alt mr-1"},null,-1),t("span",{class:"hidden sm:inline"},"è¯·æ±‚æ¬¡æ•°",-1),t("span",{class:"sm:hidden"},"è¯·æ±‚",-1)]),2),t("button",{class:J(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(N)==="tokens"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[6]||(e[6]=s=>(N.value="tokens",se()))},e[63]||(e[63]=[t("i",{class:"fas fa-coins mr-1"},null,-1),t("span",{class:"hidden sm:inline"},"Token æ•°é‡",-1),t("span",{class:"sm:hidden"},"Token",-1)]),2)])]),t("div",so,[(((R=a(L).apiKeyStats)==null?void 0:R.length)||0)>20?(b(),v("span",oo," å…± "+r((U=a(L).apiKeyStats)==null?void 0:U.length)+" ä¸ª API Keyï¼Œå›¾è¡¨æ˜¾ç¤º Top 20 ",1)):(b(),v("span",ro," å…± "+r(((C=a(L).apiKeyStats)==null?void 0:C.length)||0)+" ä¸ª API Key ",1)),e[65]||(e[65]=t("span",{class:"ml-2 text-gray-400"},"(ç‚¹å‡»æŸ±çŠ¶å›¾æŸ¥çœ‹è¯¦æƒ…)",-1))]),t("div",no,[t("canvas",{ref_key:"apiKeysUsageTrendChart",ref:j},null,512)]),t("div",lo,[e[68]||(e[68]=t("h4",{class:"mb-4 text-sm font-semibold text-gray-800 dark:text-gray-200"},"ä½¿ç”¨é‡æ˜ç»†è¡¨",-1)),t("div",io,[t("table",co,[e[67]||(e[67]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ’å "),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," API Key åç§° "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¯·æ±‚æ•° "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," Token æ€»é‡ "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," é¢„ä¼°è´¹ç”¨ "),t("th",{class:"px-6 py-3 text-center text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ“ä½œ ")])],-1)),t("tbody",uo,[(b(!0),v(nt,null,lt(ee.value,(s,y)=>(b(),v("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},[t("td",po,r((Rt.value-1)*mt.value+y+1),1),t("td",go,[t("button",{class:"text-blue-600 hover:text-blue-800 hover:underline dark:text-blue-400 dark:hover:text-blue-300",onClick:S=>Wt(s)},r(s.name||s.id),9,mo),t("div",yo,r(s.id.substring(0,8))+"...",1)]),t("td",xo,r(s.requests.toLocaleString()),1),t("td",fo,r(T(s.tokens)),1),t("td",vo,r(s.formattedCost),1),t("td",bo,[t("button",{class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",onClick:S=>Wt(s)}," æŸ¥çœ‹è¯¦æƒ… ",8,ho)])]))),128)),ee.value.length===0?(b(),v("tr",ko,e[66]||(e[66]=[t("td",{class:"px-6 py-4 text-center text-sm text-gray-500",colspan:"6"},"æš‚æ— æ•°æ®",-1)]))):I("",!0)])])]),(((P=a(L).apiKeyStats)==null?void 0:P.length)||0)>mt.value?(b(),v("div",_o,[Zt($,{"current-page":Rt.value,"onUpdate:currentPage":e[7]||(e[7]=s=>Rt.value=s),"page-size":mt.value,"onUpdate:pageSize":e[8]||(e[8]=s=>mt.value=s),background:"",layout:"total, sizes, prev, pager, next","page-sizes":[5,10,20,50],small:"",total:((M=a(L).apiKeyStats)==null?void 0:M.length)||0,onCurrentChange:ae,onSizeChange:e[9]||(e[9]=s=>ae(1))},null,8,["current-page","page-size","total"])])):I("",!0)])])]),t("div",wo,[t("div",Co,[t("div",To,[t("div",Do,[e[69]||(e[69]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg"}," è´¦å·ä½¿ç”¨è¶‹åŠ¿ ",-1)),t("span",Ao," å½“å‰åˆ†ç»„ï¼š"+r(a(F).groupLabel||"æœªé€‰æ‹©"),1)]),t("div",So,[t("div",$o,[(b(),v(nt,null,lt(ot,s=>t("button",{key:s.value,class:J(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(bt)===s.value?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:y=>de(s.value)},r(s.label),11,Ro)),64))])])]),t("div",Po,[t("span",null,"å…± "+r(a(F).totalAccounts||0)+" ä¸ªè´¦å·",1),a(F).topAccounts&&a(F).topAccounts.length?(b(),v("span",Io," æ˜¾ç¤ºæ¶ˆè€—æ’åå‰ "+r(a(F).topAccounts.length)+" ä¸ªè´¦å· ",1)):I("",!0)]),!a(F).data||a(F).data.length===0?(b(),v("div",Bo," æš‚æ— è´¦å·ä½¿ç”¨æ•°æ® ")):(b(),v("div",Uo,[t("canvas",{ref_key:"accountUsageTrendChart",ref:_t},null,512)]))])]),Zt(h,{modelValue:St.value,"onUpdate:modelValue":e[10]||(e[10]=s=>St.value=s),"append-to-body":"","destroy-on-close":"",style:{width:"90%","max-width":"1200px"},title:V.value?`API Key è¯¦æƒ…: ${V.value.name||V.value.id}`:"API Key è¯¦æƒ…"},{default:he(()=>{var s,y,S;return[Ot.value?(b(),v("div",Ko,e[70]||(e[70]=[t("i",{class:"fas fa-spinner fa-spin text-2xl text-blue-500"},null,-1),t("p",{class:"mt-2 text-gray-500"},"åŠ è½½ä¸­...",-1)]))):(b(),v("div",Mo,[t("div",Fo,[t("div",Oo,[e[71]||(e[71]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"æ€»è¯·æ±‚æ•°",-1)),t("p",Lo,r((s=V.value)==null?void 0:s.requests.toLocaleString()),1)]),t("div",qo,[e[72]||(e[72]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Token æ€»é‡",-1)),t("p",zo,r(T(((y=V.value)==null?void 0:y.tokens)||0)),1)]),t("div",Eo,[e[73]||(e[73]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"é¢„ä¼°è´¹ç”¨",-1)),t("p",Go,r((S=V.value)==null?void 0:S.formattedCost),1)])]),t("div",No,[e[74]||(e[74]=t("h4",{class:"mb-3 text-sm font-semibold text-gray-800 dark:text-gray-200"}," ä½¿ç”¨è¶‹åŠ¿ (å½“å‰æ—¶é—´æ®µ) ",-1)),t("div",jo,[t("canvas",{ref_key:"apiKeyDetailChart",ref:Vt},null,512)])]),gt.value&&gt.value.length>0?(b(),v("div",Ho,[e[76]||(e[76]=t("h4",{class:"mb-3 text-sm font-semibold text-gray-800 dark:text-gray-200"},"æ¨¡å‹ä½¿ç”¨æ˜ç»†",-1)),t("div",Vo,[t("table",Yo,[e[75]||(e[75]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ¨¡å‹ "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¯·æ±‚æ•° "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¾“å…¥ Token "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¾“å‡º Token "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," ç¼“å­˜åˆ›å»º "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," ç¼“å­˜è¯»å– "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ€»è®¡ "),t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è´¹ç”¨ ")])],-1)),t("tbody",Wo,[(b(!0),v(nt,null,lt(gt.value,_=>{var K;return b(),v("tr",{key:_.model,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},[t("td",Jo,r(_.model),1),t("td",Qo,r(_.requests.toLocaleString()),1),t("td",Xo,r(T(_.inputTokens)),1),t("td",Zo,r(T(_.outputTokens)),1),t("td",tr,r(T(_.cacheCreateTokens)),1),t("td",er,r(T(_.cacheReadTokens)),1),t("td",ar,r(T(_.allTokens)),1),t("td",sr,r(((K=_.formatted)==null?void 0:K.totalCost)||"$0.00"),1)])}),128))])])])])):I("",!0),$t.value&&$t.value.length>0?(b(),v("div",or,[e[78]||(e[78]=t("h4",{class:"mb-3 text-sm font-semibold text-gray-800 dark:text-gray-200"},"æŒ‰å¤©ç”¨é‡æ˜ç»†",-1)),t("div",rr,[t("table",nr,[e[77]||(e[77]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ—¥æœŸ "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è¯·æ±‚æ¬¡æ•° "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," æ€» Token "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," è´¹ç”¨ ")])],-1)),t("tbody",lr,[(b(!0),v(nt,null,lt($t.value,_=>{var K,Y;return b(),v("tr",{key:_.date,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},[t("td",ir,r(_.date),1),t("td",dr,r(((K=_.requests)==null?void 0:K.toLocaleString())||0),1),t("td",cr,r(z(_.allTokens)),1),t("td",ur,r(((Y=_.formatted)==null?void 0:Y.totalCost)||"$0.00"),1)])}),128))])])])])):I("",!0)]))]}),_:1},8,["modelValue","title"])])}}},br=_e(pr,[["__scopeId","data-v-5e331f22"]]);export{br as default};
